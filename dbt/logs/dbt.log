

============================== 23:15:30.518614 | 634bc091-6692-45b5-bd28-3b0ade82afa4 ==============================
[0m23:15:30.518614 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:15:30.523327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:15:30.524104 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:15:30.524817 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.035130873, "process_user_time": 1.281585, "process_kernel_time": 0.114873, "process_mem_max_rss": "106680", "process_out_blocks": "898", "command_success": false, "process_in_blocks": "0"}
[0m23:15:30.525333 [debug] [MainThread]: Command `dbt run` failed at 23:15:30.525215 after 0.04 seconds
[0m23:15:30.525689 [debug] [MainThread]: Flushing usage events


============================== 23:15:31.959504 | 494a4eee-9a31-4679-861d-f5a629c3d9a8 ==============================
[0m23:15:31.959504 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:15:31.963600 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:15:31.964089 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:15:31.964621 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.0293715, "process_user_time": 1.238453, "process_kernel_time": 0.05502, "process_mem_max_rss": "106736", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:15:31.964961 [debug] [MainThread]: Command `dbt test` failed at 23:15:31.964881 after 0.03 seconds
[0m23:15:31.965204 [debug] [MainThread]: Flushing usage events


============================== 23:15:35.128461 | 34c129eb-e438-4219-b8e6-f255b8659e9d ==============================
[0m23:15:35.128461 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:15:35.132540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:15:35.133282 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:15:35.133931 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.029557833, "process_user_time": 1.254541, "process_kernel_time": 0.078033, "process_mem_max_rss": "106736", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:15:35.134303 [debug] [MainThread]: Command `dbt run` failed at 23:15:35.134218 after 0.03 seconds
[0m23:15:35.134621 [debug] [MainThread]: Flushing usage events


============================== 23:15:36.663593 | 5f3f53b1-9801-423d-8c44-e93abdf1449c ==============================
[0m23:15:36.663593 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:15:36.668564 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:15:36.669357 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:15:36.670163 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.040556166, "process_user_time": 1.336129, "process_kernel_time": 0.066956, "process_mem_max_rss": "106728", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:15:36.670721 [debug] [MainThread]: Command `dbt test` failed at 23:15:36.670543 after 0.04 seconds
[0m23:15:36.671185 [debug] [MainThread]: Flushing usage events


============================== 23:19:54.950307 | 433e669e-27a9-4273-aa10-90251d1834b4 ==============================
[0m23:19:54.950307 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:19:54.955180 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'send_anonymous_usage_stats': 'False'}
[0m23:19:54.955739 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:19:54.956357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.032229833, "process_user_time": 1.258944, "process_kernel_time": 0.123386, "process_mem_max_rss": "106800", "process_out_blocks": "898", "command_success": false, "process_in_blocks": "0"}
[0m23:19:54.956743 [debug] [MainThread]: Command `dbt run` failed at 23:19:54.956653 after 0.03 seconds
[0m23:19:54.957010 [debug] [MainThread]: Flushing usage events


============================== 23:19:56.405953 | ef480d8f-52db-4769-9971-50f9cf7a61f8 ==============================
[0m23:19:56.405953 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:19:56.409896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:19:56.410421 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:19:56.410962 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.028963376, "process_user_time": 1.248365, "process_kernel_time": 0.073962, "process_mem_max_rss": "106724", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:19:56.411298 [debug] [MainThread]: Command `dbt test` failed at 23:19:56.411215 after 0.03 seconds
[0m23:19:56.411540 [debug] [MainThread]: Flushing usage events


============================== 23:19:59.606178 | 14e690c1-d93d-404a-8cf7-c318d9337a9d ==============================
[0m23:19:59.606178 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:19:59.610427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'send_anonymous_usage_stats': 'False'}
[0m23:19:59.610988 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:19:59.611578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.029613959, "process_user_time": 1.263055, "process_kernel_time": 0.050002, "process_mem_max_rss": "106748", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:19:59.611961 [debug] [MainThread]: Command `dbt run` failed at 23:19:59.611869 after 0.03 seconds
[0m23:19:59.612217 [debug] [MainThread]: Flushing usage events


============================== 23:20:01.134514 | 709a98a4-440b-4f0d-9d08-a695c4cf9b58 ==============================
[0m23:20:01.134514 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:20:01.138801 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'send_anonymous_usage_stats': 'False'}
[0m23:20:01.139321 [error] [MainThread]: Encountered an error:
Runtime Error
  dbt_project.yml does not parse to a dictionary
[0m23:20:01.139909 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.029467374, "process_user_time": 1.328982, "process_kernel_time": 0.072053, "process_mem_max_rss": "106764", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:20:01.140305 [debug] [MainThread]: Command `dbt test` failed at 23:20:01.140224 after 0.03 seconds
[0m23:20:01.140555 [debug] [MainThread]: Flushing usage events


============================== 23:29:25.120178 | 628b2da6-d203-4d1f-9919-5af0fb12c7d8 ==============================
[0m23:29:25.120178 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:29:25.127711 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:29:25.128197 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /opt/airflow/dags/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m23:29:25.128983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.036831584, "process_user_time": 1.308354, "process_kernel_time": 0.105947, "process_mem_max_rss": "106776", "process_out_blocks": "898", "command_success": false, "process_in_blocks": "0"}
[0m23:29:25.129561 [debug] [MainThread]: Command `dbt run` failed at 23:29:25.129419 after 0.04 seconds
[0m23:29:25.129914 [debug] [MainThread]: Flushing usage events


============================== 23:29:26.546565 | 8efa1120-6ac2-4d8c-968b-a8021c59119c ==============================
[0m23:29:26.546565 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:29:26.550359 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:29:26.550773 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /opt/airflow/dags/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m23:29:26.551337 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.02836425, "process_user_time": 1.216482, "process_kernel_time": 0.065971, "process_mem_max_rss": "106720", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:29:26.551683 [debug] [MainThread]: Command `dbt test` failed at 23:29:26.551600 after 0.03 seconds
[0m23:29:26.551927 [debug] [MainThread]: Flushing usage events


============================== 23:29:29.648883 | c15acad3-ef10-4c6a-9df7-8cf56ad52073 ==============================
[0m23:29:29.648883 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:29:29.653315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:29:29.653938 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /opt/airflow/dags/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m23:29:29.654571 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.030921582, "process_user_time": 1.247136, "process_kernel_time": 0.083941, "process_mem_max_rss": "106728", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:29:29.654963 [debug] [MainThread]: Command `dbt run` failed at 23:29:29.654878 after 0.03 seconds
[0m23:29:29.655216 [debug] [MainThread]: Flushing usage events


============================== 23:29:31.176937 | ff5257c8-c852-4245-ba83-161dec8682a2 ==============================
[0m23:29:31.176937 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:29:31.181148 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:29:31.181548 [error] [MainThread]: Encountered an error:
Runtime Error
  No dbt_project.yml found at expected path /opt/airflow/dags/dbt/dbt_project.yml
  Verify that each entry within packages.yml (and their transitive dependencies) contains a file named dbt_project.yml
  
[0m23:29:31.182080 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.028950293, "process_user_time": 1.338464, "process_kernel_time": 0.067922, "process_mem_max_rss": "106744", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:29:31.182423 [debug] [MainThread]: Command `dbt test` failed at 23:29:31.182340 after 0.03 seconds
[0m23:29:31.182686 [debug] [MainThread]: Flushing usage events


============================== 23:32:35.182803 | 5bf1f477-9eb1-4438-80a2-1ecde47dbb74 ==============================
[0m23:32:35.182803 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:32:35.187680 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:32:35.189863 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:32:35.190531 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.034850877, "process_user_time": 1.277565, "process_kernel_time": 0.128157, "process_mem_max_rss": "106676", "process_out_blocks": "898", "command_success": false, "process_in_blocks": "0"}
[0m23:32:35.190962 [debug] [MainThread]: Command `dbt run` failed at 23:32:35.190879 after 0.04 seconds
[0m23:32:35.191238 [debug] [MainThread]: Flushing usage events


============================== 23:32:36.617381 | ed7e561b-169f-47e0-ba93-3317a6eb35e8 ==============================
[0m23:32:36.617381 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:32:36.621727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:32:36.623426 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:32:36.623958 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.0309275, "process_user_time": 1.229848, "process_kernel_time": 0.067991, "process_mem_max_rss": "106732", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:32:36.624305 [debug] [MainThread]: Command `dbt test` failed at 23:32:36.624225 after 0.03 seconds
[0m23:32:36.624543 [debug] [MainThread]: Flushing usage events


============================== 23:32:39.792810 | f1a0970c-5491-487d-a062-5875c2a4f814 ==============================
[0m23:32:39.792810 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:32:39.797783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'send_anonymous_usage_stats': 'False'}
[0m23:32:39.799624 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:32:39.800255 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.031760667, "process_user_time": 1.354441, "process_kernel_time": 0.072236, "process_mem_max_rss": "106756", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:32:39.800629 [debug] [MainThread]: Command `dbt run` failed at 23:32:39.800545 after 0.03 seconds
[0m23:32:39.800877 [debug] [MainThread]: Flushing usage events


============================== 23:32:41.331122 | aaec6bef-b9ae-46a6-92e1-0d2d74e05773 ==============================
[0m23:32:41.331122 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:32:41.336132 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'send_anonymous_usage_stats': 'False'}
[0m23:32:41.338144 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:32:41.338869 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.039022706, "process_user_time": 1.328802, "process_kernel_time": 0.086987, "process_mem_max_rss": "106716", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:32:41.339329 [debug] [MainThread]: Command `dbt test` failed at 23:32:41.339232 after 0.04 seconds
[0m23:32:41.339672 [debug] [MainThread]: Flushing usage events


============================== 23:35:15.571596 | 7ad34cce-9505-462e-bfc8-f4fce692e661 ==============================
[0m23:35:15.571596 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:35:15.577045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:35:15.578823 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:35:15.579385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.031916417, "process_user_time": 1.238088, "process_kernel_time": 0.100844, "process_mem_max_rss": "106768", "process_out_blocks": "898", "command_success": false, "process_in_blocks": "0"}
[0m23:35:15.579767 [debug] [MainThread]: Command `dbt run` failed at 23:35:15.579667 after 0.03 seconds
[0m23:35:15.580045 [debug] [MainThread]: Flushing usage events


============================== 23:35:16.961913 | e563ff73-f15f-4fb5-938f-0b39430b7928 ==============================
[0m23:35:16.961913 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:35:16.965839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:35:16.967624 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:35:16.968191 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.029964084, "process_user_time": 1.209644, "process_kernel_time": 0.062084, "process_mem_max_rss": "106724", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:35:16.968554 [debug] [MainThread]: Command `dbt test` failed at 23:35:16.968473 after 0.03 seconds
[0m23:35:16.968809 [debug] [MainThread]: Flushing usage events


============================== 23:35:20.070806 | 6e107df7-e9da-4258-aebf-19983b5a71da ==============================
[0m23:35:20.070806 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:35:20.075544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:35:20.077344 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:35:20.077942 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.031457294, "process_user_time": 1.332569, "process_kernel_time": 0.080913, "process_mem_max_rss": "106736", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:35:20.078330 [debug] [MainThread]: Command `dbt run` failed at 23:35:20.078235 after 0.03 seconds
[0m23:35:20.078591 [debug] [MainThread]: Flushing usage events


============================== 23:35:21.506185 | d2fa9da7-f5b4-41ae-a81d-a077743fac5d ==============================
[0m23:35:21.506185 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:35:21.510413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:35:21.512188 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:35:21.512746 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.030350916, "process_user_time": 1.253194, "process_kernel_time": 0.061058, "process_mem_max_rss": "106724", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:35:21.513085 [debug] [MainThread]: Command `dbt test` failed at 23:35:21.513005 after 0.03 seconds
[0m23:35:21.513344 [debug] [MainThread]: Flushing usage events


============================== 23:39:36.845628 | 2d9a3b47-9301-4441-bf3d-71852d62e713 ==============================
[0m23:39:36.845628 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:39:36.850201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:39:36.852104 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:39:36.852657 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.033118457, "process_user_time": 1.253081, "process_kernel_time": 0.108093, "process_mem_max_rss": "106744", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:39:36.853030 [debug] [MainThread]: Command `dbt run` failed at 23:39:36.852946 after 0.03 seconds
[0m23:39:36.853272 [debug] [MainThread]: Flushing usage events


============================== 23:39:38.289626 | 7e854c14-414c-4c96-9a7a-e0866f9a3743 ==============================
[0m23:39:38.289626 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:39:38.293570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:39:38.295346 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:39:38.295898 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.030192416, "process_user_time": 1.259333, "process_kernel_time": 0.059968, "process_mem_max_rss": "106736", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:39:38.296236 [debug] [MainThread]: Command `dbt test` failed at 23:39:38.296154 after 0.03 seconds
[0m23:39:38.296478 [debug] [MainThread]: Flushing usage events


============================== 23:41:36.515003 | 0610b867-04ec-423f-8cf5-4755f5c02c0f ==============================
[0m23:41:36.515003 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:41:36.519892 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'send_anonymous_usage_stats': 'False'}
[0m23:41:36.521638 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:41:36.522261 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.031133583, "process_user_time": 1.239485, "process_kernel_time": 0.099198, "process_mem_max_rss": "106728", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:41:36.522615 [debug] [MainThread]: Command `dbt run` failed at 23:41:36.522531 after 0.03 seconds
[0m23:41:36.522887 [debug] [MainThread]: Flushing usage events


============================== 23:41:37.912781 | cfbd4a8c-5097-49a8-85bb-fce299fa5e82 ==============================
[0m23:41:37.912781 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:41:37.916744 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile telecom_project', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:41:37.918500 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'telecom_project'
[0m23:41:37.919088 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.030159917, "process_user_time": 1.206127, "process_kernel_time": 0.074007, "process_mem_max_rss": "106740", "process_out_blocks": "2", "command_success": false, "process_in_blocks": "0"}
[0m23:41:37.919459 [debug] [MainThread]: Command `dbt test` failed at 23:41:37.919375 after 0.03 seconds
[0m23:41:37.919706 [debug] [MainThread]: Flushing usage events


============================== 23:43:35.119836 | 225127bb-ada5-4e3b-bfc6-b4d9682a9b3d ==============================
[0m23:43:35.119836 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:43:35.125319 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m23:43:35.289935 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:43:35.295228 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:43:35.295948 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:43:35.815520 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.fact_customer_telcome' (models/marts/fact_customer_telcome.sql) depends on a node named 'stg_telecom_data' which was not found
[0m23:43:35.816536 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7225594, "process_user_time": 1.923035, "process_kernel_time": 0.130934, "process_mem_max_rss": "117852", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m23:43:35.817000 [debug] [MainThread]: Command `dbt run` failed at 23:43:35.816909 after 0.72 seconds
[0m23:43:35.817406 [debug] [MainThread]: Flushing usage events


============================== 23:43:37.267979 | 16765df0-8a9b-444e-bd9d-b1323fc1317c ==============================
[0m23:43:37.267979 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:43:37.272057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:43:37.417026 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:43:37.422017 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:43:37.422734 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:43:37.898335 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_project.fact_customer_telcome' (models/marts/fact_customer_telcome.sql) depends on a node named 'stg_telecom_data' which was not found
[0m23:43:37.899092 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6551992, "process_user_time": 1.83008, "process_kernel_time": 0.087955, "process_mem_max_rss": "117828", "process_out_blocks": "3", "command_success": false, "process_in_blocks": "0"}
[0m23:43:37.899526 [debug] [MainThread]: Command `dbt test` failed at 23:43:37.899423 after 0.66 seconds
[0m23:43:37.899828 [debug] [MainThread]: Flushing usage events


============================== 23:49:44.136681 | 639e1b6e-890f-4a59-9934-73743f635abe ==============================
[0m23:49:44.136681 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:49:44.143120 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:49:44.294690 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:49:44.299743 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:49:44.300504 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:49:44.811890 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:49:44.812864 [info ] [MainThread]: 
[0m23:49:44.813411 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:44.814268 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:49:44.820434 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:49:44.820923 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:49:44.821206 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:44.822858 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:49:44.823268 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:44.823632 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:44.824118 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:44.824719 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:49:44.825029 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:49:44.825574 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:44.825906 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:44.826144 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:44.826431 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:44.826760 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:49:44.827131 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:49:44.827447 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:44.827766 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:44.828064 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:49:44.828361 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:49:44.829351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:44.829728 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:49:44.830073 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:49:44.830360 [info ] [MainThread]: 
[0m23:49:44.830635 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m23:49:44.830988 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m23:49:44.831555 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.71933955, "process_user_time": 1.916097, "process_kernel_time": 0.148239, "process_mem_max_rss": "120072", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m23:49:44.831942 [debug] [MainThread]: Command `dbt run` failed at 23:49:44.831856 after 0.72 seconds
[0m23:49:44.832216 [debug] [MainThread]: Flushing usage events


============================== 23:49:46.256509 | 5f102d38-09e2-48f3-9736-bf61553ddfa2 ==============================
[0m23:49:46.256509 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:49:46.260896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:49:46.404466 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:49:46.409763 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:49:46.456332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:46.456673 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:46.469044 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:49:46.469968 [info ] [MainThread]: 
[0m23:49:46.470277 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:49:46.470717 [debug] [MainThread]: Command end result
[0m23:49:46.476172 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24515513, "process_user_time": 1.4292, "process_kernel_time": 0.068009, "process_mem_max_rss": "117120", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m23:49:46.476660 [debug] [MainThread]: Command `dbt test` succeeded at 23:49:46.476516 after 0.25 seconds
[0m23:49:46.476995 [debug] [MainThread]: Flushing usage events


============================== 23:49:49.513968 | 804d79be-e67f-4085-b2cb-8b21909ef354 ==============================
[0m23:49:49.513968 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:49:49.518766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:49:49.666500 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:49:49.671820 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:49:49.725276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:49.725738 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:49.740420 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:49:49.741636 [info ] [MainThread]: 
[0m23:49:49.742350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:49:49.743302 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:49:49.750352 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:49:49.750685 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:49:49.752173 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:49:49.752565 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:49.752917 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:49.753260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:49.753591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:49:49.754809 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:49:49.755096 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:49:49.755722 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:49.756027 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:49:49.756261 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:49.756548 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:49.756886 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:49:49.757228 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:49:49.757515 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:49.757839 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:49:49.758225 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:49:49.758679 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:49:49.759811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:49.760082 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:49:49.760290 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:49:49.760523 [info ] [MainThread]: 
[0m23:49:49.760790 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m23:49:49.761116 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m23:49:49.761725 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.27290383, "process_user_time": 1.430216, "process_kernel_time": 0.113778, "process_mem_max_rss": "117244", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m23:49:49.762087 [debug] [MainThread]: Command `dbt run` failed at 23:49:49.762006 after 0.27 seconds
[0m23:49:49.762341 [debug] [MainThread]: Flushing usage events


============================== 23:49:51.302396 | 9c79e344-bce2-4a49-8b06-289336896dd4 ==============================
[0m23:49:51.302396 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:49:51.306896 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:49:51.458376 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:49:51.463843 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:49:51.511401 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:51.511752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:51.523458 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:49:51.524299 [info ] [MainThread]: 
[0m23:49:51.524599 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:49:51.524940 [debug] [MainThread]: Command end result
[0m23:49:51.529872 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2529627, "process_user_time": 1.494463, "process_kernel_time": 0.133951, "process_mem_max_rss": "116980", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m23:49:51.530385 [debug] [MainThread]: Command `dbt test` succeeded at 23:49:51.530250 after 0.25 seconds
[0m23:49:51.530749 [debug] [MainThread]: Flushing usage events


============================== 23:55:44.971501 | 5f474701-598d-442c-acb2-ef22591a8338 ==============================
[0m23:55:44.971501 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:55:44.976781 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:55:45.128937 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:55:45.134367 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:55:45.182674 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:45.183039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:45.196798 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:55:45.197711 [info ] [MainThread]: 
[0m23:55:45.198272 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:55:45.199175 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:55:45.205369 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:55:45.205907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:55:45.206204 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:45.207807 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:55:45.208243 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:45.208586 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:45.209056 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:55:45.209573 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:55:45.209964 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:55:45.210577 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:45.210908 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:55:45.211163 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:55:45.211486 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:55:45.211810 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:55:45.212120 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:55:45.212412 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:55:45.212700 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:55:45.213005 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:55:45.213392 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:55:45.214582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:55:45.214850 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:55:45.215078 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:55:45.215363 [info ] [MainThread]: 
[0m23:55:45.215629 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m23:55:45.215976 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m23:55:45.216557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2687555, "process_user_time": 1.417838, "process_kernel_time": 0.138788, "process_mem_max_rss": "117172", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m23:55:45.216937 [debug] [MainThread]: Command `dbt run` failed at 23:55:45.216854 after 0.27 seconds
[0m23:55:45.217217 [debug] [MainThread]: Flushing usage events


============================== 23:55:46.617618 | 062cdac9-28cb-425f-803f-f2f69bfe7ce8 ==============================
[0m23:55:46.617618 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:55:46.621953 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m23:55:46.764916 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:55:46.770764 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:55:46.819958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:55:46.820321 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:55:46.831881 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:55:46.832701 [info ] [MainThread]: 
[0m23:55:46.832988 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:55:46.833343 [debug] [MainThread]: Command end result
[0m23:55:46.838140 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2448238, "process_user_time": 1.411144, "process_kernel_time": 0.071057, "process_mem_max_rss": "117000", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m23:55:46.838531 [debug] [MainThread]: Command `dbt test` succeeded at 23:55:46.838446 after 0.25 seconds
[0m23:55:46.838790 [debug] [MainThread]: Flushing usage events


============================== 23:58:25.468399 | 4531dfcc-b574-467a-93e0-b994a58e822f ==============================
[0m23:58:25.468399 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:58:25.473352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:58:25.622964 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:58:25.629206 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:58:25.675421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:25.675766 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:25.687875 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:58:25.688756 [info ] [MainThread]: 
[0m23:58:25.689265 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m23:58:25.690069 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:58:25.696413 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:58:25.696907 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m23:58:25.697200 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:58:25.698630 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m23:58:25.698971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:25.699290 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:58:25.699713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:58:25.700198 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:58:25.700474 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m23:58:25.701034 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:58:25.701328 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m23:58:25.701597 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:58:25.701888 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:58:25.702182 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:58:25.702474 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m23:58:25.702740 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:58:25.703015 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m23:58:25.703297 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:58:25.703570 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m23:58:25.704585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:58:25.704834 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:58:25.705046 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m23:58:25.705274 [info ] [MainThread]: 
[0m23:58:25.705536 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m23:58:25.705889 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m23:58:25.706422 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.26192275, "process_user_time": 1.424989, "process_kernel_time": 0.129271, "process_mem_max_rss": "117176", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m23:58:25.706793 [debug] [MainThread]: Command `dbt run` failed at 23:58:25.706712 after 0.26 seconds
[0m23:58:25.707046 [debug] [MainThread]: Flushing usage events


============================== 23:58:27.093162 | 1b6ee96e-20d7-4c91-8dfc-26e373c20067 ==============================
[0m23:58:27.093162 [info ] [MainThread]: Running with dbt=1.7.0
[0m23:58:27.097813 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:58:27.253119 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m23:58:27.259257 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m23:58:27.308192 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:58:27.308580 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:58:27.320876 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m23:58:27.321694 [info ] [MainThread]: 
[0m23:58:27.321971 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:58:27.322315 [debug] [MainThread]: Command end result
[0m23:58:27.327996 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.26143017, "process_user_time": 1.409503, "process_kernel_time": 0.067023, "process_mem_max_rss": "116996", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m23:58:27.328515 [debug] [MainThread]: Command `dbt test` succeeded at 23:58:27.328393 after 0.26 seconds
[0m23:58:27.328828 [debug] [MainThread]: Flushing usage events


============================== 00:00:05.687361 | 4413e127-94b9-47d0-a106-add9e2c04194 ==============================
[0m00:00:05.687361 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:05.692001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m00:00:05.844560 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:00:05.851044 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:00:05.897826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:05.898170 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:05.910345 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:00:05.911225 [info ] [MainThread]: 
[0m00:00:05.911742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:05.912592 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:00:05.918956 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:00:05.919348 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:00:05.920747 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:00:05.921126 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:05.921416 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:05.921725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.921980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:05.923095 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:00:05.923390 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:00:05.923931 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:05.924258 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:05.924511 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:05.924802 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:05.925101 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:00:05.925417 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:00:05.925716 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:05.926007 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:05.926284 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:00:05.926594 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:00:05.927553 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:05.927789 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:00:05.928002 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:00:05.928240 [info ] [MainThread]: 
[0m00:00:05.928523 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:00:05.928845 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:00:05.929385 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.26696682, "process_user_time": 1.455304, "process_kernel_time": 0.131479, "process_mem_max_rss": "117264", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m00:00:05.929727 [debug] [MainThread]: Command `dbt run` failed at 00:00:05.929648 after 0.27 seconds
[0m00:00:05.929969 [debug] [MainThread]: Flushing usage events


============================== 00:00:07.343110 | bac6ba5e-6ff6-42e7-ae98-4b492390b771 ==============================
[0m00:00:07.343110 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:07.347202 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:00:07.489653 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:00:07.494875 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:00:07.539292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:07.539631 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:07.551097 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:00:07.551903 [info ] [MainThread]: 
[0m00:00:07.552199 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:00:07.552590 [debug] [MainThread]: Command end result
[0m00:00:07.557589 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23875937, "process_user_time": 1.423886, "process_kernel_time": 0.067899, "process_mem_max_rss": "116988", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m00:00:07.557982 [debug] [MainThread]: Command `dbt test` succeeded at 00:00:07.557890 after 0.24 seconds
[0m00:00:07.558290 [debug] [MainThread]: Flushing usage events


============================== 00:00:34.195711 | 7ecd2c3e-4c7e-4dd3-a562-2816409c1d17 ==============================
[0m00:00:34.195711 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:34.200056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m00:00:34.344798 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:00:34.350241 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:00:34.396626 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:34.396965 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:34.410463 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:00:34.411354 [info ] [MainThread]: 
[0m00:00:34.411847 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:00:34.412699 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:00:34.419026 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:00:34.419393 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:00:34.420737 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:00:34.421062 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:34.421434 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:34.421753 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:34.422054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:00:34.423057 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:00:34.423434 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:00:34.424109 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:34.424455 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:00:34.424724 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:34.425032 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:34.425365 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:00:34.425703 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:00:34.426031 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:34.426317 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:00:34.426634 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:00:34.426923 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:00:34.427955 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:00:34.428200 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:00:34.428446 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:00:34.428691 [info ] [MainThread]: 
[0m00:00:34.428957 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:00:34.429278 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:00:34.429870 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.25804862, "process_user_time": 1.437069, "process_kernel_time": 0.075108, "process_mem_max_rss": "117040", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m00:00:34.430239 [debug] [MainThread]: Command `dbt run` failed at 00:00:34.430156 after 0.26 seconds
[0m00:00:34.430513 [debug] [MainThread]: Flushing usage events


============================== 00:00:35.829425 | b30752de-9464-4b2c-8aad-b1f2a16773a4 ==============================
[0m00:00:35.829425 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:00:35.833966 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m00:00:35.982307 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:00:35.987659 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:00:36.033938 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:00:36.034278 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:00:36.046180 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:00:36.047012 [info ] [MainThread]: 
[0m00:00:36.047297 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:00:36.047657 [debug] [MainThread]: Command end result
[0m00:00:36.052590 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24907963, "process_user_time": 1.40863, "process_kernel_time": 0.072929, "process_mem_max_rss": "116984", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m00:00:36.052975 [debug] [MainThread]: Command `dbt test` succeeded at 00:00:36.052892 after 0.25 seconds
[0m00:00:36.053269 [debug] [MainThread]: Flushing usage events


============================== 00:03:58.837618 | 5ddb1148-dc76-4c44-adc4-359740b525f1 ==============================
[0m00:03:58.837618 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:03:58.842808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m00:03:58.992687 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:03:58.998985 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:03:59.052859 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:03:59.053275 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:03:59.066523 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:03:59.067432 [info ] [MainThread]: 
[0m00:03:59.067963 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:03:59.068825 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:03:59.075079 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:03:59.076074 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:03:59.077445 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:03:59.077796 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:03:59.078194 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:03:59.078490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:59.078767 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:59.079729 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:03:59.079991 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:03:59.080572 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:03:59.080864 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:03:59.081093 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:03:59.081372 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:03:59.081670 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:03:59.081974 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:03:59.082236 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:03:59.082546 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:03:59.082847 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:03:59.083136 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:03:59.084147 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:59.084382 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:03:59.084601 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:03:59.084834 [info ] [MainThread]: 
[0m00:03:59.085090 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:03:59.085399 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:03:59.085952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.27220404, "process_user_time": 1.48904, "process_kernel_time": 0.129916, "process_mem_max_rss": "117356", "process_out_blocks": "1654", "command_success": false, "process_in_blocks": "0"}
[0m00:03:59.086303 [debug] [MainThread]: Command `dbt run` failed at 00:03:59.086226 after 0.27 seconds
[0m00:03:59.086553 [debug] [MainThread]: Flushing usage events


============================== 00:04:00.591095 | ab10444f-bd50-4b37-b3b6-5de3d090bb8c ==============================
[0m00:04:00.591095 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:04:00.595103 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m00:04:00.745500 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:04:00.751128 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:04:00.817655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:00.818047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:00.833799 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:04:00.834984 [info ] [MainThread]: 
[0m00:04:00.835308 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:04:00.835774 [debug] [MainThread]: Command end result
[0m00:04:00.842549 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.27572325, "process_user_time": 1.48394, "process_kernel_time": 0.125994, "process_mem_max_rss": "116988", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m00:04:00.843053 [debug] [MainThread]: Command `dbt test` succeeded at 00:04:00.842957 after 0.28 seconds
[0m00:04:00.843346 [debug] [MainThread]: Flushing usage events


============================== 00:04:04.124651 | 7debf0a1-bba9-4277-bde1-bdaa0108a42c ==============================
[0m00:04:04.124651 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:04:04.128772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:04:04.278139 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:04:04.283451 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:04:04.329790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:04.330130 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:04.342518 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:04:04.343456 [info ] [MainThread]: 
[0m00:04:04.343970 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:04:04.344843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:04:04.351263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:04:04.352263 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:04:04.354158 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:04:04.354744 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:04:04.355313 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:04:04.355685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:04.356008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:04.357032 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:04:04.357378 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:04:04.358126 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:04:04.358454 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:04:04.358752 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:04:04.359136 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:04:04.359506 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:04:04.359817 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:04:04.360096 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:04:04.360379 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:04:04.360701 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:04:04.361009 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:04:04.362146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:04.362495 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:04:04.362775 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:04:04.363060 [info ] [MainThread]: 
[0m00:04:04.363403 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:04:04.363849 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:04:04.364495 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2643022, "process_user_time": 1.538275, "process_kernel_time": 0.076814, "process_mem_max_rss": "117176", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m00:04:04.364896 [debug] [MainThread]: Command `dbt run` failed at 00:04:04.364800 after 0.26 seconds
[0m00:04:04.365281 [debug] [MainThread]: Flushing usage events


============================== 00:04:05.919031 | 33a5bf73-6281-4597-9436-297d0605cd51 ==============================
[0m00:04:05.919031 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:04:05.923176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m00:04:06.069656 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:04:06.074966 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:04:06.121650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:04:06.121990 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:04:06.133604 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:04:06.134433 [info ] [MainThread]: 
[0m00:04:06.134739 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:04:06.135129 [debug] [MainThread]: Command end result
[0m00:04:06.139921 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24519013, "process_user_time": 1.488308, "process_kernel_time": 0.09902, "process_mem_max_rss": "116984", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m00:04:06.140315 [debug] [MainThread]: Command `dbt test` succeeded at 00:04:06.140227 after 0.25 seconds
[0m00:04:06.140595 [debug] [MainThread]: Flushing usage events


============================== 00:14:35.111151 | 1ab62ad8-10d7-4a54-9f09-3717f8958035 ==============================
[0m00:14:35.111151 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:14:35.116163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:14:35.268294 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:14:35.274862 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:14:35.323228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:35.323560 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:35.335971 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:14:35.336875 [info ] [MainThread]: 
[0m00:14:35.337409 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:14:35.338305 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:14:35.344793 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:14:35.345303 [debug] [ThreadPool]: Acquiring new postgres connection 'list_staging_db'
[0m00:14:35.345597 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:14:35.347000 [debug] [ThreadPool]: Using postgres connection "list_staging_db"
[0m00:14:35.347396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:35.347728 [debug] [ThreadPool]: On list_staging_db: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:14:35.348177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:14:35.348786 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:14:35.349079 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:14:35.349642 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:14:35.349933 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_staging_db"} */

    select distinct nspname from pg_namespace
  
[0m00:14:35.350192 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:14:35.350501 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:14:35.350809 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:14:35.351120 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:14:35.351411 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:14:35.351714 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:14:35.352003 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:14:35.352307 [debug] [ThreadPool]: On list_staging_db: No close available on handle
[0m00:14:35.353339 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:14:35.353572 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:14:35.353778 [debug] [MainThread]: Connection 'list_staging_db' was properly closed.
[0m00:14:35.354000 [info ] [MainThread]: 
[0m00:14:35.354270 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:14:35.354588 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:14:35.355127 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.26784083, "process_user_time": 1.469098, "process_kernel_time": 0.150317, "process_mem_max_rss": "117184", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m00:14:35.355472 [debug] [MainThread]: Command `dbt run` failed at 00:14:35.355393 after 0.27 seconds
[0m00:14:35.355737 [debug] [MainThread]: Flushing usage events


============================== 00:14:36.763872 | 86f169e4-bd64-41de-9b42-b879917f61d9 ==============================
[0m00:14:36.763872 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:14:36.768474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:14:36.928246 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:14:36.934157 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:14:36.982933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:14:36.983345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:14:36.996056 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:14:36.997006 [info ] [MainThread]: 
[0m00:14:36.997331 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:14:36.997746 [debug] [MainThread]: Command end result
[0m00:14:37.002862 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.26609868, "process_user_time": 1.415041, "process_kernel_time": 0.076055, "process_mem_max_rss": "117032", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m00:14:37.003384 [debug] [MainThread]: Command `dbt test` succeeded at 00:14:37.003268 after 0.27 seconds
[0m00:14:37.003807 [debug] [MainThread]: Flushing usage events


============================== 00:22:39.572570 | 9c05e626-a222-4e50-91ea-02b13d7dd51a ==============================
[0m00:22:39.572570 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:22:39.578545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:22:39.730790 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:22:39.737182 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:22:39.773605 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m00:22:40.244549 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:22:40.245486 [info ] [MainThread]: 
[0m00:22:40.246038 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:22:40.246910 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:22:40.253069 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:22:40.253569 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:22:40.253871 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:40.255324 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:22:40.255677 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:40.256075 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:40.256697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:40.257233 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:22:40.257516 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:22:40.258216 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:40.258628 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:40.259036 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:22:40.259442 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:40.259743 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:40.260060 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:40.260478 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m00:22:40.260911 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:22:40.261640 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:40.261963 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m00:22:40.262643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:40.262897 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:22:40.263109 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:22:40.263335 [info ] [MainThread]: 
[0m00:22:40.263624 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:22:40.263970 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:22:40.264515 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7161564, "process_user_time": 1.966719, "process_kernel_time": 0.128981, "process_mem_max_rss": "120516", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m00:22:40.264882 [debug] [MainThread]: Command `dbt run` failed at 00:22:40.264802 after 0.72 seconds
[0m00:22:40.265137 [debug] [MainThread]: Flushing usage events


============================== 00:22:41.684408 | 8e3d1247-cd99-467c-a138-e2df149ac182 ==============================
[0m00:22:41.684408 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:22:41.688298 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m00:22:41.831546 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:22:41.836802 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:22:41.883382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:41.883745 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:41.895106 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:22:41.895926 [info ] [MainThread]: 
[0m00:22:41.896201 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:22:41.896536 [debug] [MainThread]: Command end result
[0m00:22:41.901121 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24078588, "process_user_time": 1.410118, "process_kernel_time": 0.077006, "process_mem_max_rss": "117024", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m00:22:41.901518 [debug] [MainThread]: Command `dbt test` succeeded at 00:22:41.901432 after 0.24 seconds
[0m00:22:41.901800 [debug] [MainThread]: Flushing usage events


============================== 00:22:44.923127 | 51cb93b1-d121-4749-9b75-6d0f770b4c2c ==============================
[0m00:22:44.923127 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:22:44.927101 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:22:45.086148 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:22:45.093098 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:22:45.154041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:45.154826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:45.173291 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:22:45.174576 [info ] [MainThread]: 
[0m00:22:45.175609 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m00:22:45.176772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:22:45.177762 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m00:22:45.185232 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:22:45.187054 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m00:22:45.187546 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:45.187952 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:45.188406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:45.188717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:22:45.189755 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:22:45.190047 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m00:22:45.190756 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:45.191144 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m00:22:45.191449 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:45.191750 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:45.192089 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:22:45.192379 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m00:22:45.192670 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:45.192951 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m00:22:45.193248 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m00:22:45.193519 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m00:22:45.194617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:22:45.194893 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:22:45.195134 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m00:22:45.195400 [info ] [MainThread]: 
[0m00:22:45.195673 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m00:22:45.196012 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m00:22:45.196575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.29795828, "process_user_time": 1.447588, "process_kernel_time": 0.070125, "process_mem_max_rss": "117148", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m00:22:45.196949 [debug] [MainThread]: Command `dbt run` failed at 00:22:45.196864 after 0.30 seconds
[0m00:22:45.197204 [debug] [MainThread]: Flushing usage events


============================== 00:22:46.683703 | e6d9f83a-65d0-4d29-a987-544cb6e7f919 ==============================
[0m00:22:46.683703 [info ] [MainThread]: Running with dbt=1.7.0
[0m00:22:46.688053 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:22:46.876276 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m00:22:46.886119 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m00:22:46.951215 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:22:46.951667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:22:46.965698 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m00:22:46.966776 [info ] [MainThread]: 
[0m00:22:46.967104 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:22:46.967516 [debug] [MainThread]: Command end result
[0m00:22:46.974067 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.31895813, "process_user_time": 1.518336, "process_kernel_time": 0.107164, "process_mem_max_rss": "116984", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m00:22:46.974601 [debug] [MainThread]: Command `dbt test` succeeded at 00:22:46.974494 after 0.32 seconds
[0m00:22:46.974932 [debug] [MainThread]: Flushing usage events


============================== 07:27:28.987397 | a919589a-6fed-4d83-888d-579624d72a3a ==============================
[0m07:27:28.987397 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:27:28.991912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m07:27:29.141675 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:27:29.147103 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:27:29.195294 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:29.195632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:29.207043 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:27:29.207922 [info ] [MainThread]: 
[0m07:27:29.208472 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:27:29.209306 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:27:29.215479 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:27:29.215989 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:27:29.216295 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:29.217743 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:27:29.218097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:29.218474 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:29.218894 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:29.219338 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:27:29.219629 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:27:29.220148 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:29.220435 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:29.220676 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:29.220953 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:29.221241 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:27:29.221535 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:27:29.221814 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:29.222092 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:29.222369 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m07:27:29.222642 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m07:27:29.223638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:29.223871 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m07:27:29.224100 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m07:27:29.224331 [info ] [MainThread]: 
[0m07:27:29.224592 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:27:29.224909 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:27:29.225453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.26479656, "process_user_time": 1.490414, "process_kernel_time": 0.091147, "process_mem_max_rss": "117352", "process_in_blocks": "9704", "process_out_blocks": "1654", "command_success": false}
[0m07:27:29.225803 [debug] [MainThread]: Command `dbt run` failed at 07:27:29.225716 after 0.27 seconds
[0m07:27:29.226071 [debug] [MainThread]: Flushing usage events


============================== 07:27:30.624113 | a16d6a3d-2613-4d13-a0bc-d89694388e33 ==============================
[0m07:27:30.624113 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:27:30.627963 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:27:30.773349 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:27:30.778738 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:27:30.824652 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:30.825021 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:30.836702 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:27:30.837534 [info ] [MainThread]: 
[0m07:27:30.837836 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:27:30.838219 [debug] [MainThread]: Command end result
[0m07:27:30.843411 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24339992, "process_user_time": 1.403578, "process_kernel_time": 0.076085, "process_mem_max_rss": "116832", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:27:30.843820 [debug] [MainThread]: Command `dbt test` succeeded at 07:27:30.843726 after 0.24 seconds
[0m07:27:30.844112 [debug] [MainThread]: Flushing usage events


============================== 07:27:33.761281 | 822a7e0d-54c0-454a-9c50-347f06d6e3e5 ==============================
[0m07:27:33.761281 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:27:33.765197 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:27:33.906333 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:27:33.911527 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:27:33.956458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:33.956787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:33.968550 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:27:33.969429 [info ] [MainThread]: 
[0m07:27:33.969935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:27:33.970767 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:27:33.977368 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:27:33.976972 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:27:33.978968 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:27:33.979341 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:33.979693 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:33.979996 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:33.980325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:27:33.981174 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:27:33.981444 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:27:33.981989 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:33.982287 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:27:33.982523 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:33.982812 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:33.983160 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:27:33.983510 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:27:33.983803 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:33.984084 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:27:33.984371 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m07:27:33.984652 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m07:27:33.985835 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:27:33.986111 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m07:27:33.986347 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m07:27:33.986595 [info ] [MainThread]: 
[0m07:27:33.986858 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:27:33.987187 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:27:33.987739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2500318, "process_user_time": 1.39534, "process_kernel_time": 0.065156, "process_mem_max_rss": "117008", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m07:27:33.988112 [debug] [MainThread]: Command `dbt run` failed at 07:27:33.988027 after 0.25 seconds
[0m07:27:33.988365 [debug] [MainThread]: Flushing usage events


============================== 07:27:35.361662 | 441d61bc-4f1d-4620-b762-bff08408947d ==============================
[0m07:27:35.361662 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:27:35.365554 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m07:27:35.509481 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:27:35.514786 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:27:35.561519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:27:35.561902 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:27:35.573603 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:27:35.574453 [info ] [MainThread]: 
[0m07:27:35.574773 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:27:35.575182 [debug] [MainThread]: Command end result
[0m07:27:35.579920 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24222313, "process_user_time": 1.395986, "process_kernel_time": 0.058915, "process_mem_max_rss": "116808", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:27:35.580372 [debug] [MainThread]: Command `dbt test` succeeded at 07:27:35.580246 after 0.24 seconds
[0m07:27:35.580754 [debug] [MainThread]: Flushing usage events


============================== 07:31:04.219037 | d639e0be-53fb-49d4-a30e-cd8e312e69a2 ==============================
[0m07:31:04.219037 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:31:04.225205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:31:04.377196 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:31:04.383499 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:31:04.434057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:04.434505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:04.449076 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:31:04.450141 [info ] [MainThread]: 
[0m07:31:04.450715 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:31:04.451611 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:31:04.457998 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:31:04.458644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_airflow'
[0m07:31:04.459015 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:31:04.460779 [debug] [ThreadPool]: Using postgres connection "list_airflow"
[0m07:31:04.461135 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:04.461430 [debug] [ThreadPool]: On list_airflow: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:31:04.461922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:31:04.462362 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:31:04.462641 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:31:04.463242 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:31:04.463574 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_airflow"} */

    select distinct nspname from pg_namespace
  
[0m07:31:04.463806 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:31:04.464118 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:31:04.464475 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:31:04.464809 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:31:04.465103 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:31:04.465396 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:31:04.465752 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m07:31:04.466077 [debug] [ThreadPool]: On list_airflow: No close available on handle
[0m07:31:04.467171 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:31:04.467436 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m07:31:04.467654 [debug] [MainThread]: Connection 'list_airflow' was properly closed.
[0m07:31:04.467890 [info ] [MainThread]: 
[0m07:31:04.468149 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:31:04.468478 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:31:04.469046 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2760435, "process_user_time": 1.446516, "process_kernel_time": 0.074974, "process_mem_max_rss": "117016", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m07:31:04.469415 [debug] [MainThread]: Command `dbt run` failed at 07:31:04.469333 after 0.28 seconds
[0m07:31:04.469732 [debug] [MainThread]: Flushing usage events


============================== 07:31:05.898196 | 3f9b7d3e-a80c-4d4b-9385-f95b86a40140 ==============================
[0m07:31:05.898196 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:31:05.902947 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:31:06.054190 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:31:06.059587 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:31:06.107063 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:31:06.107408 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:31:06.119446 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:31:06.120341 [info ] [MainThread]: 
[0m07:31:06.120628 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:31:06.120983 [debug] [MainThread]: Command end result
[0m07:31:06.126085 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.25507963, "process_user_time": 1.430722, "process_kernel_time": 0.07509, "process_mem_max_rss": "116816", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:31:06.126575 [debug] [MainThread]: Command `dbt test` succeeded at 07:31:06.126465 after 0.26 seconds
[0m07:31:06.126996 [debug] [MainThread]: Flushing usage events


============================== 07:33:52.374992 | 550c007c-d527-4b36-8df4-527f6d02f20b ==============================
[0m07:33:52.374992 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:33:52.378933 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m07:33:52.523037 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:33:52.528448 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:33:52.564173 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:33:53.051644 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:33:53.052653 [info ] [MainThread]: 
[0m07:33:53.053245 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:33:53.054091 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:33:53.060219 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:33:53.060708 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:33:53.061004 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:53.062496 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:33:53.062847 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:53.063172 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:53.063658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:53.064051 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:33:53.064323 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:33:53.064921 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:53.065226 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:53.065458 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:53.065757 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:53.066090 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:33:53.066385 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:33:53.066661 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:53.066944 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:53.067239 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:33:53.067524 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:33:53.068509 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:53.068742 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:33:53.068959 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:33:53.069187 [info ] [MainThread]: 
[0m07:33:53.069448 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:33:53.069786 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:33:53.070369 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.71948254, "process_user_time": 1.930864, "process_kernel_time": 0.093799, "process_mem_max_rss": "120272", "process_out_blocks": "2408", "command_success": false, "process_in_blocks": "0"}
[0m07:33:53.070749 [debug] [MainThread]: Command `dbt run` failed at 07:33:53.070658 after 0.72 seconds
[0m07:33:53.071014 [debug] [MainThread]: Flushing usage events


============================== 07:33:54.482008 | bd1a9d66-375e-4f11-be8a-26ad501b1d26 ==============================
[0m07:33:54.482008 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:33:54.485968 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m07:33:54.629134 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:33:54.634323 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:33:54.680319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:33:54.680651 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:33:54.692089 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:33:54.692871 [info ] [MainThread]: 
[0m07:33:54.693164 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:33:54.693494 [debug] [MainThread]: Command end result
[0m07:33:54.698137 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2407835, "process_user_time": 1.39716, "process_kernel_time": 0.077841, "process_mem_max_rss": "116856", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m07:33:54.698544 [debug] [MainThread]: Command `dbt test` succeeded at 07:33:54.698455 after 0.24 seconds
[0m07:33:54.698808 [debug] [MainThread]: Flushing usage events


============================== 07:33:57.619129 | d5c7a977-9bdf-463f-b206-26ef598c4fe2 ==============================
[0m07:33:57.619129 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:33:57.623265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:33:57.765499 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:33:57.770700 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:33:57.816398 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:33:57.816739 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:33:57.828057 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:33:57.828947 [info ] [MainThread]: 
[0m07:33:57.829453 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:33:57.830263 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:33:57.836292 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:33:57.837189 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:33:57.838612 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:33:57.838960 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:57.839291 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:57.839590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:57.839910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:33:57.840847 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:33:57.841140 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:33:57.841649 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:57.841957 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:33:57.842204 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:57.842493 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:57.842791 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:33:57.843121 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:33:57.843416 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:57.843706 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:33:57.844007 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:33:57.844302 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:33:57.845327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:33:57.845562 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:33:57.845775 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:33:57.846008 [info ] [MainThread]: 
[0m07:33:57.846267 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:33:57.846579 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:33:57.847114 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2527108, "process_user_time": 1.404656, "process_kernel_time": 0.064937, "process_mem_max_rss": "117144", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m07:33:57.847470 [debug] [MainThread]: Command `dbt run` failed at 07:33:57.847388 after 0.25 seconds
[0m07:33:57.847717 [debug] [MainThread]: Flushing usage events


============================== 07:33:59.298060 | 7fdd85f7-9b9f-4b10-b319-adb319cd8dd5 ==============================
[0m07:33:59.298060 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:33:59.301899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m07:33:59.444875 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:33:59.450106 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:33:59.497493 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:33:59.497848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:33:59.509065 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:33:59.509888 [info ] [MainThread]: 
[0m07:33:59.510184 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:33:59.510565 [debug] [MainThread]: Command end result
[0m07:33:59.515524 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24124412, "process_user_time": 1.467261, "process_kernel_time": 0.065055, "process_mem_max_rss": "116820", "process_out_blocks": "1496", "process_in_blocks": "0"}
[0m07:33:59.515920 [debug] [MainThread]: Command `dbt test` succeeded at 07:33:59.515832 after 0.24 seconds
[0m07:33:59.516205 [debug] [MainThread]: Flushing usage events


============================== 07:37:00.798097 | 9955f101-3318-4c6b-8da7-5004b4360596 ==============================
[0m07:37:00.798097 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:37:00.802974 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m07:37:00.946463 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:37:00.952736 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:37:01.000509 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:37:01.000984 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/fact_customer_telcome.sql
[0m07:37:01.089416 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:37:01.090388 [info ] [MainThread]: 
[0m07:37:01.090947 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:37:01.091771 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:37:01.092343 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:37:01.098687 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:37:01.100194 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:37:01.100665 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:37:01.101009 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:37:01.101312 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:01.101586 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:37:01.102491 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:37:01.102777 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:37:01.103715 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:37:01.104052 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:37:01.104302 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:37:01.104697 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:37:01.105210 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:37:01.105634 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:37:01.105948 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:37:01.106236 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:37:01.106554 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:37:01.106841 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:37:01.107902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:37:01.108149 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:37:01.108380 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:37:01.108617 [info ] [MainThread]: 
[0m07:37:01.108900 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:37:01.109232 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:37:01.109799 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.33629847, "process_user_time": 1.537068, "process_kernel_time": 0.076803, "process_mem_max_rss": "119724", "process_out_blocks": "1513", "command_success": false, "process_in_blocks": "0"}
[0m07:37:01.110167 [debug] [MainThread]: Command `dbt run` failed at 07:37:01.110079 after 0.34 seconds
[0m07:37:01.110428 [debug] [MainThread]: Flushing usage events


============================== 07:37:02.556663 | 414fa74e-2fcf-4cd0-9fdd-d832b22e392e ==============================
[0m07:37:02.556663 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:37:02.560827 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m07:37:02.714830 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:37:02.720899 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:37:02.771046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:37:02.771418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:37:02.784197 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:37:02.785021 [info ] [MainThread]: 
[0m07:37:02.785300 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:37:02.785658 [debug] [MainThread]: Command end result
[0m07:37:02.790549 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2585455, "process_user_time": 1.460205, "process_kernel_time": 0.066963, "process_mem_max_rss": "116816", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:37:02.790975 [debug] [MainThread]: Command `dbt test` succeeded at 07:37:02.790875 after 0.26 seconds
[0m07:37:02.791289 [debug] [MainThread]: Flushing usage events


============================== 07:43:29.384062 | 52484742-534d-4895-8ab7-5e2821314229 ==============================
[0m07:43:29.384062 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:43:29.387962 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:43:29.557238 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:43:29.564951 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:43:29.615622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:29.616063 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:29.628297 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:43:29.629234 [info ] [MainThread]: 
[0m07:43:29.629778 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:29.630589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:43:29.631135 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:43:29.637389 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:43:29.638787 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:43:29.639101 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:29.639385 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:29.639652 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:29.639918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:29.640849 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:43:29.641125 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:43:29.641804 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:29.642222 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:29.642533 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:29.642879 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:29.643199 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:43:29.643533 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:43:29.643829 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:29.644112 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:29.644389 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:43:29.644701 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:43:29.645954 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:29.646252 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:43:29.646527 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:43:29.646806 [info ] [MainThread]: 
[0m07:43:29.647146 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:43:29.647576 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:43:29.648154 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2878661, "process_user_time": 1.44592, "process_kernel_time": 0.123821, "process_mem_max_rss": "117076", "process_out_blocks": "1654", "command_success": false, "process_in_blocks": "0"}
[0m07:43:29.648552 [debug] [MainThread]: Command `dbt run` failed at 07:43:29.648463 after 0.29 seconds
[0m07:43:29.648813 [debug] [MainThread]: Flushing usage events


============================== 07:43:31.035316 | 1b478469-5022-46b3-9c8c-003dbe406795 ==============================
[0m07:43:31.035316 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:43:31.039188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:43:31.184066 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:43:31.189302 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:43:31.234984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:31.235335 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:31.246831 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:43:31.247632 [info ] [MainThread]: 
[0m07:43:31.247908 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:31.248243 [debug] [MainThread]: Command end result
[0m07:43:31.253112 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24193205, "process_user_time": 1.402129, "process_kernel_time": 0.061873, "process_mem_max_rss": "116916", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:43:31.253589 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:31.253482 after 0.24 seconds
[0m07:43:31.254010 [debug] [MainThread]: Flushing usage events


============================== 07:43:34.231077 | 601e6975-251a-4c5a-a1b1-63fc9b3baff9 ==============================
[0m07:43:34.231077 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:43:34.235186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:43:34.378167 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:43:34.383455 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:43:34.430703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:34.431040 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:34.444258 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:43:34.445174 [info ] [MainThread]: 
[0m07:43:34.445712 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:43:34.446549 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:43:34.452887 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:43:34.453410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:43:34.453716 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:34.455125 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:43:34.455458 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:34.455802 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:34.456340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:43:34.456709 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:43:34.456997 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:43:34.457548 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:34.457858 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:43:34.458092 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:34.458397 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:34.458734 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:43:34.459038 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:43:34.459331 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:34.459614 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:43:34.459904 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:43:34.460192 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:43:34.461169 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:43:34.461419 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:43:34.461632 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:43:34.461856 [info ] [MainThread]: 
[0m07:43:34.462119 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:43:34.462439 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:43:34.462963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2561415, "process_user_time": 1.389694, "process_kernel_time": 0.085981, "process_mem_max_rss": "117316", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m07:43:34.463319 [debug] [MainThread]: Command `dbt run` failed at 07:43:34.463229 after 0.26 seconds
[0m07:43:34.463594 [debug] [MainThread]: Flushing usage events


============================== 07:43:35.845065 | 264bb7a7-7ed6-4442-a024-3c915333f08a ==============================
[0m07:43:35.845065 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:43:35.848957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:43:35.990803 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:43:35.996001 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:43:36.041143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:43:36.041678 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:43:36.054605 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:43:36.055582 [info ] [MainThread]: 
[0m07:43:36.055890 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:43:36.056336 [debug] [MainThread]: Command end result
[0m07:43:36.061838 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2407512, "process_user_time": 1.399743, "process_kernel_time": 0.060988, "process_mem_max_rss": "116828", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:43:36.062251 [debug] [MainThread]: Command `dbt test` succeeded at 07:43:36.062163 after 0.24 seconds
[0m07:43:36.062531 [debug] [MainThread]: Flushing usage events


============================== 07:53:01.861820 | de5be7cc-4726-4ca7-a116-d9de98e4d3f7 ==============================
[0m07:53:01.861820 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:53:01.867019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m07:53:02.016579 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:53:02.022913 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:53:02.073238 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:53:02.073570 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:53:02.085895 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:53:02.086988 [info ] [MainThread]: 
[0m07:53:02.087719 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:53:02.088797 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:53:02.095786 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:53:02.096244 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:53:02.097838 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:53:02.098180 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:53:02.098479 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:53:02.098742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:02.099029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:53:02.099891 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:53:02.100228 [debug] [ThreadPool]: Postgres adapter: Got a retryable error when attempting to open a postgres connection.
1 attempts remaining. Retrying in 0 seconds.
Error:
connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

[0m07:53:02.100867 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:53:02.101217 [debug] [ThreadPool]: Postgres adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:53:02.101531 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:53:02.101864 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:53:02.102195 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:53:02.102504 [debug] [ThreadPool]: Postgres adapter: Error running SQL: macro list_schemas
[0m07:53:02.102830 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:53:02.103102 [debug] [ThreadPool]: Postgres adapter: Rolling back transaction.
[0m07:53:02.103387 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:53:02.103685 [debug] [ThreadPool]: On list_hginsight: No close available on handle
[0m07:53:02.104780 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:53:02.105004 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:53:02.105203 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:53:02.105428 [info ] [MainThread]: 
[0m07:53:02.105716 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.02 seconds (0.02s).
[0m07:53:02.106226 [error] [MainThread]: Encountered an error:
Database Error
  connection to server at "airflow-postgres" (172.18.0.2), port 9000 failed: Connection refused
  	Is the server running on that host and accepting TCP/IP connections?
  
[0m07:53:02.107006 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.2691593, "process_user_time": 1.464832, "process_kernel_time": 0.081934, "process_mem_max_rss": "117296", "process_out_blocks": "758", "command_success": false, "process_in_blocks": "0"}
[0m07:53:02.107422 [debug] [MainThread]: Command `dbt run` failed at 07:53:02.107341 after 0.27 seconds
[0m07:53:02.107680 [debug] [MainThread]: Flushing usage events


============================== 07:56:21.313034 | a954942e-0eba-4988-ad56-ebb522721825 ==============================
[0m07:56:21.313034 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:56:21.318102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m07:56:21.469879 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:56:21.477353 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:56:21.517681 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m07:56:21.993512 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:56:21.994492 [info ] [MainThread]: 
[0m07:56:21.995052 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:56:21.995878 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:56:22.001764 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:56:22.002801 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:56:22.004204 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:56:22.004627 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:56:22.005096 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:56:22.005551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:22.005947 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:22.009175 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m07:56:22.009503 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m07:56:22.010375 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:56:22.011157 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:56:22.012323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m07:56:22.012915 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m07:56:22.016303 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m07:56:22.016617 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m07:56:22.016878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:22.018881 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.019284 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m07:56:22.019543 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m07:56:22.020020 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m07:56:22.020612 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m07:56:22.020883 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m07:56:22.021109 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m07:56:22.021793 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m07:56:22.022034 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m07:56:22.023226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema)
[0m07:56:22.023788 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m07:56:22.027826 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:56:22.029262 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:56:22.029717 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m07:56:22.029993 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m07:56:22.030260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:22.030523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:22.032563 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.032908 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.033186 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:56:22.033552 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:56:22.033913 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m07:56:22.034258 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m07:56:22.036098 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:56:22.036377 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:56:22.037193 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m07:56:22.037991 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m07:56:22.038448 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m07:56:22.038700 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m07:56:22.042045 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:22.042358 [debug] [MainThread]: On master: BEGIN
[0m07:56:22.042591 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:56:22.044404 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.044834 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:22.045134 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:56:22.048602 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:56:22.049525 [debug] [MainThread]: On master: ROLLBACK
[0m07:56:22.049886 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:22.050133 [debug] [MainThread]: On master: BEGIN
[0m07:56:22.050591 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.050911 [debug] [MainThread]: On master: COMMIT
[0m07:56:22.051169 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:22.051411 [debug] [MainThread]: On master: COMMIT
[0m07:56:22.051752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:56:22.051996 [debug] [MainThread]: On master: Close
[0m07:56:22.052502 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:56:22.052798 [info ] [MainThread]: 
[0m07:56:22.058099 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m07:56:22.058571 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m07:56:22.059089 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m07:56:22.059402 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m07:56:22.063598 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m07:56:22.065473 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 07:56:22.059603 => 07:56:22.065317
[0m07:56:22.065755 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m07:56:22.086114 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m07:56:22.087672 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:56:22.087956 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m07:56:22.088223 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:56:22.090516 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.090937 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:56:22.091304 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql
SELECT
    CAST("CustomerID" AS String) AS customer_id,
    CAST("Gender" AS String) AS gender,
    CAST("Age" AS UInt8) AS age,
    -- Impute missing values for 'SeniorCitizen' with 0 (default/False)
    COALESCE(CAST("SeniorCitizen" AS UInt8), 0) AS is_senior_citizen,
    CAST("Partner" AS String) AS has_partner,
    CAST("Dependents" AS String) AS has_dependents,
    CAST("tenure" AS UInt16) AS tenure_months,
    CAST("PhoneService" AS String) AS has_phone_service,
    CAST("MultipleLines" AS String) AS multiple_lines,
    CAST("InternetService" AS String) AS internet_service,
    CAST("OnlineSecurity" AS String) AS online_security,
    CAST("OnlineBackup" AS String) AS online_backup,
    CAST("DeviceProtection" AS String) AS device_protection,
    CAST("TechSupport" AS String) AS tech_support,
    CAST("StreamingTV" AS String) AS streaming_tv,
    CAST("StreamingMovies" AS String) AS streaming_movies,
    CAST("Contract" AS String) AS contract_type,
    CAST("PaperlessBilling" AS String) AS paperless_billing,
    CAST("PaymentMethod" AS String) AS payment_method,
    -- Impute missing 'MonthlyCharges' with the average (simple default)
    COALESCE(CAST("MonthlyCharges" AS Float32), (SELECT avg(CAST("MonthlyCharges" AS Float32)) FROM staging_db.raw_telecom_data)) AS monthly_charges,
    COALESCE(CAST("TotalCharges" AS Float32), 0.0) AS total_charges, -- Impute missing 'TotalCharges' with 0.0
    CAST("Churn" AS String) AS churn_status
FROM
    staging_db.raw_telecom_data
  );
[0m07:56:22.091861 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_db.raw_telecom_data" does not exist
LINE 34:     staging_db.raw_telecom_data
             ^

[0m07:56:22.092317 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m07:56:22.092791 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 07:56:22.065955 => 07:56:22.092634
[0m07:56:22.093067 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m07:56:22.094380 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_db.raw_telecom_data" does not exist
  LINE 34:     staging_db.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:56:22.094893 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m07:56:22.095362 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m07:56:22.096039 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m07:56:22.096430 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m07:56:22.096774 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m07:56:22.097674 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:22.097950 [debug] [MainThread]: On master: BEGIN
[0m07:56:22.098193 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:56:22.100317 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:56:22.100806 [debug] [MainThread]: On master: COMMIT
[0m07:56:22.101190 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:22.101556 [debug] [MainThread]: On master: COMMIT
[0m07:56:22.101946 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:56:22.102211 [debug] [MainThread]: On master: Close
[0m07:56:22.102709 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:22.102972 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m07:56:22.103236 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m07:56:22.103518 [info ] [MainThread]: 
[0m07:56:22.103797 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m07:56:22.104282 [debug] [MainThread]: Command end result
[0m07:56:22.110818 [info ] [MainThread]: 
[0m07:56:22.111158 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:56:22.111419 [info ] [MainThread]: 
[0m07:56:22.111660 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_db.raw_telecom_data" does not exist
  LINE 34:     staging_db.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:56:22.111897 [info ] [MainThread]: 
[0m07:56:22.112163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:56:22.112778 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.82828677, "process_user_time": 1.989809, "process_kernel_time": 0.084906, "process_mem_max_rss": "124832", "process_out_blocks": "3191", "command_success": false, "process_in_blocks": "0"}
[0m07:56:22.113171 [debug] [MainThread]: Command `dbt run` failed at 07:56:22.113076 after 0.83 seconds
[0m07:56:22.113454 [debug] [MainThread]: Flushing usage events


============================== 07:56:23.490480 | a12c0fd9-0220-4d60-bd2b-6741b9a2c1e5 ==============================
[0m07:56:23.490480 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:56:23.494375 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:56:23.634862 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:56:23.640038 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:56:23.685460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:56:23.685791 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:56:23.697175 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:56:23.697971 [info ] [MainThread]: 
[0m07:56:23.698254 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:56:23.698587 [debug] [MainThread]: Command end result
[0m07:56:23.703133 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.236675, "process_user_time": 1.380389, "process_kernel_time": 0.06597, "process_mem_max_rss": "116832", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:56:23.703577 [debug] [MainThread]: Command `dbt test` succeeded at 07:56:23.703467 after 0.24 seconds
[0m07:56:23.703891 [debug] [MainThread]: Flushing usage events


============================== 07:56:26.642970 | 82fa1b97-de9d-4f9c-91ed-dba03b07c493 ==============================
[0m07:56:26.642970 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:56:26.646777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:56:26.790944 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:56:26.796306 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:56:26.842223 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:56:26.842605 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:56:26.854147 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:56:26.855054 [info ] [MainThread]: 
[0m07:56:26.855582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:56:26.856412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:56:26.862766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:56:26.863692 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:56:26.865216 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:56:26.865539 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:56:26.865853 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:56:26.866157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:26.866464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:26.869422 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m07:56:26.869741 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m07:56:26.870533 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:56:26.871278 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:56:26.872739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight_reporting_schema_reporting_schema'
[0m07:56:26.877191 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:56:26.877686 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m07:56:26.877973 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m07:56:26.879313 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:56:26.879607 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:56:26.879890 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m07:56:26.880314 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:56:26.882004 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:56:26.882316 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:56:26.882690 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:56:26.883039 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:56:26.883391 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m07:56:26.883713 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m07:56:26.885367 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:56:26.885638 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:56:26.886397 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m07:56:26.887073 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m07:56:26.887465 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m07:56:26.887725 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m07:56:26.891100 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:26.891496 [debug] [MainThread]: On master: BEGIN
[0m07:56:26.891767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:56:26.893711 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:56:26.894099 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:26.894427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:56:26.897313 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:56:26.898190 [debug] [MainThread]: On master: ROLLBACK
[0m07:56:26.898562 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:26.898825 [debug] [MainThread]: On master: BEGIN
[0m07:56:26.899222 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:56:26.899568 [debug] [MainThread]: On master: COMMIT
[0m07:56:26.899810 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:26.900029 [debug] [MainThread]: On master: COMMIT
[0m07:56:26.900333 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:56:26.900599 [debug] [MainThread]: On master: Close
[0m07:56:26.901114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:56:26.901423 [info ] [MainThread]: 
[0m07:56:26.905968 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m07:56:26.906417 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m07:56:26.906937 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m07:56:26.907264 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m07:56:26.911508 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m07:56:26.912739 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 07:56:26.907480 => 07:56:26.912545
[0m07:56:26.913113 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m07:56:26.934339 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m07:56:26.935278 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:56:26.935567 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m07:56:26.935827 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:56:26.937900 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:56:26.938332 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:56:26.938664 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql
SELECT
    CAST("CustomerID" AS String) AS customer_id,
    CAST("Gender" AS String) AS gender,
    CAST("Age" AS UInt8) AS age,
    -- Impute missing values for 'SeniorCitizen' with 0 (default/False)
    COALESCE(CAST("SeniorCitizen" AS UInt8), 0) AS is_senior_citizen,
    CAST("Partner" AS String) AS has_partner,
    CAST("Dependents" AS String) AS has_dependents,
    CAST("tenure" AS UInt16) AS tenure_months,
    CAST("PhoneService" AS String) AS has_phone_service,
    CAST("MultipleLines" AS String) AS multiple_lines,
    CAST("InternetService" AS String) AS internet_service,
    CAST("OnlineSecurity" AS String) AS online_security,
    CAST("OnlineBackup" AS String) AS online_backup,
    CAST("DeviceProtection" AS String) AS device_protection,
    CAST("TechSupport" AS String) AS tech_support,
    CAST("StreamingTV" AS String) AS streaming_tv,
    CAST("StreamingMovies" AS String) AS streaming_movies,
    CAST("Contract" AS String) AS contract_type,
    CAST("PaperlessBilling" AS String) AS paperless_billing,
    CAST("PaymentMethod" AS String) AS payment_method,
    -- Impute missing 'MonthlyCharges' with the average (simple default)
    COALESCE(CAST("MonthlyCharges" AS Float32), (SELECT avg(CAST("MonthlyCharges" AS Float32)) FROM staging_db.raw_telecom_data)) AS monthly_charges,
    COALESCE(CAST("TotalCharges" AS Float32), 0.0) AS total_charges, -- Impute missing 'TotalCharges' with 0.0
    CAST("Churn" AS String) AS churn_status
FROM
    staging_db.raw_telecom_data
  );
[0m07:56:26.939208 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_db.raw_telecom_data" does not exist
LINE 34:     staging_db.raw_telecom_data
             ^

[0m07:56:26.939574 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m07:56:26.940018 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 07:56:26.913309 => 07:56:26.939875
[0m07:56:26.940337 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m07:56:26.941754 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_db.raw_telecom_data" does not exist
  LINE 34:     staging_db.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:56:26.942300 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m07:56:26.942730 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m07:56:26.943393 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m07:56:26.943729 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m07:56:26.944052 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m07:56:26.945055 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:26.945322 [debug] [MainThread]: On master: BEGIN
[0m07:56:26.945553 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:56:26.947666 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:56:26.948023 [debug] [MainThread]: On master: COMMIT
[0m07:56:26.948288 [debug] [MainThread]: Using postgres connection "master"
[0m07:56:26.948548 [debug] [MainThread]: On master: COMMIT
[0m07:56:26.948880 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:56:26.949126 [debug] [MainThread]: On master: Close
[0m07:56:26.949596 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:56:26.949840 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m07:56:26.950061 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m07:56:26.950296 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m07:56:26.950642 [info ] [MainThread]: 
[0m07:56:26.951002 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m07:56:26.951477 [debug] [MainThread]: Command end result
[0m07:56:26.957977 [info ] [MainThread]: 
[0m07:56:26.958328 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:56:26.958574 [info ] [MainThread]: 
[0m07:56:26.958818 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_db.raw_telecom_data" does not exist
  LINE 34:     staging_db.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:56:26.959058 [info ] [MainThread]: 
[0m07:56:26.959317 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:56:26.959891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.34064916, "process_user_time": 1.461361, "process_kernel_time": 0.069444, "process_mem_max_rss": "121476", "process_out_blocks": "1538", "command_success": false, "process_in_blocks": "0"}
[0m07:56:26.960279 [debug] [MainThread]: Command `dbt run` failed at 07:56:26.960179 after 0.34 seconds
[0m07:56:26.960548 [debug] [MainThread]: Flushing usage events


============================== 07:56:28.334383 | 7a911045-4584-49d4-827e-d372d22e9d51 ==============================
[0m07:56:28.334383 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:56:28.338279 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m07:56:28.480598 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:56:28.486252 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:56:28.532549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:56:28.532906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:56:28.544596 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:56:28.545425 [info ] [MainThread]: 
[0m07:56:28.545702 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:56:28.546055 [debug] [MainThread]: Command end result
[0m07:56:28.551080 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24021146, "process_user_time": 1.398354, "process_kernel_time": 0.054974, "process_mem_max_rss": "116856", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:56:28.551473 [debug] [MainThread]: Command `dbt test` succeeded at 07:56:28.551389 after 0.24 seconds
[0m07:56:28.551744 [debug] [MainThread]: Flushing usage events


============================== 07:59:17.042602 | 4ab1cb33-7c68-4071-9fcf-2d31aeefc39b ==============================
[0m07:59:17.042602 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:59:17.047516 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m07:59:17.199634 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:59:17.205965 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:59:17.255812 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:59:17.256378 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_telecome_data.sql
[0m07:59:17.347635 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:59:17.348627 [info ] [MainThread]: 
[0m07:59:17.349134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:59:17.349991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:59:17.356666 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:59:17.357136 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:59:17.357454 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:59:17.359568 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:59:17.359909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:17.360198 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:59:17.360651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:17.363324 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m07:59:17.363691 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m07:59:17.364551 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:59:17.365309 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:59:17.366554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m07:59:17.367132 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m07:59:17.370391 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m07:59:17.370693 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m07:59:17.370947 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:17.373029 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.373506 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m07:59:17.373888 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m07:59:17.374437 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m07:59:17.375061 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m07:59:17.375356 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m07:59:17.375649 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m07:59:17.376244 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m07:59:17.376566 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m07:59:17.377902 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema_reporting_schema)
[0m07:59:17.378573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m07:59:17.382408 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:59:17.383932 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:59:17.384244 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m07:59:17.384596 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m07:59:17.384872 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:17.385128 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:17.387120 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.387552 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:59:17.387816 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.388103 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m07:59:17.388432 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:59:17.388856 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m07:59:17.390420 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:17.391253 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m07:59:17.391521 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:17.392229 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m07:59:17.392486 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m07:59:17.392810 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m07:59:17.396208 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:17.396597 [debug] [MainThread]: On master: BEGIN
[0m07:59:17.396879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:17.398793 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.399174 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:17.399607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:59:17.402906 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:17.403754 [debug] [MainThread]: On master: ROLLBACK
[0m07:59:17.404128 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:17.404393 [debug] [MainThread]: On master: BEGIN
[0m07:59:17.404783 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.405071 [debug] [MainThread]: On master: COMMIT
[0m07:59:17.405307 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:17.405580 [debug] [MainThread]: On master: COMMIT
[0m07:59:17.405913 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:17.406165 [debug] [MainThread]: On master: Close
[0m07:59:17.406663 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:59:17.406956 [info ] [MainThread]: 
[0m07:59:17.411837 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m07:59:17.412299 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m07:59:17.412940 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m07:59:17.413267 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m07:59:17.418099 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m07:59:17.419226 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 07:59:17.413484 => 07:59:17.419045
[0m07:59:17.419550 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m07:59:17.439891 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m07:59:17.440917 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:59:17.441202 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m07:59:17.441481 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:59:17.443639 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.444063 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:59:17.444416 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql
SELECT
    CAST("CustomerID" AS String) AS customer_id,
    CAST("Gender" AS String) AS gender,
    CAST("Age" AS UInt8) AS age,
    -- Impute missing values for 'SeniorCitizen' with 0 (default/False)
    COALESCE(CAST("SeniorCitizen" AS UInt8), 0) AS is_senior_citizen,
    CAST("Partner" AS String) AS has_partner,
    CAST("Dependents" AS String) AS has_dependents,
    CAST("tenure" AS UInt16) AS tenure_months,
    CAST("PhoneService" AS String) AS has_phone_service,
    CAST("MultipleLines" AS String) AS multiple_lines,
    CAST("InternetService" AS String) AS internet_service,
    CAST("OnlineSecurity" AS String) AS online_security,
    CAST("OnlineBackup" AS String) AS online_backup,
    CAST("DeviceProtection" AS String) AS device_protection,
    CAST("TechSupport" AS String) AS tech_support,
    CAST("StreamingTV" AS String) AS streaming_tv,
    CAST("StreamingMovies" AS String) AS streaming_movies,
    CAST("Contract" AS String) AS contract_type,
    CAST("PaperlessBilling" AS String) AS paperless_billing,
    CAST("PaymentMethod" AS String) AS payment_method,
    -- Impute missing 'MonthlyCharges' with the average (simple default)
    COALESCE(CAST("MonthlyCharges" AS Float32), (SELECT avg(CAST("MonthlyCharges" AS Float32)) FROM staging_db.raw_telecom_data)) AS monthly_charges,
    COALESCE(CAST("TotalCharges" AS Float32), 0.0) AS total_charges, -- Impute missing 'TotalCharges' with 0.0
    CAST("Churn" AS String) AS churn_status
FROM
    staging_schema.raw_telecom_data
  );
[0m07:59:17.445075 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "string" does not exist
LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                 ^

[0m07:59:17.445513 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m07:59:17.446002 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 07:59:17.419742 => 07:59:17.445845
[0m07:59:17.446298 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m07:59:17.447746 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  type "string" does not exist
  LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:59:17.448262 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m07:59:17.448716 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m07:59:17.449392 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m07:59:17.449723 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m07:59:17.450059 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m07:59:17.451059 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:17.451381 [debug] [MainThread]: On master: BEGIN
[0m07:59:17.451711 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:17.453730 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:17.454125 [debug] [MainThread]: On master: COMMIT
[0m07:59:17.454399 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:17.454671 [debug] [MainThread]: On master: COMMIT
[0m07:59:17.455006 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:17.455246 [debug] [MainThread]: On master: Close
[0m07:59:17.455741 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:17.455988 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m07:59:17.456256 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m07:59:17.456594 [info ] [MainThread]: 
[0m07:59:17.456860 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m07:59:17.457312 [debug] [MainThread]: Command end result
[0m07:59:17.463360 [info ] [MainThread]: 
[0m07:59:17.463702 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:59:17.463947 [info ] [MainThread]: 
[0m07:59:17.464208 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  type "string" does not exist
  LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:59:17.464491 [info ] [MainThread]: 
[0m07:59:17.464744 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:59:17.465312 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44806796, "process_user_time": 1.644579, "process_kernel_time": 0.083079, "process_mem_max_rss": "124156", "process_out_blocks": "3191", "command_success": false, "process_in_blocks": "0"}
[0m07:59:17.465694 [debug] [MainThread]: Command `dbt run` failed at 07:59:17.465607 after 0.45 seconds
[0m07:59:17.465957 [debug] [MainThread]: Flushing usage events


============================== 07:59:18.974493 | e35516b5-4512-4514-a47c-e5eb309549e0 ==============================
[0m07:59:18.974493 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:59:18.979105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m07:59:19.122453 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:59:19.127752 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:59:19.175855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:19.176212 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:19.187834 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:59:19.188735 [info ] [MainThread]: 
[0m07:59:19.189019 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:59:19.189399 [debug] [MainThread]: Command end result
[0m07:59:19.194115 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24425104, "process_user_time": 1.503084, "process_kernel_time": 0.074152, "process_mem_max_rss": "116812", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:59:19.194533 [debug] [MainThread]: Command `dbt test` succeeded at 07:59:19.194441 after 0.24 seconds
[0m07:59:19.194824 [debug] [MainThread]: Flushing usage events


============================== 07:59:22.288005 | 21da7db1-a34c-4dea-93e5-58b28cea12f4 ==============================
[0m07:59:22.288005 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:59:22.292411 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m07:59:22.441079 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:59:22.446700 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:59:22.495173 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:22.495539 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:22.508072 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:59:22.509020 [info ] [MainThread]: 
[0m07:59:22.509554 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m07:59:22.510468 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:59:22.517604 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m07:59:22.518092 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:59:22.519716 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m07:59:22.520113 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:59:22.520430 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m07:59:22.520709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:22.520998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:59:22.524460 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m07:59:22.524813 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m07:59:22.525849 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:59:22.526690 [debug] [ThreadPool]: On list_hginsight: Close
[0m07:59:22.528372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m07:59:22.529065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m07:59:22.534344 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:59:22.535998 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:59:22.536446 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m07:59:22.536815 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m07:59:22.537131 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:22.537465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m07:59:22.540277 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:59:22.540703 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m07:59:22.541018 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m07:59:22.541395 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m07:59:22.541764 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m07:59:22.542127 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m07:59:22.544143 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:22.544474 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:22.545226 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m07:59:22.545981 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m07:59:22.546409 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m07:59:22.546717 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m07:59:22.550363 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.550743 [debug] [MainThread]: On master: BEGIN
[0m07:59:22.551089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m07:59:22.553435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:22.553826 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.554135 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m07:59:22.557199 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m07:59:22.558099 [debug] [MainThread]: On master: ROLLBACK
[0m07:59:22.558458 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.558769 [debug] [MainThread]: On master: BEGIN
[0m07:59:22.559327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:22.559750 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.560045 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.560344 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.560756 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:22.561024 [debug] [MainThread]: On master: Close
[0m07:59:22.561548 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m07:59:22.561854 [info ] [MainThread]: 
[0m07:59:22.566880 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m07:59:22.567372 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m07:59:22.567909 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m07:59:22.568271 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m07:59:22.572584 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m07:59:22.573501 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 07:59:22.568516 => 07:59:22.573340
[0m07:59:22.573796 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m07:59:22.594702 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m07:59:22.595599 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:59:22.595886 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m07:59:22.596149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m07:59:22.598476 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m07:59:22.598884 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m07:59:22.599202 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql
SELECT
    CAST("CustomerID" AS String) AS customer_id,
    CAST("Gender" AS String) AS gender,
    CAST("Age" AS UInt8) AS age,
    -- Impute missing values for 'SeniorCitizen' with 0 (default/False)
    COALESCE(CAST("SeniorCitizen" AS UInt8), 0) AS is_senior_citizen,
    CAST("Partner" AS String) AS has_partner,
    CAST("Dependents" AS String) AS has_dependents,
    CAST("tenure" AS UInt16) AS tenure_months,
    CAST("PhoneService" AS String) AS has_phone_service,
    CAST("MultipleLines" AS String) AS multiple_lines,
    CAST("InternetService" AS String) AS internet_service,
    CAST("OnlineSecurity" AS String) AS online_security,
    CAST("OnlineBackup" AS String) AS online_backup,
    CAST("DeviceProtection" AS String) AS device_protection,
    CAST("TechSupport" AS String) AS tech_support,
    CAST("StreamingTV" AS String) AS streaming_tv,
    CAST("StreamingMovies" AS String) AS streaming_movies,
    CAST("Contract" AS String) AS contract_type,
    CAST("PaperlessBilling" AS String) AS paperless_billing,
    CAST("PaymentMethod" AS String) AS payment_method,
    -- Impute missing 'MonthlyCharges' with the average (simple default)
    COALESCE(CAST("MonthlyCharges" AS Float32), (SELECT avg(CAST("MonthlyCharges" AS Float32)) FROM staging_db.raw_telecom_data)) AS monthly_charges,
    COALESCE(CAST("TotalCharges" AS Float32), 0.0) AS total_charges, -- Impute missing 'TotalCharges' with 0.0
    CAST("Churn" AS String) AS churn_status
FROM
    staging_schema.raw_telecom_data
  );
[0m07:59:22.599846 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "string" does not exist
LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                 ^

[0m07:59:22.600403 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m07:59:22.600933 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 07:59:22.573964 => 07:59:22.600767
[0m07:59:22.601218 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m07:59:22.602672 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  type "string" does not exist
  LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:59:22.603181 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m07:59:22.603626 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m07:59:22.604317 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m07:59:22.604677 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m07:59:22.605006 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m07:59:22.605999 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.606256 [debug] [MainThread]: On master: BEGIN
[0m07:59:22.606533 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m07:59:22.608997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m07:59:22.609364 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.609607 [debug] [MainThread]: Using postgres connection "master"
[0m07:59:22.609831 [debug] [MainThread]: On master: COMMIT
[0m07:59:22.610130 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m07:59:22.610374 [debug] [MainThread]: On master: Close
[0m07:59:22.610831 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:59:22.611118 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m07:59:22.611375 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m07:59:22.611672 [info ] [MainThread]: 
[0m07:59:22.611970 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m07:59:22.612427 [debug] [MainThread]: Command end result
[0m07:59:22.618480 [info ] [MainThread]: 
[0m07:59:22.618802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m07:59:22.619046 [info ] [MainThread]: 
[0m07:59:22.619288 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  type "string" does not exist
  LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m07:59:22.619533 [info ] [MainThread]: 
[0m07:59:22.619778 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m07:59:22.620361 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35896176, "process_user_time": 1.544929, "process_kernel_time": 0.094056, "process_mem_max_rss": "121224", "process_out_blocks": "1538", "command_success": false, "process_in_blocks": "0"}
[0m07:59:22.620786 [debug] [MainThread]: Command `dbt run` failed at 07:59:22.620693 after 0.36 seconds
[0m07:59:22.621070 [debug] [MainThread]: Flushing usage events


============================== 07:59:24.024311 | 2102a02c-df84-431c-a70c-d461c0fb1fca ==============================
[0m07:59:24.024311 [info ] [MainThread]: Running with dbt=1.7.0
[0m07:59:24.028190 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m07:59:24.170288 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m07:59:24.175496 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m07:59:24.220740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:59:24.221074 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:59:24.232717 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m07:59:24.233549 [info ] [MainThread]: 
[0m07:59:24.233858 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m07:59:24.234246 [debug] [MainThread]: Command end result
[0m07:59:24.239415 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23907109, "process_user_time": 1.41541, "process_kernel_time": 0.064063, "process_mem_max_rss": "116980", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m07:59:24.239948 [debug] [MainThread]: Command `dbt test` succeeded at 07:59:24.239816 after 0.24 seconds
[0m07:59:24.240303 [debug] [MainThread]: Flushing usage events


============================== 08:00:05.496193 | d8453023-7363-49c1-a350-fef223e88f1f ==============================
[0m08:00:05.496193 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:00:05.500184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:00:05.643042 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:00:05.648275 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:00:05.693489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:05.693891 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:05.705692 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:00:05.706572 [info ] [MainThread]: 
[0m08:00:05.707072 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:00:05.707875 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:00:05.714365 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:00:05.714749 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:00:05.716136 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:00:05.716467 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:00:05.716782 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:00:05.717075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:05.717379 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:00:05.720568 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:00:05.720876 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:00:05.721686 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:00:05.722397 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:00:05.723940 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:00:05.724597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:00:05.728884 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:00:05.730345 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:00:05.730658 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:00:05.730949 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:00:05.731218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:05.731476 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:00:05.733536 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:00:05.734060 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:00:05.734444 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:00:05.734738 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:00:05.735070 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:00:05.735448 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:00:05.736688 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:00:05.736972 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:00:05.737684 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:00:05.738360 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:00:05.738750 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:00:05.739001 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:00:05.742364 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:05.742756 [debug] [MainThread]: On master: BEGIN
[0m08:00:05.743044 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:00:05.745044 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:00:05.745379 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:05.745677 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:00:05.748596 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:00:05.749379 [debug] [MainThread]: On master: ROLLBACK
[0m08:00:05.749742 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:05.750063 [debug] [MainThread]: On master: BEGIN
[0m08:00:05.750464 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:00:05.750867 [debug] [MainThread]: On master: COMMIT
[0m08:00:05.751106 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:05.751329 [debug] [MainThread]: On master: COMMIT
[0m08:00:05.751632 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:00:05.751878 [debug] [MainThread]: On master: Close
[0m08:00:05.752361 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:00:05.752694 [info ] [MainThread]: 
[0m08:00:05.757671 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:00:05.758129 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:00:05.758624 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:00:05.758931 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:00:05.763248 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:00:05.764160 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:00:05.759136 => 08:00:05.764006
[0m08:00:05.764453 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:00:05.785080 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:00:05.786042 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:00:05.786360 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:00:05.786666 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:00:05.788738 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:00:05.789145 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:00:05.789478 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql
SELECT
    CAST("CustomerID" AS String) AS customer_id,
    CAST("Gender" AS String) AS gender,
    CAST("Age" AS UInt8) AS age,
    -- Impute missing values for 'SeniorCitizen' with 0 (default/False)
    COALESCE(CAST("SeniorCitizen" AS UInt8), 0) AS is_senior_citizen,
    CAST("Partner" AS String) AS has_partner,
    CAST("Dependents" AS String) AS has_dependents,
    CAST("tenure" AS UInt16) AS tenure_months,
    CAST("PhoneService" AS String) AS has_phone_service,
    CAST("MultipleLines" AS String) AS multiple_lines,
    CAST("InternetService" AS String) AS internet_service,
    CAST("OnlineSecurity" AS String) AS online_security,
    CAST("OnlineBackup" AS String) AS online_backup,
    CAST("DeviceProtection" AS String) AS device_protection,
    CAST("TechSupport" AS String) AS tech_support,
    CAST("StreamingTV" AS String) AS streaming_tv,
    CAST("StreamingMovies" AS String) AS streaming_movies,
    CAST("Contract" AS String) AS contract_type,
    CAST("PaperlessBilling" AS String) AS paperless_billing,
    CAST("PaymentMethod" AS String) AS payment_method,
    -- Impute missing 'MonthlyCharges' with the average (simple default)
    COALESCE(CAST("MonthlyCharges" AS Float32), (SELECT avg(CAST("MonthlyCharges" AS Float32)) FROM staging_db.raw_telecom_data)) AS monthly_charges,
    COALESCE(CAST("TotalCharges" AS Float32), 0.0) AS total_charges, -- Impute missing 'TotalCharges' with 0.0
    CAST("Churn" AS String) AS churn_status
FROM
    staging_schema.raw_telecom_data
  );
[0m08:00:05.790108 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "string" does not exist
LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                 ^

[0m08:00:05.790571 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:00:05.791037 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:00:05.764650 => 08:00:05.790890
[0m08:00:05.791326 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:00:05.792665 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  type "string" does not exist
  LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:00:05.793160 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.03s]
[0m08:00:05.793626 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:00:05.794284 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:00:05.794657 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:00:05.794986 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:00:05.796167 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:05.796562 [debug] [MainThread]: On master: BEGIN
[0m08:00:05.796859 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:00:05.798897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:00:05.799299 [debug] [MainThread]: On master: COMMIT
[0m08:00:05.799561 [debug] [MainThread]: Using postgres connection "master"
[0m08:00:05.799832 [debug] [MainThread]: On master: COMMIT
[0m08:00:05.800153 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:00:05.800402 [debug] [MainThread]: On master: Close
[0m08:00:05.800897 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:00:05.801185 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:00:05.801462 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m08:00:05.801764 [info ] [MainThread]: 
[0m08:00:05.802020 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m08:00:05.802475 [debug] [MainThread]: Command end result
[0m08:00:05.809095 [info ] [MainThread]: 
[0m08:00:05.809430 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:00:05.809719 [info ] [MainThread]: 
[0m08:00:05.809985 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  type "string" does not exist
  LINE 9:     CAST("CustomerID" AS String) AS customer_id,
                                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:00:05.810242 [info ] [MainThread]: 
[0m08:00:05.810484 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:00:05.811045 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3388013, "process_user_time": 1.510211, "process_kernel_time": 0.08429, "process_mem_max_rss": "121424", "process_out_blocks": "1538", "command_success": false, "process_in_blocks": "0"}
[0m08:00:05.811405 [debug] [MainThread]: Command `dbt run` failed at 08:00:05.811321 after 0.34 seconds
[0m08:00:05.811694 [debug] [MainThread]: Flushing usage events


============================== 08:00:07.195053 | e4b7bec7-8eaa-4553-a9c2-04fed5e627d5 ==============================
[0m08:00:07.195053 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:00:07.198992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:00:07.345919 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:00:07.351230 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:00:07.398703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:00:07.399073 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:00:07.412272 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:00:07.413124 [info ] [MainThread]: 
[0m08:00:07.413402 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:00:07.413761 [debug] [MainThread]: Command end result
[0m08:00:07.419715 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24892238, "process_user_time": 1.387872, "process_kernel_time": 0.083992, "process_mem_max_rss": "116836", "process_out_blocks": "1497", "process_in_blocks": "0"}
[0m08:00:07.420148 [debug] [MainThread]: Command `dbt test` succeeded at 08:00:07.420054 after 0.25 seconds
[0m08:00:07.420437 [debug] [MainThread]: Flushing usage events


============================== 08:07:59.373258 | 1cd55820-f85a-4141-8e15-fd2f36e29233 ==============================
[0m08:07:59.373258 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:07:59.378196 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m08:07:59.546477 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:07:59.552892 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:07:59.605520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:07:59.606139 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_telecome_data.sql
[0m08:07:59.606572 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/fact_customer_telcome.sql
[0m08:07:59.701903 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:07:59.703028 [info ] [MainThread]: 
[0m08:07:59.703639 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:07:59.704576 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:07:59.711478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:07:59.712723 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:07:59.714333 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:07:59.714681 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:07:59.714994 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:07:59.715356 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:59.715649 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:07:59.719162 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:07:59.719514 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:07:59.720478 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:07:59.721298 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:07:59.722503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:07:59.723120 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:07:59.726769 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:07:59.727100 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:07:59.727387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:59.729594 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.730013 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:07:59.730395 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:07:59.730931 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:07:59.731546 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:07:59.731836 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:07:59.732094 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:07:59.732782 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:07:59.733100 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:07:59.734383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:07:59.734950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema)
[0m08:07:59.738620 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:07:59.740116 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:07:59.740418 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:07:59.740691 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:07:59.740961 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:59.741227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:07:59.743315 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.743678 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.744002 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:07:59.744323 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:07:59.744637 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:07:59.744969 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:07:59.747213 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:07:59.747498 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:07:59.748254 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:07:59.749008 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:07:59.749444 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:07:59.749738 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:07:59.753187 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:59.753544 [debug] [MainThread]: On master: BEGIN
[0m08:07:59.753846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:07:59.756142 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.756501 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:59.756802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:07:59.760403 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:07:59.761316 [debug] [MainThread]: On master: ROLLBACK
[0m08:07:59.761719 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:59.761989 [debug] [MainThread]: On master: BEGIN
[0m08:07:59.762389 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.762735 [debug] [MainThread]: On master: COMMIT
[0m08:07:59.763026 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:59.763251 [debug] [MainThread]: On master: COMMIT
[0m08:07:59.763554 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:07:59.763800 [debug] [MainThread]: On master: Close
[0m08:07:59.764291 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:07:59.764578 [info ] [MainThread]: 
[0m08:07:59.771095 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:07:59.771669 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:07:59.772260 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:07:59.772599 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:07:59.777699 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:07:59.778649 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:07:59.772812 => 08:07:59.778490
[0m08:07:59.778973 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:07:59.800084 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:07:59.800986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:07:59.801353 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:07:59.801626 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:07:59.806199 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.806818 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:07:59.807241 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,
        COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_citizen, -- Default to 0
        "Partner" AS has_partner,
        "Dependents" AS has_dependents,
        "tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "Contract" AS contract_type,
        "PaymentMethod" AS payment_method,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:07:59.808223 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "SeniorCitizen" does not exist
LINE 13:         COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_c...
                          ^

[0m08:07:59.808714 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:07:59.809267 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:07:59.779188 => 08:07:59.809089
[0m08:07:59.809578 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:07:59.811353 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "SeniorCitizen" does not exist
  LINE 13:         COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_c...
                            ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:07:59.812059 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m08:07:59.812708 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:07:59.813453 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:07:59.813965 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:07:59.814429 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:07:59.815486 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:59.815868 [debug] [MainThread]: On master: BEGIN
[0m08:07:59.816165 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:07:59.818977 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:07:59.819414 [debug] [MainThread]: On master: COMMIT
[0m08:07:59.819700 [debug] [MainThread]: Using postgres connection "master"
[0m08:07:59.820069 [debug] [MainThread]: On master: COMMIT
[0m08:07:59.820556 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:07:59.820906 [debug] [MainThread]: On master: Close
[0m08:07:59.821441 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:07:59.821728 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:07:59.821998 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:07:59.822284 [info ] [MainThread]: 
[0m08:07:59.822564 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.12 seconds (0.12s).
[0m08:07:59.823035 [debug] [MainThread]: Command end result
[0m08:07:59.828844 [info ] [MainThread]: 
[0m08:07:59.829188 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:07:59.829428 [info ] [MainThread]: 
[0m08:07:59.829763 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "SeniorCitizen" does not exist
  LINE 13:         COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_c...
                            ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:07:59.830124 [info ] [MainThread]: 
[0m08:07:59.830430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:07:59.831125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4836989, "process_user_time": 1.672482, "process_kernel_time": 0.101968, "process_mem_max_rss": "124388", "process_out_blocks": "3177", "command_success": false, "process_in_blocks": "0"}
[0m08:07:59.831523 [debug] [MainThread]: Command `dbt run` failed at 08:07:59.831438 after 0.48 seconds
[0m08:07:59.831838 [debug] [MainThread]: Flushing usage events


============================== 08:08:01.422724 | f61d2683-d79a-4063-b98f-cc540c27286e ==============================
[0m08:08:01.422724 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:08:01.427056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m08:08:01.578689 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:08:01.585443 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:08:01.640510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:08:01.640974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:08:01.656265 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:08:01.657318 [info ] [MainThread]: 
[0m08:08:01.657651 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:08:01.658056 [debug] [MainThread]: Command end result
[0m08:08:01.664476 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.26553658, "process_user_time": 1.590594, "process_kernel_time": 0.082759, "process_mem_max_rss": "116828", "process_out_blocks": "1491", "process_in_blocks": "0"}
[0m08:08:01.664934 [debug] [MainThread]: Command `dbt test` succeeded at 08:08:01.664845 after 0.27 seconds
[0m08:08:01.665224 [debug] [MainThread]: Flushing usage events


============================== 08:08:04.677921 | 14b5e4bc-3125-48cf-a64c-d92c7f117a68 ==============================
[0m08:08:04.677921 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:08:04.681976 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m08:08:04.823603 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:08:04.828897 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:08:04.874362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:08:04.874716 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:08:04.886162 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:08:04.887030 [info ] [MainThread]: 
[0m08:08:04.887515 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:08:04.888296 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:08:04.894257 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:08:04.895332 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:08:04.896639 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:08:04.897023 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:08:04.897327 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:08:04.897642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:08:04.897924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:08:04.901035 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:08:04.901363 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:08:04.902125 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:08:04.902856 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:08:04.904489 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:08:04.905140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:08:04.909318 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:08:04.910769 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:08:04.911111 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:08:04.911402 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:08:04.911676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:08:04.911953 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:08:04.914055 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:08:04.914498 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:08:04.914775 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:08:04.915060 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:08:04.915369 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:08:04.915757 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:08:04.917084 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:08:04.917875 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:08:04.918148 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:08:04.918476 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:08:04.919134 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:08:04.919860 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:08:04.922945 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:04.923314 [debug] [MainThread]: On master: BEGIN
[0m08:08:04.923564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:08:04.925504 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:08:04.925872 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:04.926169 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:08:04.929249 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:08:04.930025 [debug] [MainThread]: On master: ROLLBACK
[0m08:08:04.930380 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:04.930622 [debug] [MainThread]: On master: BEGIN
[0m08:08:04.931028 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:08:04.931341 [debug] [MainThread]: On master: COMMIT
[0m08:08:04.931609 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:04.931853 [debug] [MainThread]: On master: COMMIT
[0m08:08:04.932187 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:08:04.932435 [debug] [MainThread]: On master: Close
[0m08:08:04.932917 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:08:04.933228 [info ] [MainThread]: 
[0m08:08:04.937883 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:08:04.938319 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:08:04.938832 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:08:04.939106 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:08:04.943180 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:08:04.944049 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:08:04.939275 => 08:08:04.943900
[0m08:08:04.944341 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:08:04.964748 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:08:04.965622 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:08:04.965907 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:08:04.966185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:08:04.968263 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:08:04.968643 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:08:04.968960 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,
        COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_citizen, -- Default to 0
        "Partner" AS has_partner,
        "Dependents" AS has_dependents,
        "tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "Contract" AS contract_type,
        "PaymentMethod" AS payment_method,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:08:04.969581 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "SeniorCitizen" does not exist
LINE 13:         COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_c...
                          ^

[0m08:08:04.969930 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:08:04.970388 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:08:04.944510 => 08:08:04.970225
[0m08:08:04.970697 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:08:04.972093 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "SeniorCitizen" does not exist
  LINE 13:         COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_c...
                            ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:08:04.972601 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.03s]
[0m08:08:04.973025 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:08:04.973675 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:08:04.974024 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:08:04.974348 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:08:04.975294 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:04.975576 [debug] [MainThread]: On master: BEGIN
[0m08:08:04.975819 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:08:04.977855 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:08:04.978404 [debug] [MainThread]: On master: COMMIT
[0m08:08:04.978717 [debug] [MainThread]: Using postgres connection "master"
[0m08:08:04.979005 [debug] [MainThread]: On master: COMMIT
[0m08:08:04.979342 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:08:04.979607 [debug] [MainThread]: On master: Close
[0m08:08:04.980091 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:08:04.980344 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m08:08:04.980594 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:08:04.980876 [info ] [MainThread]: 
[0m08:08:04.981133 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m08:08:04.981592 [debug] [MainThread]: Command end result
[0m08:08:04.987513 [info ] [MainThread]: 
[0m08:08:04.987873 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:08:04.988124 [info ] [MainThread]: 
[0m08:08:04.988362 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "SeniorCitizen" does not exist
  LINE 13:         COALESCE("SeniorCitizen"::INTEGER, 0) AS is_senior_c...
                            ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:08:04.988599 [info ] [MainThread]: 
[0m08:08:04.988857 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:08:04.989431 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.335807, "process_user_time": 1.498806, "process_kernel_time": 0.075888, "process_mem_max_rss": "121588", "process_out_blocks": "1525", "command_success": false, "process_in_blocks": "0"}
[0m08:08:04.989798 [debug] [MainThread]: Command `dbt run` failed at 08:08:04.989716 after 0.34 seconds
[0m08:08:04.990078 [debug] [MainThread]: Flushing usage events


============================== 08:08:06.474689 | e58963d4-6d1c-4032-8854-94a62924fddf ==============================
[0m08:08:06.474689 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:08:06.478900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:08:06.627395 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:08:06.632710 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:08:06.679821 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:08:06.680165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:08:06.692080 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:08:06.692903 [info ] [MainThread]: 
[0m08:08:06.693185 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:08:06.693575 [debug] [MainThread]: Command end result
[0m08:08:06.699067 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24863192, "process_user_time": 1.497715, "process_kernel_time": 0.072743, "process_mem_max_rss": "116796", "process_out_blocks": "1491", "process_in_blocks": "0"}
[0m08:08:06.699599 [debug] [MainThread]: Command `dbt test` succeeded at 08:08:06.699474 after 0.25 seconds
[0m08:08:06.699965 [debug] [MainThread]: Flushing usage events


============================== 08:13:30.503710 | 56853818-e166-45ed-86be-54f9e4ebe044 ==============================
[0m08:13:30.503710 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:13:30.508410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:13:30.655086 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:13:30.660659 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:13:30.707673 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:13:30.708140 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_telecome_data.sql
[0m08:13:30.821705 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:13:30.824856 [info ] [MainThread]: 
[0m08:13:30.827155 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:13:30.829322 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:13:30.836866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:13:30.850771 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:13:30.851352 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:13:30.851869 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:13:30.853717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:30.852588 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:13:30.855980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:30.865207 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:13:30.866807 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:13:30.869242 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:13:30.871332 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:13:30.875610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:13:30.877960 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:13:30.887117 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:13:30.888198 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:13:30.889251 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:30.899184 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:13:30.901686 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:13:30.905609 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:13:30.906956 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:13:30.908026 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:13:30.908613 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:13:30.909282 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:13:30.911011 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:13:30.911713 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:13:30.918847 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema)
[0m08:13:30.921326 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:13:30.931153 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:13:30.934578 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:13:30.935562 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:13:30.937354 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:13:30.939456 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:30.940752 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:30.946726 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:13:30.947809 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:13:30.948561 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:13:30.949301 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:13:30.949925 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:13:30.950474 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:13:30.953153 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:13:30.953613 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:13:30.954612 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:13:30.955902 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:13:30.956893 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:13:30.957370 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:13:30.963357 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:30.964252 [debug] [MainThread]: On master: BEGIN
[0m08:13:30.964918 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:30.969437 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:13:30.970462 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:30.970946 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:13:30.975644 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:13:30.976946 [debug] [MainThread]: On master: ROLLBACK
[0m08:13:30.977489 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:30.977968 [debug] [MainThread]: On master: BEGIN
[0m08:13:30.978817 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:13:30.979369 [debug] [MainThread]: On master: COMMIT
[0m08:13:30.979891 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:30.980310 [debug] [MainThread]: On master: COMMIT
[0m08:13:30.980799 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:13:30.981222 [debug] [MainThread]: On master: Close
[0m08:13:30.982112 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:30.982749 [info ] [MainThread]: 
[0m08:13:30.988402 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:13:30.989021 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:13:30.989536 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:13:30.989898 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:13:30.994882 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:13:30.996045 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:13:30.990213 => 08:13:30.995889
[0m08:13:30.996372 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:13:31.017684 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:13:31.018999 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:13:31.019473 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:13:31.019859 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:13:31.022485 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:13:31.022983 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:13:31.023460 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,
        -- COALESCE("Age"::INTEGER, 0) AS is_senior_citizen, -- Default to 0
        "Partner" AS has_partner,
        "Dependents" AS has_dependents,
        "tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "Contract" AS contract_type,
        "PaymentMethod" AS payment_method,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        -- COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:13:31.024358 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "Partner" does not exist
LINE 14:         "Partner" AS has_partner,
                 ^

[0m08:13:31.024909 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:13:31.025635 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:13:30.996646 => 08:13:31.025382
[0m08:13:31.026665 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:13:31.031129 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "Partner" does not exist
  LINE 14:         "Partner" AS has_partner,
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:13:31.032023 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m08:13:31.032833 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:13:31.033704 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:13:31.034288 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:13:31.034855 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:13:31.036400 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:31.036848 [debug] [MainThread]: On master: BEGIN
[0m08:13:31.037268 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:13:31.040097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:13:31.040579 [debug] [MainThread]: On master: COMMIT
[0m08:13:31.040954 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:31.041313 [debug] [MainThread]: On master: COMMIT
[0m08:13:31.041804 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:13:31.042142 [debug] [MainThread]: On master: Close
[0m08:13:31.042797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:31.043179 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:13:31.043525 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:13:31.043854 [info ] [MainThread]: 
[0m08:13:31.044118 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m08:13:31.044580 [debug] [MainThread]: Command end result
[0m08:13:31.052497 [info ] [MainThread]: 
[0m08:13:31.052953 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:13:31.053279 [info ] [MainThread]: 
[0m08:13:31.053595 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "Partner" does not exist
  LINE 14:         "Partner" AS has_partner,
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:13:31.053907 [info ] [MainThread]: 
[0m08:13:31.054260 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:13:31.054995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.5765686, "process_user_time": 1.697049, "process_kernel_time": 0.109325, "process_mem_max_rss": "124300", "process_out_blocks": "3177", "command_success": false, "process_in_blocks": "0"}
[0m08:13:31.055482 [debug] [MainThread]: Command `dbt run` failed at 08:13:31.055359 after 0.58 seconds
[0m08:13:31.056215 [debug] [MainThread]: Flushing usage events


============================== 08:13:32.544430 | f24ad28c-1fc9-4e9c-be1b-da2f0f27dc6e ==============================
[0m08:13:32.544430 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:13:32.548894 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:13:32.705946 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:13:32.711570 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:13:32.760201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:13:32.760569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:13:32.772530 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:13:32.773340 [info ] [MainThread]: 
[0m08:13:32.773633 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:13:32.773988 [debug] [MainThread]: Command end result
[0m08:13:32.779026 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.26018065, "process_user_time": 1.477521, "process_kernel_time": 0.076129, "process_mem_max_rss": "116912", "process_out_blocks": "1491", "process_in_blocks": "0"}
[0m08:13:32.779445 [debug] [MainThread]: Command `dbt test` succeeded at 08:13:32.779356 after 0.26 seconds
[0m08:13:32.779749 [debug] [MainThread]: Flushing usage events


============================== 08:13:35.839095 | d607c7ff-39be-43ad-a2ec-9fcdb253de37 ==============================
[0m08:13:35.839095 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:13:35.842949 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:13:35.984761 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:13:35.990008 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:13:36.035078 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:13:36.035418 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:13:36.048375 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:13:36.049300 [info ] [MainThread]: 
[0m08:13:36.049818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:13:36.050622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:13:36.057115 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:13:36.057513 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:13:36.058881 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:13:36.059236 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:13:36.059551 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:13:36.059853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:36.060198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:13:36.063106 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:13:36.064016 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:13:36.064858 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:13:36.065918 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:13:36.067098 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:13:36.071403 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:13:36.071858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:13:36.073493 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:13:36.073779 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:13:36.074027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:36.072106 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:13:36.074515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:13:36.076248 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:13:36.077108 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:13:36.077406 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:13:36.076721 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:13:36.077785 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:13:36.078066 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:13:36.078968 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:13:36.079785 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:13:36.080031 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:13:36.080736 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:13:36.080975 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:13:36.081542 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:13:36.084718 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:36.085104 [debug] [MainThread]: On master: BEGIN
[0m08:13:36.085389 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:13:36.087493 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:13:36.087888 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:36.088172 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:13:36.091008 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:13:36.091907 [debug] [MainThread]: On master: ROLLBACK
[0m08:13:36.092262 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:36.092523 [debug] [MainThread]: On master: BEGIN
[0m08:13:36.092911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:13:36.093247 [debug] [MainThread]: On master: COMMIT
[0m08:13:36.093525 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:36.093777 [debug] [MainThread]: On master: COMMIT
[0m08:13:36.094093 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:13:36.094333 [debug] [MainThread]: On master: Close
[0m08:13:36.094846 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:13:36.095138 [info ] [MainThread]: 
[0m08:13:36.099934 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:13:36.100370 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:13:36.100866 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:13:36.101142 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:13:36.105389 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:13:36.106303 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:13:36.101310 => 08:13:36.106135
[0m08:13:36.106601 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:13:36.126975 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:13:36.127825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:13:36.128108 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:13:36.128396 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:13:36.130574 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:13:36.130947 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:13:36.131262 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,
        -- COALESCE("Age"::INTEGER, 0) AS is_senior_citizen, -- Default to 0
        "Partner" AS has_partner,
        "Dependents" AS has_dependents,
        "tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "Contract" AS contract_type,
        "PaymentMethod" AS payment_method,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        -- COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:13:36.131935 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "Partner" does not exist
LINE 14:         "Partner" AS has_partner,
                 ^

[0m08:13:36.132317 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:13:36.132781 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:13:36.106784 => 08:13:36.132631
[0m08:13:36.133082 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:13:36.134398 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "Partner" does not exist
  LINE 14:         "Partner" AS has_partner,
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:13:36.134900 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.03s]
[0m08:13:36.135320 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:13:36.136000 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:13:36.136421 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:13:36.136824 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:13:36.137836 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:36.138116 [debug] [MainThread]: On master: BEGIN
[0m08:13:36.138366 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:13:36.140478 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:13:36.140867 [debug] [MainThread]: On master: COMMIT
[0m08:13:36.141105 [debug] [MainThread]: Using postgres connection "master"
[0m08:13:36.141344 [debug] [MainThread]: On master: COMMIT
[0m08:13:36.141670 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:13:36.141946 [debug] [MainThread]: On master: Close
[0m08:13:36.142384 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:13:36.142648 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:13:36.142871 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:13:36.143125 [info ] [MainThread]: 
[0m08:13:36.143379 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m08:13:36.143836 [debug] [MainThread]: Command end result
[0m08:13:36.149756 [info ] [MainThread]: 
[0m08:13:36.150086 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:13:36.150333 [info ] [MainThread]: 
[0m08:13:36.150571 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  column "Partner" does not exist
  LINE 14:         "Partner" AS has_partner,
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:13:36.150809 [info ] [MainThread]: 
[0m08:13:36.151062 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:13:36.151623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.33624455, "process_user_time": 1.486468, "process_kernel_time": 0.068205, "process_mem_max_rss": "121284", "process_out_blocks": "1525", "command_success": false, "process_in_blocks": "0"}
[0m08:13:36.152043 [debug] [MainThread]: Command `dbt run` failed at 08:13:36.151942 after 0.34 seconds
[0m08:13:36.152351 [debug] [MainThread]: Flushing usage events


============================== 08:13:37.551833 | d078b14d-6f55-48a7-8091-47ac8995cf26 ==============================
[0m08:13:37.551833 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:13:37.555683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:13:37.698368 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:13:37.704166 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:13:37.750554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:13:37.750892 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:13:37.762374 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:13:37.763199 [info ] [MainThread]: 
[0m08:13:37.763475 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:13:37.763827 [debug] [MainThread]: Command end result
[0m08:13:37.768489 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24054837, "process_user_time": 1.406083, "process_kernel_time": 0.067811, "process_mem_max_rss": "116812", "process_out_blocks": "1491", "process_in_blocks": "0"}
[0m08:13:37.768913 [debug] [MainThread]: Command `dbt test` succeeded at 08:13:37.768823 after 0.24 seconds
[0m08:13:37.769220 [debug] [MainThread]: Flushing usage events


============================== 08:23:47.227380 | 0f426070-599b-4abe-8317-b6bcfb273e23 ==============================
[0m08:23:47.227380 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:23:47.232256 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:23:47.382139 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:23:47.388511 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:23:47.439073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:23:47.439588 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_telecome_data.sql
[0m08:23:47.439891 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/fact_customer_telcome.sql
[0m08:23:47.531700 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:23:47.532721 [info ] [MainThread]: 
[0m08:23:47.533253 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:23:47.534112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:23:47.539781 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:23:47.541328 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:23:47.542731 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:23:47.543080 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:23:47.543602 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:23:47.543998 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:47.544373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:47.547904 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:23:47.548205 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:23:47.549009 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:23:47.549735 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:23:47.551015 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:23:47.551636 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:23:47.555314 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:23:47.555684 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:23:47.555950 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:47.557851 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.558219 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:23:47.558533 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:23:47.559143 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:23:47.559825 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:23:47.560120 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:23:47.560445 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:23:47.561125 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:23:47.561414 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:23:47.562754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema_reporting_schema)
[0m08:23:47.563324 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:23:47.566815 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:23:47.568266 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:23:47.568575 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:23:47.568848 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:23:47.569105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:47.569413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:47.571426 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.571884 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.572148 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:23:47.572444 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:23:47.572735 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:23:47.573046 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:23:47.575060 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:47.575350 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:47.576092 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:23:47.576828 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:23:47.577235 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:23:47.577487 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:23:47.580838 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:47.581183 [debug] [MainThread]: On master: BEGIN
[0m08:23:47.581433 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:47.583557 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.583990 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:47.584295 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:23:47.588074 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:47.588881 [debug] [MainThread]: On master: ROLLBACK
[0m08:23:47.589231 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:47.589484 [debug] [MainThread]: On master: BEGIN
[0m08:23:47.589864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.590204 [debug] [MainThread]: On master: COMMIT
[0m08:23:47.590494 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:47.590726 [debug] [MainThread]: On master: COMMIT
[0m08:23:47.591039 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:23:47.591291 [debug] [MainThread]: On master: Close
[0m08:23:47.591768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:23:47.592052 [info ] [MainThread]: 
[0m08:23:47.597407 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:23:47.597869 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:23:47.598404 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:23:47.598717 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:23:47.603579 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:23:47.604860 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:23:47.598919 => 08:23:47.604710
[0m08:23:47.605152 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:23:47.625350 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:23:47.626283 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:23:47.626568 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:23:47.626824 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:23:47.628901 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.629347 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:23:47.629655 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:23:47.630149 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ""Churn""
LINE 21:         "Churn" AS churn_status
                 ^

[0m08:23:47.630533 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:23:47.630943 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:23:47.605340 => 08:23:47.630810
[0m08:23:47.631213 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:23:47.632550 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  syntax error at or near ""Churn""
  LINE 21:         "Churn" AS churn_status
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:23:47.633029 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.03s]
[0m08:23:47.633453 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:23:47.634006 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:23:47.634431 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:23:47.634799 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:23:47.635738 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:47.636027 [debug] [MainThread]: On master: BEGIN
[0m08:23:47.636271 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:23:47.638441 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:47.638839 [debug] [MainThread]: On master: COMMIT
[0m08:23:47.639072 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:47.639326 [debug] [MainThread]: On master: COMMIT
[0m08:23:47.639727 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:23:47.639999 [debug] [MainThread]: On master: Close
[0m08:23:47.640445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:47.640689 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:23:47.640905 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:23:47.641166 [info ] [MainThread]: 
[0m08:23:47.641486 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m08:23:47.642023 [debug] [MainThread]: Command end result
[0m08:23:47.647674 [info ] [MainThread]: 
[0m08:23:47.648001 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:23:47.648257 [info ] [MainThread]: 
[0m08:23:47.648506 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  syntax error at or near ""Churn""
  LINE 21:         "Churn" AS churn_status
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:23:47.648760 [info ] [MainThread]: 
[0m08:23:47.649040 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:23:47.649616 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.44668356, "process_user_time": 1.623664, "process_kernel_time": 0.116831, "process_mem_max_rss": "124404", "process_out_blocks": "3174", "command_success": false, "process_in_blocks": "0"}
[0m08:23:47.650041 [debug] [MainThread]: Command `dbt run` failed at 08:23:47.649936 after 0.45 seconds
[0m08:23:47.650375 [debug] [MainThread]: Flushing usage events


============================== 08:23:49.179195 | d71beba5-20e0-4632-b271-2b351080b5f2 ==============================
[0m08:23:49.179195 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:23:49.183198 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:23:49.334890 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:23:49.342626 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:23:49.393721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:49.394065 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:49.407104 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:23:49.408089 [info ] [MainThread]: 
[0m08:23:49.408422 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:23:49.408840 [debug] [MainThread]: Command end result
[0m08:23:49.414334 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.25932226, "process_user_time": 1.533659, "process_kernel_time": 0.083284, "process_mem_max_rss": "116840", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:23:49.414725 [debug] [MainThread]: Command `dbt test` succeeded at 08:23:49.414639 after 0.26 seconds
[0m08:23:49.415004 [debug] [MainThread]: Flushing usage events


============================== 08:23:52.560388 | 954c1090-3149-48f4-be12-c0ef8ea07434 ==============================
[0m08:23:52.560388 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:23:52.564342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m08:23:52.733377 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:23:52.738847 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:23:52.786801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:52.787146 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:52.798852 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:23:52.799765 [info ] [MainThread]: 
[0m08:23:52.800314 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:23:52.801043 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:23:52.807952 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:23:52.807494 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:23:52.809601 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:23:52.809909 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:23:52.810220 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:23:52.810525 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:52.810803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:52.814227 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:23:52.814539 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:23:52.815341 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:23:52.816120 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:23:52.817760 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight_reporting_schema_reporting_schema'
[0m08:23:52.822043 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:23:52.822517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:23:52.822786 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:23:52.824114 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:23:52.824425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:52.824698 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:23:52.825156 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:23:52.827034 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:23:52.827581 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:23:52.827907 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:23:52.828169 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:23:52.828498 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:23:52.828884 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:23:52.830204 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:52.830481 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:52.831206 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:23:52.831870 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:23:52.832252 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:23:52.832503 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:23:52.836212 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:52.836595 [debug] [MainThread]: On master: BEGIN
[0m08:23:52.836838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:52.839119 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:52.839599 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:52.839920 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:23:52.842937 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:23:52.843881 [debug] [MainThread]: On master: ROLLBACK
[0m08:23:52.844276 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:52.844550 [debug] [MainThread]: On master: BEGIN
[0m08:23:52.844986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:52.845385 [debug] [MainThread]: On master: COMMIT
[0m08:23:52.845692 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:52.845933 [debug] [MainThread]: On master: COMMIT
[0m08:23:52.846331 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:23:52.846652 [debug] [MainThread]: On master: Close
[0m08:23:52.847175 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:23:52.847463 [info ] [MainThread]: 
[0m08:23:52.852246 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:23:52.852752 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:23:52.853293 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:23:52.853639 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:23:52.857887 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:23:52.858974 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:23:52.853853 => 08:23:52.858815
[0m08:23:52.859277 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:23:52.879660 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:23:52.880578 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:23:52.880874 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:23:52.881145 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:23:52.883527 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:23:52.883905 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:23:52.884207 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:23:52.884680 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ""Churn""
LINE 21:         "Churn" AS churn_status
                 ^

[0m08:23:52.885096 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m08:23:52.885541 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:23:52.859475 => 08:23:52.885390
[0m08:23:52.885822 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:23:52.887192 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  syntax error at or near ""Churn""
  LINE 21:         "Churn" AS churn_status
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:23:52.887699 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.03s]
[0m08:23:52.888118 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:23:52.888663 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:23:52.889137 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema_reporting_schema.fact_customer_telcome ... [[33mSKIP[0m]
[0m08:23:52.889477 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:23:52.890432 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:52.890699 [debug] [MainThread]: On master: BEGIN
[0m08:23:52.890952 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:23:52.893125 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:23:52.893577 [debug] [MainThread]: On master: COMMIT
[0m08:23:52.893813 [debug] [MainThread]: Using postgres connection "master"
[0m08:23:52.894035 [debug] [MainThread]: On master: COMMIT
[0m08:23:52.894337 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:23:52.894600 [debug] [MainThread]: On master: Close
[0m08:23:52.895076 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:52.895352 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m08:23:52.895598 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:23:52.895815 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:23:52.896061 [info ] [MainThread]: 
[0m08:23:52.896324 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m08:23:52.896777 [debug] [MainThread]: Command end result
[0m08:23:52.902718 [info ] [MainThread]: 
[0m08:23:52.903022 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:23:52.903252 [info ] [MainThread]: 
[0m08:23:52.903521 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  syntax error at or near ""Churn""
  LINE 21:         "Churn" AS churn_status
                   ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m08:23:52.903781 [info ] [MainThread]: 
[0m08:23:52.904032 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m08:23:52.904603 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36844626, "process_user_time": 1.552456, "process_kernel_time": 0.073115, "process_mem_max_rss": "121480", "process_out_blocks": "1523", "command_success": false, "process_in_blocks": "0"}
[0m08:23:52.904976 [debug] [MainThread]: Command `dbt run` failed at 08:23:52.904893 after 0.37 seconds
[0m08:23:52.905244 [debug] [MainThread]: Flushing usage events


============================== 08:23:54.338473 | 69e5e3e4-7330-45d1-8392-2de0b3fe6332 ==============================
[0m08:23:54.338473 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:23:54.342382 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m08:23:54.488081 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:23:54.493699 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:23:54.539586 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:54.539922 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:54.551362 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:23:54.552161 [info ] [MainThread]: 
[0m08:23:54.552445 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:23:54.552777 [debug] [MainThread]: Command end result
[0m08:23:54.559031 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24414942, "process_user_time": 1.424039, "process_kernel_time": 0.065955, "process_mem_max_rss": "116808", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:23:54.559460 [debug] [MainThread]: Command `dbt test` succeeded at 08:23:54.559370 after 0.24 seconds
[0m08:23:54.559959 [debug] [MainThread]: Flushing usage events


============================== 08:25:44.062208 | 1ec20d92-9bb3-409a-97fc-bd0875b0b255 ==============================
[0m08:25:44.062208 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:25:44.066385 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m08:25:44.211458 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:25:44.217672 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:25:44.266142 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:25:44.266602 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_telecome_data.sql
[0m08:25:44.350905 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:25:44.351842 [info ] [MainThread]: 
[0m08:25:44.352388 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:25:44.353197 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:25:44.359873 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:25:44.360271 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:25:44.361702 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:25:44.362089 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:25:44.362445 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:25:44.362773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:44.363083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:44.366251 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:25:44.366592 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:25:44.367402 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:25:44.368132 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:25:44.369238 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:25:44.369778 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:25:44.373030 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:25:44.373332 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:25:44.373669 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:44.375657 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.376137 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:25:44.376427 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:25:44.376937 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:25:44.377524 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:25:44.377797 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:25:44.378072 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:25:44.378692 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:25:44.378956 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:25:44.380162 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema)
[0m08:25:44.380661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:25:44.384217 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:25:44.385662 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:25:44.385971 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:25:44.386263 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:25:44.386531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:44.386784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:44.388947 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.389322 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.389567 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:25:44.389849 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:25:44.390149 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:25:44.390507 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:25:44.392399 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:25:44.392680 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:25:44.393409 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:25:44.394128 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:25:44.394529 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:25:44.394775 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:25:44.398142 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:44.398522 [debug] [MainThread]: On master: BEGIN
[0m08:25:44.398810 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:44.400815 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.401201 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:44.401510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:25:44.404796 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:25:44.405629 [debug] [MainThread]: On master: ROLLBACK
[0m08:25:44.405979 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:44.406238 [debug] [MainThread]: On master: BEGIN
[0m08:25:44.406619 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.406935 [debug] [MainThread]: On master: COMMIT
[0m08:25:44.407201 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:44.407439 [debug] [MainThread]: On master: COMMIT
[0m08:25:44.407773 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:25:44.408024 [debug] [MainThread]: On master: Close
[0m08:25:44.408554 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:44.408867 [info ] [MainThread]: 
[0m08:25:44.414038 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:25:44.414500 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:25:44.414987 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:25:44.415312 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:25:44.420183 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:25:44.421652 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:25:44.415520 => 08:25:44.421491
[0m08:25:44.421943 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:25:44.442191 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:25:44.443198 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:44.443490 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:25:44.443742 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:25:44.445891 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.446330 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:44.446632 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:25:44.447933 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:25:44.451842 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:44.452171 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:25:44.452605 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:25:44.461051 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:25:44.461390 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:44.461647 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:25:44.462550 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:25:44.466290 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:25:44.469007 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:44.469314 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:25:44.469682 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:25:44.470566 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:25:44.422142 => 08:25:44.470437
[0m08:25:44.470866 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:25:44.471550 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:25:44.471981 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:25:44.472521 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:25:44.472976 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:25:44.473569 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:25:44.473884 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:25:44.475927 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:25:44.477413 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:25:44.474096 => 08:25:44.477270
[0m08:25:44.477696 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:25:44.491140 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:25:44.492609 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:25:44.492932 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:25:44.493195 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:25:44.495262 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.495649 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:25:44.495969 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:25:44.496700 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function digest(bigint, unknown) does not exist
LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:25:44.497124 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: ROLLBACK
[0m08:25:44.497564 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:25:44.477868 => 08:25:44.497425
[0m08:25:44.497854 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:25:44.499202 [debug] [Thread-3  ]: Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:25:44.499716 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[31mERROR[0m in 0.03s]
[0m08:25:44.500161 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:25:44.501159 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:44.501445 [debug] [MainThread]: On master: BEGIN
[0m08:25:44.501684 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:25:44.503669 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:25:44.504165 [debug] [MainThread]: On master: COMMIT
[0m08:25:44.504497 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:44.504792 [debug] [MainThread]: On master: COMMIT
[0m08:25:44.505131 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:25:44.505391 [debug] [MainThread]: On master: Close
[0m08:25:44.505849 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:44.506121 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:25:44.506344 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:25:44.506557 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:25:44.506808 [info ] [MainThread]: 
[0m08:25:44.507074 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:25:44.507591 [debug] [MainThread]: Command end result
[0m08:25:44.513470 [info ] [MainThread]: 
[0m08:25:44.513813 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:25:44.514089 [info ] [MainThread]: 
[0m08:25:44.514478 [error] [MainThread]:   Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:25:44.514847 [info ] [MainThread]: 
[0m08:25:44.515155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:25:44.515777 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.47943795, "process_user_time": 1.641478, "process_kernel_time": 0.096203, "process_mem_max_rss": "125204", "process_out_blocks": "3192", "command_success": false, "process_in_blocks": "0"}
[0m08:25:44.516213 [debug] [MainThread]: Command `dbt run` failed at 08:25:44.516120 after 0.48 seconds
[0m08:25:44.516491 [debug] [MainThread]: Flushing usage events


============================== 08:25:45.905774 | 5e3a81d8-e5e8-43f0-a6ab-6e0a331e88cf ==============================
[0m08:25:45.905774 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:25:45.909681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m08:25:46.050911 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:25:46.056170 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:25:46.101400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:46.101733 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:46.113647 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:25:46.114487 [info ] [MainThread]: 
[0m08:25:46.114790 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:25:46.115184 [debug] [MainThread]: Command end result
[0m08:25:46.122131 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24022609, "process_user_time": 1.390391, "process_kernel_time": 0.066113, "process_mem_max_rss": "116836", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:25:46.122640 [debug] [MainThread]: Command `dbt test` succeeded at 08:25:46.122507 after 0.24 seconds
[0m08:25:46.122965 [debug] [MainThread]: Flushing usage events


============================== 08:25:49.125799 | 3c601ff2-d2f9-40d2-a046-80a77488f6ed ==============================
[0m08:25:49.125799 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:25:49.129730 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m08:25:49.272611 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:25:49.277857 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:25:49.327210 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:49.327597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:49.340369 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:25:49.341299 [info ] [MainThread]: 
[0m08:25:49.341832 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:25:49.342629 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:25:49.349448 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:25:49.349947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:25:49.350224 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:25:49.351651 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:25:49.352004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:49.352330 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:25:49.352918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:49.355648 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:25:49.355962 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:25:49.356748 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:25:49.357542 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:25:49.359060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:25:49.363489 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:25:49.363945 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:25:49.364227 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:25:49.365550 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:25:49.365847 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:49.366119 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:25:49.366559 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:25:49.368418 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.368874 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.369111 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:25:49.369423 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:25:49.369715 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:25:49.370039 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:25:49.371633 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:25:49.371902 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:25:49.372655 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:25:49.373478 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:25:49.373969 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:25:49.374244 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:25:49.377971 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:49.378343 [debug] [MainThread]: On master: BEGIN
[0m08:25:49.378612 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:49.380700 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.381062 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:49.381386 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:25:49.384668 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:25:49.385554 [debug] [MainThread]: On master: ROLLBACK
[0m08:25:49.385926 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:49.386178 [debug] [MainThread]: On master: BEGIN
[0m08:25:49.386561 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.386907 [debug] [MainThread]: On master: COMMIT
[0m08:25:49.387178 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:49.387406 [debug] [MainThread]: On master: COMMIT
[0m08:25:49.387722 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:25:49.387979 [debug] [MainThread]: On master: Close
[0m08:25:49.388448 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:49.388730 [info ] [MainThread]: 
[0m08:25:49.393366 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:25:49.393837 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:25:49.394331 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:25:49.394654 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:25:49.398791 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:25:49.400487 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:25:49.394863 => 08:25:49.400335
[0m08:25:49.400772 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:25:49.421681 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:25:49.423057 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:49.423427 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:25:49.423692 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:25:49.426101 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.426467 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:49.426793 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:25:49.428022 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:25:49.432356 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:49.432720 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m08:25:49.433241 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:25:49.435368 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:49.435773 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:25:49.437724 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:25:49.447829 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:25:49.448235 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:49.448530 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:25:49.449374 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:25:49.453545 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:25:49.456631 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:25:49.457050 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:25:49.458220 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:25:49.459361 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:25:49.400950 => 08:25:49.459219
[0m08:25:49.459687 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:25:49.460426 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.07s]
[0m08:25:49.460892 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:25:49.461555 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:25:49.461990 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:25:49.462494 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:25:49.462778 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:25:49.465106 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:25:49.466132 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:25:49.462955 => 08:25:49.465988
[0m08:25:49.466407 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:25:49.479405 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:25:49.480817 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:25:49.481121 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:25:49.481384 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:25:49.483520 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.483992 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:25:49.484360 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:25:49.485040 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function digest(bigint, unknown) does not exist
LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:25:49.485466 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: ROLLBACK
[0m08:25:49.485936 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:25:49.466575 => 08:25:49.485784
[0m08:25:49.486212 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:25:49.487586 [debug] [Thread-3  ]: Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:25:49.488141 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[31mERROR[0m in 0.03s]
[0m08:25:49.488603 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:25:49.489754 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:49.490038 [debug] [MainThread]: On master: BEGIN
[0m08:25:49.490297 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:25:49.492507 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:25:49.492969 [debug] [MainThread]: On master: COMMIT
[0m08:25:49.493276 [debug] [MainThread]: Using postgres connection "master"
[0m08:25:49.493514 [debug] [MainThread]: On master: COMMIT
[0m08:25:49.493874 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:25:49.494191 [debug] [MainThread]: On master: Close
[0m08:25:49.494649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:49.494915 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:25:49.495136 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:25:49.495346 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:25:49.495602 [info ] [MainThread]: 
[0m08:25:49.495887 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:25:49.496481 [debug] [MainThread]: Command end result
[0m08:25:49.501737 [info ] [MainThread]: 
[0m08:25:49.502094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:25:49.502371 [info ] [MainThread]: 
[0m08:25:49.502660 [error] [MainThread]:   Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:25:49.503052 [info ] [MainThread]: 
[0m08:25:49.503401 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:25:49.504048 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40223268, "process_user_time": 1.587666, "process_kernel_time": 0.067112, "process_mem_max_rss": "122708", "process_out_blocks": "1542", "command_success": false, "process_in_blocks": "0"}
[0m08:25:49.504414 [debug] [MainThread]: Command `dbt run` failed at 08:25:49.504324 after 0.40 seconds
[0m08:25:49.504691 [debug] [MainThread]: Flushing usage events


============================== 08:25:50.951628 | 2587ef22-1dc8-49e8-a4ed-1981db7c8cc5 ==============================
[0m08:25:50.951628 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:25:50.955528 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:25:51.097834 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:25:51.103104 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:25:51.148438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:25:51.148787 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:25:51.160331 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:25:51.161141 [info ] [MainThread]: 
[0m08:25:51.161478 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:25:51.161863 [debug] [MainThread]: Command end result
[0m08:25:51.166462 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23868917, "process_user_time": 1.430971, "process_kernel_time": 0.080278, "process_mem_max_rss": "116816", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:25:51.166855 [debug] [MainThread]: Command `dbt test` succeeded at 08:25:51.166756 after 0.24 seconds
[0m08:25:51.167123 [debug] [MainThread]: Flushing usage events


============================== 08:33:18.618353 | 1a462dac-f37b-4fe1-a846-468717a93ed0 ==============================
[0m08:33:18.618353 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:33:18.622631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:33:18.772600 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:33:18.778420 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:33:18.831200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:33:18.831611 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:33:18.844277 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:33:18.845332 [info ] [MainThread]: 
[0m08:33:18.845950 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:33:18.846813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:33:18.853245 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:33:18.853844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:33:18.854161 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:33:18.855715 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:33:18.856091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:18.856434 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:33:18.856889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:18.859859 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:33:18.860164 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:33:18.860964 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:33:18.861670 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:33:18.862816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:33:18.863392 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:33:18.867095 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:33:18.867461 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:33:18.867718 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:18.869836 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.870385 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:33:18.870826 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:33:18.871359 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:33:18.871988 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:33:18.872298 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:33:18.872592 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:33:18.873350 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:33:18.873652 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:33:18.875044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema)
[0m08:33:18.875646 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:33:18.879449 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:33:18.881071 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:33:18.881467 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:33:18.881731 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:33:18.882013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:18.882296 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:18.884635 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.885079 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.885372 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:33:18.885674 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:33:18.885995 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:33:18.886323 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:33:18.888483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:33:18.888817 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:33:18.889590 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:33:18.890267 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:33:18.890660 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:33:18.890914 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:33:18.894364 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:18.894703 [debug] [MainThread]: On master: BEGIN
[0m08:33:18.894958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:18.897072 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.897463 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:18.897860 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:33:18.901513 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:33:18.902489 [debug] [MainThread]: On master: ROLLBACK
[0m08:33:18.902914 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:18.903167 [debug] [MainThread]: On master: BEGIN
[0m08:33:18.903573 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.903963 [debug] [MainThread]: On master: COMMIT
[0m08:33:18.904320 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:18.904591 [debug] [MainThread]: On master: COMMIT
[0m08:33:18.904968 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:33:18.905304 [debug] [MainThread]: On master: Close
[0m08:33:18.905898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:33:18.906248 [info ] [MainThread]: 
[0m08:33:18.911297 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:33:18.911848 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:33:18.912394 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:33:18.912756 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:33:18.917135 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:33:18.918354 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:33:18.912986 => 08:33:18.918199
[0m08:33:18.918646 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:33:18.939441 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:33:18.940507 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:18.940787 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:33:18.941109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:33:18.943377 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.943773 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:18.944132 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:33:18.945511 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:33:18.950145 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:18.950471 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:33:18.950946 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:18.960189 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:33:18.960619 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:18.960979 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:33:18.961532 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:33:18.965664 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:33:18.968506 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:18.968829 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:33:18.969313 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:33:18.970315 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:33:18.918843 => 08:33:18.970180
[0m08:33:18.970610 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:33:18.971297 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:33:18.971777 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:33:18.972489 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:33:18.972884 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:33:18.973438 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:33:18.973759 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:33:18.975967 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:33:18.977028 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:33:18.973999 => 08:33:18.976884
[0m08:33:18.977320 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:33:18.990638 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:33:18.991815 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:33:18.992137 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:33:18.992442 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:33:18.994670 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:33:18.995085 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:33:18.995404 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:33:18.996073 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function digest(bigint, unknown) does not exist
LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:33:18.996622 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: ROLLBACK
[0m08:33:18.997235 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:33:18.977503 => 08:33:18.997047
[0m08:33:18.997585 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:33:18.999033 [debug] [Thread-3  ]: Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:33:18.999616 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[31mERROR[0m in 0.03s]
[0m08:33:19.000096 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:33:19.001206 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:19.001546 [debug] [MainThread]: On master: BEGIN
[0m08:33:19.001822 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:33:19.004076 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:19.004549 [debug] [MainThread]: On master: COMMIT
[0m08:33:19.004854 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:19.005138 [debug] [MainThread]: On master: COMMIT
[0m08:33:19.005502 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:33:19.005764 [debug] [MainThread]: On master: Close
[0m08:33:19.006272 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:19.006530 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m08:33:19.006754 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:33:19.006986 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:33:19.007242 [info ] [MainThread]: 
[0m08:33:19.007503 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m08:33:19.008032 [debug] [MainThread]: Command end result
[0m08:33:19.013989 [info ] [MainThread]: 
[0m08:33:19.014324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:33:19.014576 [info ] [MainThread]: 
[0m08:33:19.014858 [error] [MainThread]:   Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:33:19.015162 [info ] [MainThread]: 
[0m08:33:19.015432 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:33:19.016024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4229903, "process_user_time": 1.586286, "process_kernel_time": 0.111738, "process_mem_max_rss": "122496", "process_out_blocks": "2440", "command_success": false, "process_in_blocks": "0"}
[0m08:33:19.016399 [debug] [MainThread]: Command `dbt run` failed at 08:33:19.016313 after 0.42 seconds
[0m08:33:19.016672 [debug] [MainThread]: Flushing usage events


============================== 08:33:20.576844 | 1caa0d01-21a9-424d-a2f6-011f35bfb58d ==============================
[0m08:33:20.576844 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:33:20.581168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:33:20.737763 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:33:20.743897 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:33:20.794648 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:33:20.795003 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:33:20.806514 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:33:20.807391 [info ] [MainThread]: 
[0m08:33:20.807672 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:33:20.808075 [debug] [MainThread]: Command end result
[0m08:33:20.813017 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2624066, "process_user_time": 1.542775, "process_kernel_time": 0.102984, "process_mem_max_rss": "116812", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:33:20.813404 [debug] [MainThread]: Command `dbt test` succeeded at 08:33:20.813319 after 0.26 seconds
[0m08:33:20.813664 [debug] [MainThread]: Flushing usage events


============================== 08:33:23.876128 | c774c3cd-59e7-4c3e-b1f6-1346e296375d ==============================
[0m08:33:23.876128 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:33:23.880257 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:33:24.032694 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:33:24.038180 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:33:24.085664 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:33:24.086039 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:33:24.097653 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:33:24.098546 [info ] [MainThread]: 
[0m08:33:24.099054 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:33:24.099914 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:33:24.106622 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:33:24.107111 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:33:24.108489 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:33:24.108816 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:33:24.109179 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:33:24.109451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:24.109711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:33:24.112739 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:33:24.113064 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:33:24.113857 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:33:24.114556 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:33:24.116115 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:33:24.120491 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:33:24.121030 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:33:24.121367 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:33:24.122968 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:33:24.123292 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:24.123587 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:33:24.124018 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:33:24.125589 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.126161 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:33:24.126473 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.126816 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:33:24.127163 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:33:24.127550 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:33:24.128747 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:33:24.129018 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:33:24.129726 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:33:24.130514 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:33:24.130916 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:33:24.131162 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:33:24.134681 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:24.135056 [debug] [MainThread]: On master: BEGIN
[0m08:33:24.135335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:33:24.137252 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.137662 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:24.138000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:33:24.141415 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:33:24.142266 [debug] [MainThread]: On master: ROLLBACK
[0m08:33:24.142618 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:24.142873 [debug] [MainThread]: On master: BEGIN
[0m08:33:24.143258 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.143606 [debug] [MainThread]: On master: COMMIT
[0m08:33:24.143876 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:24.144112 [debug] [MainThread]: On master: COMMIT
[0m08:33:24.144418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:33:24.144659 [debug] [MainThread]: On master: Close
[0m08:33:24.145150 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:33:24.145443 [info ] [MainThread]: 
[0m08:33:24.150086 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:33:24.150520 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:33:24.150998 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:33:24.151273 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:33:24.155447 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:33:24.156323 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:33:24.151446 => 08:33:24.156167
[0m08:33:24.156600 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:33:24.177576 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:33:24.178549 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:24.178843 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:33:24.179093 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:33:24.181222 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.181639 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:24.181990 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:33:24.183152 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:33:24.187350 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:24.187673 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m08:33:24.188153 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:24.190121 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:24.190450 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:33:24.191943 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:33:24.201397 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:33:24.201716 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:24.201989 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:33:24.202910 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:33:24.206621 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:33:24.209332 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:33:24.209633 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:33:24.210431 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:33:24.211335 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:33:24.156808 => 08:33:24.211194
[0m08:33:24.211616 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:33:24.212294 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:33:24.212731 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:33:24.213402 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:33:24.213754 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:33:24.214262 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:33:24.214527 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:33:24.216662 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:33:24.217533 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:33:24.214684 => 08:33:24.217363
[0m08:33:24.217826 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:33:24.230756 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:33:24.231557 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:33:24.231846 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:33:24.232287 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:33:24.234613 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.235054 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:33:24.235371 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:33:24.236009 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function digest(bigint, unknown) does not exist
LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:33:24.236468 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: ROLLBACK
[0m08:33:24.236941 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:33:24.217994 => 08:33:24.236783
[0m08:33:24.237209 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:33:24.238636 [debug] [Thread-3  ]: Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:33:24.239177 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[31mERROR[0m in 0.02s]
[0m08:33:24.239619 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:33:24.240685 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:24.240954 [debug] [MainThread]: On master: BEGIN
[0m08:33:24.241181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:33:24.243095 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:33:24.243548 [debug] [MainThread]: On master: COMMIT
[0m08:33:24.244102 [debug] [MainThread]: Using postgres connection "master"
[0m08:33:24.244450 [debug] [MainThread]: On master: COMMIT
[0m08:33:24.244840 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:33:24.245126 [debug] [MainThread]: On master: Close
[0m08:33:24.245625 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:33:24.245899 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:33:24.246162 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:33:24.246395 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:33:24.246653 [info ] [MainThread]: 
[0m08:33:24.246920 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:33:24.247427 [debug] [MainThread]: Command end result
[0m08:33:24.253046 [info ] [MainThread]: 
[0m08:33:24.253422 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:33:24.253753 [info ] [MainThread]: 
[0m08:33:24.254057 [error] [MainThread]:   Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     ENCODE(DIGEST(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:33:24.254359 [info ] [MainThread]: 
[0m08:33:24.254627 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:33:24.255245 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.40422145, "process_user_time": 1.576029, "process_kernel_time": 0.075049, "process_mem_max_rss": "122620", "process_out_blocks": "1542", "command_success": false, "process_in_blocks": "0"}
[0m08:33:24.255658 [debug] [MainThread]: Command `dbt run` failed at 08:33:24.255564 after 0.40 seconds
[0m08:33:24.255953 [debug] [MainThread]: Flushing usage events


============================== 08:33:25.670711 | 075975cf-2db8-42f9-994b-d662cb7ad4d9 ==============================
[0m08:33:25.670711 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:33:25.674772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:33:25.821405 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:33:25.826699 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:33:25.874098 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:33:25.874432 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:33:25.886463 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:33:25.887311 [info ] [MainThread]: 
[0m08:33:25.887584 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:33:25.887927 [debug] [MainThread]: Command end result
[0m08:33:25.892944 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24732275, "process_user_time": 1.412968, "process_kernel_time": 0.08194, "process_mem_max_rss": "116800", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:33:25.893407 [debug] [MainThread]: Command `dbt test` succeeded at 08:33:25.893300 after 0.25 seconds
[0m08:33:25.893840 [debug] [MainThread]: Flushing usage events


============================== 08:38:27.768836 | 35e5f978-52ff-482e-9bde-120421b4fac8 ==============================
[0m08:38:27.768836 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:38:27.773817 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m08:38:27.916198 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:38:27.922367 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:38:27.968915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:38:27.969352 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/fact_customer_telcome.sql
[0m08:38:28.051772 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:38:28.052696 [info ] [MainThread]: 
[0m08:38:28.053208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:38:28.054028 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:38:28.060622 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:38:28.061173 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:38:28.061485 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:38:28.063056 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:38:28.063445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:28.063811 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:38:28.064272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:28.066861 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:38:28.067141 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:38:28.067957 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:38:28.068719 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:38:28.069968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:38:28.070515 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:38:28.073914 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:38:28.074234 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:38:28.074498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:28.076346 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.076819 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:38:28.077094 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:38:28.077552 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:38:28.078119 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:38:28.078391 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:38:28.078676 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:38:28.079287 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:38:28.079527 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:38:28.080750 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema_reporting_schema)
[0m08:38:28.084380 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:38:28.084818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:38:28.085093 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:38:28.086475 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:38:28.086773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:28.087082 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:38:28.087528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:28.089319 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.089708 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:38:28.090052 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.090396 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:38:28.090756 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:38:28.091238 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:38:28.092570 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:38:28.093430 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:38:28.093738 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:38:28.094112 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:38:28.094786 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:38:28.095536 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:38:28.098702 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:28.099069 [debug] [MainThread]: On master: BEGIN
[0m08:38:28.099315 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:28.101358 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.101712 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:28.102053 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:38:28.105416 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:38:28.106202 [debug] [MainThread]: On master: ROLLBACK
[0m08:38:28.106554 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:28.106803 [debug] [MainThread]: On master: BEGIN
[0m08:38:28.107198 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.107593 [debug] [MainThread]: On master: COMMIT
[0m08:38:28.107854 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:28.108091 [debug] [MainThread]: On master: COMMIT
[0m08:38:28.108400 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:38:28.108638 [debug] [MainThread]: On master: Close
[0m08:38:28.109121 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:28.109412 [info ] [MainThread]: 
[0m08:38:28.113976 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:38:28.114393 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:38:28.114862 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:38:28.115176 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:38:28.119979 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:38:28.121233 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:38:28.115398 => 08:38:28.121087
[0m08:38:28.121531 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:38:28.141594 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:38:28.142583 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:28.142872 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:38:28.143129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:28.145647 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.146086 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:28.146392 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:38:28.147938 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:38:28.151919 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:28.152233 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:38:28.152686 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:38:28.161542 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:38:28.161951 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:28.162384 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:38:28.163188 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:38:28.167226 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:38:28.170098 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:28.170393 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:38:28.170797 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:38:28.171730 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:38:28.121708 => 08:38:28.171593
[0m08:38:28.172022 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:38:28.172671 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:38:28.173120 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:38:28.173789 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:38:28.174232 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:38:28.174822 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:38:28.175118 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:38:28.177242 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:38:28.178091 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:38:28.175311 => 08:38:28.177938
[0m08:38:28.178384 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:38:28.191943 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:38:28.192917 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:38:28.193278 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:38:28.193570 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:38:28.195676 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.196110 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:38:28.196480 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:38:28.197161 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function digest(bigint, unknown) does not exist
LINE 17:     encode(digest(customer_id_raw, 'sha256'), 'hex') AS cust...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:38:28.197607 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: ROLLBACK
[0m08:38:28.198061 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:38:28.178567 => 08:38:28.197915
[0m08:38:28.198332 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:38:28.199622 [debug] [Thread-3  ]: Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     encode(digest(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:38:28.200187 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[31mERROR[0m in 0.03s]
[0m08:38:28.200617 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:38:28.201656 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:28.201959 [debug] [MainThread]: On master: BEGIN
[0m08:38:28.202201 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:28.204172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:38:28.204566 [debug] [MainThread]: On master: COMMIT
[0m08:38:28.205029 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:28.205290 [debug] [MainThread]: On master: COMMIT
[0m08:38:28.205631 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:38:28.205908 [debug] [MainThread]: On master: Close
[0m08:38:28.206402 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:28.206655 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:38:28.206888 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:38:28.207110 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:38:28.207354 [info ] [MainThread]: 
[0m08:38:28.207609 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:38:28.208131 [debug] [MainThread]: Command end result
[0m08:38:28.213681 [info ] [MainThread]: 
[0m08:38:28.214016 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:38:28.214275 [info ] [MainThread]: 
[0m08:38:28.214516 [error] [MainThread]:   Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     encode(digest(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:38:28.214765 [info ] [MainThread]: 
[0m08:38:28.215020 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:38:28.215567 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.47034562, "process_user_time": 1.626386, "process_kernel_time": 0.101024, "process_mem_max_rss": "125328", "process_out_blocks": "3192", "command_success": false, "process_in_blocks": "0"}
[0m08:38:28.215943 [debug] [MainThread]: Command `dbt run` failed at 08:38:28.215857 after 0.47 seconds
[0m08:38:28.216216 [debug] [MainThread]: Flushing usage events


============================== 08:38:29.691938 | e54d7dbe-5de3-4a47-b84e-8e0a0be982f0 ==============================
[0m08:38:29.691938 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:38:29.695972 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:38:29.843418 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:38:29.848833 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:38:29.895680 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:29.896023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:29.907530 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:38:29.908384 [info ] [MainThread]: 
[0m08:38:29.908667 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:38:29.909062 [debug] [MainThread]: Command end result
[0m08:38:29.913805 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2466265, "process_user_time": 1.502581, "process_kernel_time": 0.050019, "process_mem_max_rss": "116788", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:38:29.914201 [debug] [MainThread]: Command `dbt test` succeeded at 08:38:29.914114 after 0.25 seconds
[0m08:38:29.914501 [debug] [MainThread]: Flushing usage events


============================== 08:38:32.996059 | af6a146e-9593-4441-a316-f9beed6874fa ==============================
[0m08:38:32.996059 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:38:33.001341 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:38:33.157846 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:38:33.163497 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:38:33.211896 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:33.212253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:33.226046 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:38:33.227066 [info ] [MainThread]: 
[0m08:38:33.227622 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:38:33.228521 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:38:33.235693 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:38:33.236088 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:38:33.237506 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:38:33.237843 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:38:33.238178 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:38:33.238459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:33.238751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:33.241990 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:38:33.242301 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:38:33.243100 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:38:33.243793 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:38:33.245281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:38:33.250285 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:38:33.250834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:38:33.251113 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:38:33.252488 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:38:33.252791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:33.253060 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:38:33.253498 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:38:33.255282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.255660 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.255921 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:38:33.256211 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:38:33.256498 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:38:33.256809 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:38:33.258522 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:38:33.258764 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:38:33.259491 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:38:33.260227 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:38:33.260627 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:38:33.260898 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:38:33.264596 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:33.264990 [debug] [MainThread]: On master: BEGIN
[0m08:38:33.265307 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:33.267384 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.267771 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:33.268106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:38:33.271494 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:38:33.272352 [debug] [MainThread]: On master: ROLLBACK
[0m08:38:33.272705 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:33.272957 [debug] [MainThread]: On master: BEGIN
[0m08:38:33.273340 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.273608 [debug] [MainThread]: On master: COMMIT
[0m08:38:33.273845 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:33.274066 [debug] [MainThread]: On master: COMMIT
[0m08:38:33.274364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:38:33.274612 [debug] [MainThread]: On master: Close
[0m08:38:33.275116 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:33.275411 [info ] [MainThread]: 
[0m08:38:33.280098 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:38:33.280542 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:38:33.281047 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:38:33.281349 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:38:33.285580 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:38:33.286626 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:38:33.281547 => 08:38:33.286460
[0m08:38:33.286980 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:38:33.307586 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:38:33.308482 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:33.308770 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:38:33.309047 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:38:33.311237 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.311618 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:33.311980 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID" AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:38:33.313335 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:38:33.317208 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:33.317556 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m08:38:33.318020 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:38:33.319984 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:33.320340 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:38:33.321740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:38:33.331013 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:38:33.331311 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:33.331569 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:38:33.332271 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:38:33.336052 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:38:33.338652 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:38:33.338974 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:38:33.339862 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:38:33.340758 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:38:33.287165 => 08:38:33.340617
[0m08:38:33.341045 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:38:33.341718 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:38:33.342242 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:38:33.342877 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:38:33.343307 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:38:33.343817 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:38:33.344089 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:38:33.346177 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:38:33.347234 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:38:33.344260 => 08:38:33.347012
[0m08:38:33.347591 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:38:33.362462 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:38:33.363712 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:38:33.364142 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:38:33.364622 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:38:33.367279 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.367762 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:38:33.368139 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:38:33.368944 [debug] [Thread-3  ]: Postgres adapter: Postgres error: function digest(bigint, unknown) does not exist
LINE 17:     encode(digest(customer_id_raw, 'sha256'), 'hex') AS cust...
                    ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m08:38:33.369450 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: ROLLBACK
[0m08:38:33.370129 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:38:33.347792 => 08:38:33.369874
[0m08:38:33.370579 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:38:33.372344 [debug] [Thread-3  ]: Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     encode(digest(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:38:33.373034 [error] [Thread-3  ]: 2 of 2 ERROR creating sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[31mERROR[0m in 0.03s]
[0m08:38:33.373699 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:38:33.375024 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:33.375475 [debug] [MainThread]: On master: BEGIN
[0m08:38:33.375832 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:38:33.378575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:38:33.379131 [debug] [MainThread]: On master: COMMIT
[0m08:38:33.379443 [debug] [MainThread]: Using postgres connection "master"
[0m08:38:33.379672 [debug] [MainThread]: On master: COMMIT
[0m08:38:33.379989 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:38:33.380271 [debug] [MainThread]: On master: Close
[0m08:38:33.380991 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:33.381412 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:38:33.381720 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:38:33.381970 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:38:33.382246 [info ] [MainThread]: 
[0m08:38:33.382659 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m08:38:33.383198 [debug] [MainThread]: Command end result
[0m08:38:33.389506 [info ] [MainThread]: 
[0m08:38:33.389935 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:38:33.390317 [info ] [MainThread]: 
[0m08:38:33.390678 [error] [MainThread]:   Database Error in model fact_customer_telcome (models/marts/fact_customer_telcome.sql)
  function digest(bigint, unknown) does not exist
  LINE 17:     encode(digest(customer_id_raw, 'sha256'), 'hex') AS cust...
                      ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/dbt_project/models/marts/fact_customer_telcome.sql
[0m08:38:33.391077 [info ] [MainThread]: 
[0m08:38:33.391436 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m08:38:33.392143 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.4229405, "process_user_time": 1.578855, "process_kernel_time": 0.073946, "process_mem_max_rss": "122680", "process_out_blocks": "1542", "command_success": false, "process_in_blocks": "0"}
[0m08:38:33.392638 [debug] [MainThread]: Command `dbt run` failed at 08:38:33.392532 after 0.42 seconds
[0m08:38:33.392945 [debug] [MainThread]: Flushing usage events


============================== 08:38:34.799589 | aadc3f8f-9294-4c2a-9da7-0b5b175d375e ==============================
[0m08:38:34.799589 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:38:34.803510 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:38:34.945757 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:38:34.950910 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:38:34.995832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:34.996199 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:35.007363 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:38:35.008177 [info ] [MainThread]: 
[0m08:38:35.008453 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:38:35.008847 [debug] [MainThread]: Command end result
[0m08:38:35.013460 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23758729, "process_user_time": 1.387758, "process_kernel_time": 0.077097, "process_mem_max_rss": "116808", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:38:35.013853 [debug] [MainThread]: Command `dbt test` succeeded at 08:38:35.013754 after 0.24 seconds
[0m08:38:35.014116 [debug] [MainThread]: Flushing usage events


============================== 08:41:42.467221 | d664ec8c-aef3-4954-b02c-ffe7eb548873 ==============================
[0m08:41:42.467221 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:41:42.472201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:41:42.621988 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:41:42.628403 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:41:42.675418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:41:42.675865 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_telecome_data.sql
[0m08:41:42.760442 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:41:42.761439 [info ] [MainThread]: 
[0m08:41:42.762006 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:41:42.762844 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:41:42.768483 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:41:42.769999 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:41:42.771481 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:41:42.771858 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:41:42.772194 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:41:42.772466 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:42.772773 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:41:42.775867 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:41:42.776216 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:41:42.777040 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:41:42.777796 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:41:42.779292 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:41:42.779926 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:41:42.783856 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:41:42.785227 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:41:42.785528 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:41:42.785817 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:41:42.786147 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:42.786457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:41:42.788605 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.788913 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.789272 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:41:42.789607 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:41:42.789936 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:41:42.790251 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:41:42.791924 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:41:42.792216 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:41:42.792965 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:41:42.793717 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:41:42.794102 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:41:42.794378 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:41:42.798040 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:42.798393 [debug] [MainThread]: On master: BEGIN
[0m08:41:42.798673 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:41:42.800588 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.800943 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:42.801278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:41:42.804596 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:41:42.805556 [debug] [MainThread]: On master: ROLLBACK
[0m08:41:42.805938 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:42.806207 [debug] [MainThread]: On master: BEGIN
[0m08:41:42.806617 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.806935 [debug] [MainThread]: On master: COMMIT
[0m08:41:42.807191 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:42.807412 [debug] [MainThread]: On master: COMMIT
[0m08:41:42.807713 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:41:42.807951 [debug] [MainThread]: On master: Close
[0m08:41:42.808457 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:41:42.808737 [info ] [MainThread]: 
[0m08:41:42.813388 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:41:42.813842 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:41:42.814339 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:41:42.814618 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:41:42.818813 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:41:42.820546 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:41:42.814794 => 08:41:42.820391
[0m08:41:42.820827 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:41:42.841618 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:41:42.842442 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:41:42.842716 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:41:42.842984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:41:42.845179 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.845556 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:41:42.845839 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:41:42.847114 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:41:42.851067 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:41:42.851382 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m08:41:42.851851 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:41:42.853763 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:41:42.854063 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:41:42.854693 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:41:42.864431 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:41:42.864791 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:41:42.865063 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:41:42.865764 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:41:42.869634 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:41:42.872273 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:41:42.872574 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:41:42.873710 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:41:42.874635 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:41:42.821001 => 08:41:42.874485
[0m08:41:42.874936 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:41:42.875609 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:41:42.876121 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:41:42.876811 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:41:42.877228 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:41:42.877769 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:41:42.878125 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:41:42.880207 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:41:42.881220 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:41:42.878331 => 08:41:42.881058
[0m08:41:42.881508 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:41:42.894894 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:41:42.896045 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:41:42.896364 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:41:42.896636 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:41:42.898811 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.899209 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:41:42.899514 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telecom.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:41:42.907740 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m08:41:42.910023 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:41:42.910316 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m08:41:42.910714 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:41:42.913723 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:41:42.914066 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:41:42.914349 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:41:42.915624 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:41:42.917347 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_backup"
[0m08:41:42.918987 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:41:42.919278 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m08:41:42.919678 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:41:42.920546 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:41:42.881676 => 08:41:42.920416
[0m08:41:42.920869 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:41:42.921533 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[32mSELECT 2000[0m in 0.04s]
[0m08:41:42.922006 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:41:42.923037 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:42.923302 [debug] [MainThread]: On master: BEGIN
[0m08:41:42.923528 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:41:42.925465 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:41:42.925886 [debug] [MainThread]: On master: COMMIT
[0m08:41:42.926154 [debug] [MainThread]: Using postgres connection "master"
[0m08:41:42.926377 [debug] [MainThread]: On master: COMMIT
[0m08:41:42.926649 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:41:42.926878 [debug] [MainThread]: On master: Close
[0m08:41:42.927319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:41:42.927566 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:41:42.927786 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:41:42.928073 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:41:42.928362 [info ] [MainThread]: 
[0m08:41:42.928631 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m08:41:42.929131 [debug] [MainThread]: Command end result
[0m08:41:42.934988 [info ] [MainThread]: 
[0m08:41:42.935303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:41:42.935550 [info ] [MainThread]: 
[0m08:41:42.935803 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:41:42.936377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.49311265, "process_user_time": 1.628361, "process_kernel_time": 0.066136, "process_mem_max_rss": "125268", "process_out_blocks": "2295", "process_in_blocks": "0"}
[0m08:41:42.936757 [debug] [MainThread]: Command `dbt run` succeeded at 08:41:42.936677 after 0.49 seconds
[0m08:41:42.937031 [debug] [MainThread]: Flushing usage events


============================== 08:41:44.324955 | 83e3e8bd-0e50-44e5-beb3-7b4c708d7890 ==============================
[0m08:41:44.324955 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:41:44.328929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:41:44.471309 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:41:44.476453 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:41:44.522913 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:41:44.523286 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:41:44.536528 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:41:44.537424 [info ] [MainThread]: 
[0m08:41:44.537738 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:41:44.538138 [debug] [MainThread]: Command end result
[0m08:41:44.543998 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24259034, "process_user_time": 1.392998, "process_kernel_time": 0.061911, "process_mem_max_rss": "116904", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:41:44.544455 [debug] [MainThread]: Command `dbt test` succeeded at 08:41:44.544355 after 0.24 seconds
[0m08:41:44.544737 [debug] [MainThread]: Flushing usage events


============================== 08:45:08.143245 | 0cfdbb8a-9efd-410d-8d65-5260c74c2fb7 ==============================
[0m08:45:08.143245 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:45:08.147957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:45:08.296465 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:45:08.301902 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:45:08.350254 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:45:08.350704 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/fact_customer_telcome.sql
[0m08:45:08.436417 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:45:08.437375 [info ] [MainThread]: 
[0m08:45:08.437930 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:08.438754 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:45:08.445573 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:45:08.446133 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:45:08.446471 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:45:08.448116 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:45:08.448461 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:08.448768 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:45:08.449204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:08.451931 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:45:08.452296 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m08:45:08.453118 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:45:08.453838 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:45:08.454948 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now create_hginsight_reporting_schema_reporting_schema)
[0m08:45:08.455503 [debug] [ThreadPool]: Creating schema "database: "hginsight"
schema: "reporting_schema_reporting_schema"
"
[0m08:45:08.459065 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:45:08.459545 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:45:08.459891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:08.462044 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.462561 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:45:08.462852 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "create_hginsight_reporting_schema_reporting_schema"} */
create schema if not exists "reporting_schema_reporting_schema"
[0m08:45:08.463392 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.0 seconds
[0m08:45:08.464063 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:45:08.464334 [debug] [ThreadPool]: Using postgres connection "create_hginsight_reporting_schema_reporting_schema"
[0m08:45:08.464651 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: COMMIT
[0m08:45:08.465315 [debug] [ThreadPool]: SQL status: COMMIT in 0.0 seconds
[0m08:45:08.465603 [debug] [ThreadPool]: On create_hginsight_reporting_schema_reporting_schema: Close
[0m08:45:08.466910 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_hginsight_reporting_schema_reporting_schema, now list_hginsight_reporting_schema_reporting_schema)
[0m08:45:08.467440 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:45:08.471199 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:45:08.472665 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:45:08.473011 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:45:08.473291 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:45:08.473556 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:08.473819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:08.475767 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.476129 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.476432 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:45:08.476786 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:45:08.477143 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:45:08.477480 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:45:08.479432 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:45:08.479696 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m08:45:08.480447 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:45:08.481173 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:45:08.481562 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:45:08.482250 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:45:08.485425 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:08.485775 [debug] [MainThread]: On master: BEGIN
[0m08:45:08.486024 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:08.488013 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.488421 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:08.488736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:08.492340 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m08:45:08.493197 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:08.493635 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:08.493931 [debug] [MainThread]: On master: BEGIN
[0m08:45:08.494469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.494877 [debug] [MainThread]: On master: COMMIT
[0m08:45:08.495151 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:08.495464 [debug] [MainThread]: On master: COMMIT
[0m08:45:08.495835 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:45:08.496115 [debug] [MainThread]: On master: Close
[0m08:45:08.496627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:08.496911 [info ] [MainThread]: 
[0m08:45:08.502287 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:45:08.502772 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:45:08.503315 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:45:08.503621 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:45:08.508526 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:45:08.509629 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:45:08.503816 => 08:45:08.509466
[0m08:45:08.509943 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:45:08.530819 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:45:08.531986 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:08.532332 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:45:08.532602 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:45:08.534843 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.535285 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:08.535594 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:45:08.537007 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:45:08.541608 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:08.542003 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:45:08.542573 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:45:08.551343 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:45:08.551679 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:08.551951 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:45:08.552668 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:45:08.556552 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:45:08.559272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:08.559557 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:45:08.560011 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:45:08.560920 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:45:08.510159 => 08:45:08.560779
[0m08:45:08.561202 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:45:08.561831 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:45:08.562291 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:45:08.562930 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:45:08.563353 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:45:08.563902 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:45:08.564227 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:45:08.566403 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:45:08.567498 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:45:08.564441 => 08:45:08.567340
[0m08:45:08.567796 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:45:08.582984 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:45:08.584123 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:08.584414 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:45:08.584674 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:45:08.586966 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.587477 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:08.587879 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:45:08.597165 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m08:45:08.599550 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:08.599882 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m08:45:08.600381 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:45:08.603531 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:45:08.603839 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:08.604159 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:45:08.605310 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:45:08.607005 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_backup"
[0m08:45:08.608697 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:08.609002 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m08:45:08.609384 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:45:08.610270 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:45:08.567991 => 08:45:08.610128
[0m08:45:08.610553 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:45:08.611231 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[32mSELECT 2000[0m in 0.05s]
[0m08:45:08.611721 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:45:08.612885 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:08.613201 [debug] [MainThread]: On master: BEGIN
[0m08:45:08.613454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:08.615326 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:45:08.615732 [debug] [MainThread]: On master: COMMIT
[0m08:45:08.616082 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:08.616355 [debug] [MainThread]: On master: COMMIT
[0m08:45:08.616644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:45:08.616893 [debug] [MainThread]: On master: Close
[0m08:45:08.617360 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:08.617604 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema_reporting_schema' was properly closed.
[0m08:45:08.617831 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:45:08.618048 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:45:08.618318 [info ] [MainThread]: 
[0m08:45:08.618598 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m08:45:08.619141 [debug] [MainThread]: Command end result
[0m08:45:08.624752 [info ] [MainThread]: 
[0m08:45:08.625151 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:08.625443 [info ] [MainThread]: 
[0m08:45:08.625702 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:45:08.626284 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5086882, "process_user_time": 1.663747, "process_kernel_time": 0.12959, "process_mem_max_rss": "125148", "process_out_blocks": "3192", "process_in_blocks": "0"}
[0m08:45:08.626641 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:08.626561 after 0.51 seconds
[0m08:45:08.626915 [debug] [MainThread]: Flushing usage events


============================== 08:45:10.106770 | 68a6f82a-fa82-49bc-b0a3-4d0d9d3a9455 ==============================
[0m08:45:10.106770 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:45:10.110823 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:45:10.259323 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:45:10.264872 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:45:10.312496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:10.312890 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:10.325854 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:45:10.326694 [info ] [MainThread]: 
[0m08:45:10.327034 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:10.327413 [debug] [MainThread]: Command end result
[0m08:45:10.333039 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.25084174, "process_user_time": 1.458905, "process_kernel_time": 0.080883, "process_mem_max_rss": "116932", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:45:10.333630 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:10.333470 after 0.25 seconds
[0m08:45:10.333927 [debug] [MainThread]: Flushing usage events


============================== 08:45:13.405526 | 6001e6e2-d75e-4f3c-b7d4-b728ca18805b ==============================
[0m08:45:13.405526 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:45:13.409489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:45:13.551129 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:45:13.556313 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:45:13.601714 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:13.602059 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:13.613352 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:45:13.614254 [info ] [MainThread]: 
[0m08:45:13.614821 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:45:13.615681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:45:13.622140 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:45:13.622487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:45:13.623059 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:45:13.624459 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:45:13.624750 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:13.625081 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:45:13.625619 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:13.628209 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:45:13.628517 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:45:13.629342 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:45:13.630050 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:45:13.631575 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema_reporting_schema)
[0m08:45:13.635898 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:45:13.636371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:45:13.636610 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: BEGIN
[0m08:45:13.637964 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:45:13.638273 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:13.638554 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:45:13.638982 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:45:13.640637 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.641078 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.641326 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema_reporting_schema"
[0m08:45:13.641665 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:45:13.642046 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema_reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema_reporting_schema'
  
[0m08:45:13.642394 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:45:13.644012 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:45:13.644292 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:45:13.645109 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:45:13.645826 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: ROLLBACK
[0m08:45:13.646216 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:45:13.646467 [debug] [ThreadPool]: On list_hginsight_reporting_schema_reporting_schema: Close
[0m08:45:13.650183 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:13.650549 [debug] [MainThread]: On master: BEGIN
[0m08:45:13.650881 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:13.652957 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.653360 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:13.653645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:45:13.657226 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:45:13.658010 [debug] [MainThread]: On master: ROLLBACK
[0m08:45:13.658368 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:13.658632 [debug] [MainThread]: On master: BEGIN
[0m08:45:13.659091 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.659511 [debug] [MainThread]: On master: COMMIT
[0m08:45:13.659757 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:13.659994 [debug] [MainThread]: On master: COMMIT
[0m08:45:13.660308 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:45:13.660565 [debug] [MainThread]: On master: Close
[0m08:45:13.661047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:13.661344 [info ] [MainThread]: 
[0m08:45:13.665818 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:45:13.666263 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:45:13.666762 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:45:13.667057 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:45:13.671264 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:45:13.672135 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:45:13.667283 => 08:45:13.671986
[0m08:45:13.672415 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:45:13.692715 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:45:13.693562 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:13.693854 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:45:13.694124 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:45:13.696172 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.696687 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:13.697046 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:45:13.698240 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:45:13.702153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:13.702474 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m08:45:13.702932 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:45:13.704843 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:13.705297 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:45:13.706719 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:45:13.716063 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:45:13.716389 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:13.716666 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:45:13.717529 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:45:13.721343 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:45:13.723988 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:45:13.724297 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:45:13.725218 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:45:13.726163 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:45:13.672582 => 08:45:13.726026
[0m08:45:13.726479 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:45:13.727135 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:45:13.727617 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:45:13.728203 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:45:13.728671 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema_reporting_schema.fact_customer_telcome  [RUN]
[0m08:45:13.729196 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:45:13.729471 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:45:13.731591 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:45:13.732382 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:45:13.729640 => 08:45:13.732227
[0m08:45:13.732656 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:45:13.746387 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:45:13.747269 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:13.747547 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:45:13.747803 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:45:13.750010 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.750395 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:13.750693 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:45:13.757750 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m08:45:13.760230 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:13.760567 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m08:45:13.761042 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:45:13.762875 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:13.763167 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m08:45:13.763587 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:45:13.766907 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:45:13.767224 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:13.767503 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:45:13.768391 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:45:13.770040 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_backup"
[0m08:45:13.772356 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:45:13.772663 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema_reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m08:45:13.773839 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:45:13.774743 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:45:13.732824 => 08:45:13.774613
[0m08:45:13.775056 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:45:13.775708 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema_reporting_schema.fact_customer_telcome  [[32mSELECT 2000[0m in 0.05s]
[0m08:45:13.776187 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:45:13.777288 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:13.777569 [debug] [MainThread]: On master: BEGIN
[0m08:45:13.777815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:45:13.779765 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:45:13.780088 [debug] [MainThread]: On master: COMMIT
[0m08:45:13.780352 [debug] [MainThread]: Using postgres connection "master"
[0m08:45:13.780567 [debug] [MainThread]: On master: COMMIT
[0m08:45:13.780836 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:45:13.781074 [debug] [MainThread]: On master: Close
[0m08:45:13.781514 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:13.781772 [debug] [MainThread]: Connection 'list_hginsight_reporting_schema' was properly closed.
[0m08:45:13.782007 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:45:13.782218 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:45:13.782463 [info ] [MainThread]: 
[0m08:45:13.782719 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m08:45:13.783232 [debug] [MainThread]: Command end result
[0m08:45:13.788502 [info ] [MainThread]: 
[0m08:45:13.788854 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:13.789141 [info ] [MainThread]: 
[0m08:45:13.789407 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:45:13.789952 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40852594, "process_user_time": 1.547149, "process_kernel_time": 0.088122, "process_mem_max_rss": "122308", "process_out_blocks": "1543", "process_in_blocks": "0"}
[0m08:45:13.790317 [debug] [MainThread]: Command `dbt run` succeeded at 08:45:13.790235 after 0.41 seconds
[0m08:45:13.790582 [debug] [MainThread]: Flushing usage events


============================== 08:45:15.307911 | c012cbe7-9985-42b2-b8bb-64b7d2f950e0 ==============================
[0m08:45:15.307911 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:45:15.311821 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m08:45:15.453038 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:45:15.458248 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:45:15.505160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:15.505498 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:15.517038 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:45:15.517875 [info ] [MainThread]: 
[0m08:45:15.518159 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:15.518497 [debug] [MainThread]: Command end result
[0m08:45:15.524194 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23997591, "process_user_time": 1.421906, "process_kernel_time": 0.062951, "process_mem_max_rss": "116808", "process_out_blocks": "1490", "process_in_blocks": "0"}
[0m08:45:15.524700 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:15.524596 after 0.24 seconds
[0m08:45:15.525033 [debug] [MainThread]: Flushing usage events


============================== 08:47:06.153726 | 2a2d9e87-0bb1-4d74-9c11-5d7986a1f7c4 ==============================
[0m08:47:06.153726 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:47:06.158865 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:47:06.305328 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:47:06.311577 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:47:06.358290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:47:06.358765 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/marts/fact_customer_telcome.sql
[0m08:47:06.444516 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:47:06.445507 [info ] [MainThread]: 
[0m08:47:06.446086 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m08:47:06.446938 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m08:47:06.453455 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m08:47:06.453763 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m08:47:06.454079 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:47:06.457293 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.0 seconds
[0m08:47:06.458218 [debug] [ThreadPool]: On list_hginsight: Close
[0m08:47:06.459891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m08:47:06.463722 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:47:06.464014 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m08:47:06.464264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m08:47:06.466195 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m08:47:06.466632 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m08:47:06.466987 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m08:47:06.468622 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.0 seconds
[0m08:47:06.469538 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m08:47:06.469903 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m08:47:06.473105 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:06.473448 [debug] [MainThread]: On master: BEGIN
[0m08:47:06.473713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:47:06.475605 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:47:06.475987 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:06.476364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m08:47:06.479991 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m08:47:06.480915 [debug] [MainThread]: On master: ROLLBACK
[0m08:47:06.481306 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:06.481556 [debug] [MainThread]: On master: BEGIN
[0m08:47:06.481949 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:47:06.482325 [debug] [MainThread]: On master: COMMIT
[0m08:47:06.482575 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:06.482801 [debug] [MainThread]: On master: COMMIT
[0m08:47:06.483138 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:47:06.483410 [debug] [MainThread]: On master: Close
[0m08:47:06.483903 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:47:06.484204 [info ] [MainThread]: 
[0m08:47:06.489059 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m08:47:06.489502 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m08:47:06.489968 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m08:47:06.490257 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m08:47:06.494346 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m08:47:06.495726 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 08:47:06.490433 => 08:47:06.495542
[0m08:47:06.496027 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m08:47:06.517553 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m08:47:06.518668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:47:06.518979 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m08:47:06.519265 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m08:47:06.521734 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m08:47:06.522202 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:47:06.522574 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m08:47:06.523983 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m08:47:06.528904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:47:06.529244 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m08:47:06.529951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:47:06.532170 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:47:06.532483 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m08:47:06.532967 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:47:06.542529 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:47:06.542834 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:47:06.543099 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m08:47:06.543990 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m08:47:06.547845 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m08:47:06.550481 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m08:47:06.550795 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m08:47:06.551708 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m08:47:06.552669 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 08:47:06.496292 => 08:47:06.552531
[0m08:47:06.552980 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m08:47:06.553680 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m08:47:06.554175 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m08:47:06.554801 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m08:47:06.555252 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m08:47:06.555783 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m08:47:06.556061 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m08:47:06.558118 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m08:47:06.559125 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 08:47:06.556250 => 08:47:06.558959
[0m08:47:06.559399 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m08:47:06.572674 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m08:47:06.573976 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:47:06.574312 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m08:47:06.574597 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m08:47:06.576808 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m08:47:06.577202 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:47:06.577507 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m08:47:06.587670 [debug] [Thread-3  ]: SQL status: SELECT 3000 in 0.0 seconds
[0m08:47:06.590056 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:47:06.590399 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m08:47:06.590822 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m08:47:06.593991 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:47:06.594310 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:47:06.594573 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m08:47:06.595703 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m08:47:06.597360 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m08:47:06.599755 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m08:47:06.600086 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m08:47:06.600472 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m08:47:06.601343 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 08:47:06.559565 => 08:47:06.601202
[0m08:47:06.601634 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m08:47:06.602293 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 3000[0m in 0.05s]
[0m08:47:06.602745 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m08:47:06.603929 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:06.604226 [debug] [MainThread]: On master: BEGIN
[0m08:47:06.604469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m08:47:06.606512 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m08:47:06.606919 [debug] [MainThread]: On master: COMMIT
[0m08:47:06.607324 [debug] [MainThread]: Using postgres connection "master"
[0m08:47:06.607588 [debug] [MainThread]: On master: COMMIT
[0m08:47:06.607904 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m08:47:06.608146 [debug] [MainThread]: On master: Close
[0m08:47:06.608616 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:47:06.608884 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m08:47:06.609143 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m08:47:06.609439 [info ] [MainThread]: 
[0m08:47:06.609720 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m08:47:06.610292 [debug] [MainThread]: Command end result
[0m08:47:06.616359 [info ] [MainThread]: 
[0m08:47:06.616684 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:47:06.616942 [info ] [MainThread]: 
[0m08:47:06.617207 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:47:06.617801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.48819864, "process_user_time": 1.598171, "process_kernel_time": 0.073237, "process_mem_max_rss": "124772", "process_out_blocks": "2288", "process_in_blocks": "0"}
[0m08:47:06.618179 [debug] [MainThread]: Command `dbt run` succeeded at 08:47:06.618095 after 0.49 seconds
[0m08:47:06.618533 [debug] [MainThread]: Flushing usage events


============================== 08:47:08.014598 | 6ace5986-8b97-444b-a90d-469cc08c45b1 ==============================
[0m08:47:08.014598 [info ] [MainThread]: Running with dbt=1.7.0
[0m08:47:08.018491 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m08:47:08.165011 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m08:47:08.170503 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m08:47:08.216588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:47:08.216924 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:47:08.228773 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m08:47:08.229568 [info ] [MainThread]: 
[0m08:47:08.229843 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:47:08.230235 [debug] [MainThread]: Command end result
[0m08:47:08.235192 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2446735, "process_user_time": 1.409342, "process_kernel_time": 0.050083, "process_mem_max_rss": "116828", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m08:47:08.235590 [debug] [MainThread]: Command `dbt test` succeeded at 08:47:08.235502 after 0.25 seconds
[0m08:47:08.235898 [debug] [MainThread]: Flushing usage events


============================== 10:06:57.482579 | 8e8cf43f-4cac-45b0-82ef-d1597be3cb0c ==============================
[0m10:06:57.482579 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:06:57.487174 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m10:06:57.639083 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:06:57.645422 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:06:57.694082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:57.694420 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:57.706954 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:06:57.707854 [info ] [MainThread]: 
[0m10:06:57.708356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:06:57.709163 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:06:57.715265 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:06:57.715583 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:06:57.715873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:06:57.719074 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:06:57.719946 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:06:57.721073 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:06:57.724872 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:06:57.725172 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:06:57.725444 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:06:57.727386 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:06:57.727765 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:06:57.728058 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:06:57.730702 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:06:57.731834 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:06:57.732455 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:06:57.736911 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:57.737607 [debug] [MainThread]: On master: BEGIN
[0m10:06:57.737925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:06:57.741026 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:06:57.741578 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:57.741979 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:06:57.745891 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:06:57.746763 [debug] [MainThread]: On master: ROLLBACK
[0m10:06:57.747131 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:57.747516 [debug] [MainThread]: On master: BEGIN
[0m10:06:57.748178 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:06:57.748640 [debug] [MainThread]: On master: COMMIT
[0m10:06:57.748917 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:57.749202 [debug] [MainThread]: On master: COMMIT
[0m10:06:57.749733 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:06:57.750004 [debug] [MainThread]: On master: Close
[0m10:06:57.750477 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:06:57.750842 [info ] [MainThread]: 
[0m10:06:57.757307 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:06:57.757808 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:06:57.758398 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:06:57.758747 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:06:57.763064 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:06:57.765386 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:06:57.758970 => 10:06:57.765201
[0m10:06:57.765715 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:06:57.786961 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:06:57.788203 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:06:57.788595 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:06:57.788897 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:06:57.791235 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:06:57.791747 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:06:57.792038 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:06:57.793560 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:06:57.797720 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:06:57.798044 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:06:57.798557 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:06:57.807319 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:06:57.807646 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:06:57.807900 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:06:57.808856 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:06:57.812623 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:06:57.815288 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:06:57.815605 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:06:57.816026 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:06:57.816928 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:06:57.765930 => 10:06:57.816792
[0m10:06:57.817210 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:06:57.817927 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m10:06:57.818460 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:06:57.819080 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:06:57.819534 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:06:57.820091 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:06:57.820394 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:06:57.822414 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:06:57.823526 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:06:57.820596 => 10:06:57.823369
[0m10:06:57.823809 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:06:57.837371 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:06:57.838550 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:06:57.838829 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:06:57.839077 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:06:57.841229 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:06:57.841650 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:06:57.841976 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:06:57.851399 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m10:06:57.853602 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:06:57.853923 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:06:57.854385 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:06:57.857545 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:06:57.857854 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:06:57.858114 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:06:57.859592 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:06:57.861361 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:06:57.862995 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:06:57.863289 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:06:57.863649 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:06:57.864528 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:06:57.823980 => 10:06:57.864393
[0m10:06:57.864812 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:06:57.865483 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.05s]
[0m10:06:57.865951 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:06:57.867040 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:57.867339 [debug] [MainThread]: On master: BEGIN
[0m10:06:57.867574 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:06:57.869931 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:06:57.870355 [debug] [MainThread]: On master: COMMIT
[0m10:06:57.870736 [debug] [MainThread]: Using postgres connection "master"
[0m10:06:57.870995 [debug] [MainThread]: On master: COMMIT
[0m10:06:57.871315 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:06:57.871629 [debug] [MainThread]: On master: Close
[0m10:06:57.872105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:06:57.872405 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:06:57.872669 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:06:57.872930 [info ] [MainThread]: 
[0m10:06:57.873183 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:06:57.873703 [debug] [MainThread]: Command end result
[0m10:06:57.879996 [info ] [MainThread]: 
[0m10:06:57.880345 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:06:57.880595 [info ] [MainThread]: 
[0m10:06:57.880869 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:06:57.881529 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42498735, "process_user_time": 1.595064, "process_kernel_time": 0.125689, "process_mem_max_rss": "122148", "process_in_blocks": "392", "process_out_blocks": "2431"}
[0m10:06:57.881901 [debug] [MainThread]: Command `dbt run` succeeded at 10:06:57.881820 after 0.43 seconds
[0m10:06:57.882163 [debug] [MainThread]: Flushing usage events


============================== 10:06:59.338943 | 87b1adf9-e888-4391-93f0-a63618d1145c ==============================
[0m10:06:59.338943 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:06:59.342912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m10:06:59.485909 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:06:59.491143 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:06:59.536738 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:06:59.537093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:06:59.548548 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:06:59.549425 [info ] [MainThread]: 
[0m10:06:59.549740 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:06:59.550090 [debug] [MainThread]: Command end result
[0m10:06:59.555143 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23997954, "process_user_time": 1.460538, "process_kernel_time": 0.069405, "process_mem_max_rss": "116964", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:06:59.555666 [debug] [MainThread]: Command `dbt test` succeeded at 10:06:59.555536 after 0.24 seconds
[0m10:06:59.556093 [debug] [MainThread]: Flushing usage events


============================== 10:07:02.515723 | 53858387-8ff5-445b-bc90-cfa2b66e7d9b ==============================
[0m10:07:02.515723 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:07:02.519678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m10:07:02.662967 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:07:02.668255 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:07:02.713783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:02.714119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:02.726462 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:07:02.727347 [info ] [MainThread]: 
[0m10:07:02.727843 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:02.728664 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:07:02.735067 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:07:02.735405 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:07:02.735742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:02.738776 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:07:02.739667 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:07:02.740762 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:07:02.744637 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:07:02.744916 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:07:02.745139 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:02.747049 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:07:02.747501 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:07:02.747809 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:07:02.749307 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:07:02.750131 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:07:02.750494 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:07:02.753648 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.754009 [debug] [MainThread]: On master: BEGIN
[0m10:07:02.754284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:02.756223 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:02.756555 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.756861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:02.760446 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:07:02.761723 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:02.762100 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.762337 [debug] [MainThread]: On master: BEGIN
[0m10:07:02.762728 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:02.763140 [debug] [MainThread]: On master: COMMIT
[0m10:07:02.763534 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.763794 [debug] [MainThread]: On master: COMMIT
[0m10:07:02.764104 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:02.764349 [debug] [MainThread]: On master: Close
[0m10:07:02.764857 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:02.765188 [info ] [MainThread]: 
[0m10:07:02.770530 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:07:02.770970 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:07:02.771476 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:07:02.771762 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:07:02.775954 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:07:02.776836 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:07:02.771929 => 10:07:02.776682
[0m10:07:02.777111 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:07:02.797706 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:07:02.798552 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:02.798874 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:07:02.799128 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:02.801407 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:07:02.801929 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:02.802285 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:07:02.803521 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:07:02.807569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:02.807886 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m10:07:02.808327 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:02.810284 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:02.810595 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:07:02.811307 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:02.820794 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:07:02.821115 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:02.821373 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:07:02.821922 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:07:02.825791 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:07:02.829082 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:02.829405 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:07:02.830388 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:07:02.831337 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:07:02.777283 => 10:07:02.831182
[0m10:07:02.831619 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:07:02.832259 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m10:07:02.832747 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:07:02.833344 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:07:02.833778 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:07:02.834409 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:07:02.834679 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:07:02.836731 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:07:02.837528 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:07:02.834844 => 10:07:02.837375
[0m10:07:02.837798 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:07:02.851265 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:07:02.852110 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:02.852427 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:07:02.852689 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:07:02.854800 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:07:02.855233 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:02.855564 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:07:02.862855 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m10:07:02.865104 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:02.865453 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m10:07:02.865972 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:02.867922 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:02.868230 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:07:02.868652 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:02.872034 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:07:02.872355 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:02.872646 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:07:02.873945 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:07:02.875666 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:07:02.877495 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:02.877776 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:07:02.879404 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:07:02.880370 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:07:02.837959 => 10:07:02.880215
[0m10:07:02.880656 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:07:02.881334 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.05s]
[0m10:07:02.881754 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:07:02.882753 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.883032 [debug] [MainThread]: On master: BEGIN
[0m10:07:02.883258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:02.885337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:02.885805 [debug] [MainThread]: On master: COMMIT
[0m10:07:02.886059 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:02.886295 [debug] [MainThread]: On master: COMMIT
[0m10:07:02.886601 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:02.886863 [debug] [MainThread]: On master: Close
[0m10:07:02.887305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:02.887576 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:07:02.887810 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:07:02.888089 [info ] [MainThread]: 
[0m10:07:02.888406 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m10:07:02.888963 [debug] [MainThread]: Command end result
[0m10:07:02.895071 [info ] [MainThread]: 
[0m10:07:02.895418 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:02.895725 [info ] [MainThread]: 
[0m10:07:02.895979 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:07:02.896561 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4044527, "process_user_time": 1.508875, "process_kernel_time": 0.086049, "process_mem_max_rss": "122356", "process_out_blocks": "1537", "process_in_blocks": "0"}
[0m10:07:02.896929 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:02.896844 after 0.40 seconds
[0m10:07:02.897196 [debug] [MainThread]: Flushing usage events


============================== 10:07:04.376195 | 7c81d75a-975f-4d83-8e45-ad07b4124c6d ==============================
[0m10:07:04.376195 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:07:04.380223 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m10:07:04.523407 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:07:04.528673 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:07:04.574912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:04.575301 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:04.587177 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:07:04.588093 [info ] [MainThread]: 
[0m10:07:04.588397 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:07:04.588762 [debug] [MainThread]: Command end result
[0m10:07:04.594028 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24248855, "process_user_time": 1.485347, "process_kernel_time": 0.069969, "process_mem_max_rss": "116972", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:07:04.594899 [debug] [MainThread]: Command `dbt test` succeeded at 10:07:04.594610 after 0.24 seconds
[0m10:07:04.595478 [debug] [MainThread]: Flushing usage events


============================== 10:07:36.623036 | cffddd31-9a54-4e29-b99d-54ba8c32a2d7 ==============================
[0m10:07:36.623036 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:07:36.626964 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m10:07:36.769676 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:07:36.774918 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:07:36.820762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:36.821091 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:36.833304 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:07:36.834169 [info ] [MainThread]: 
[0m10:07:36.834667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:07:36.835467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:07:36.841959 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:07:36.842278 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:07:36.842546 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:07:36.845544 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:07:36.846427 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:07:36.847581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:07:36.851152 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:07:36.851427 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:07:36.851653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:07:36.853503 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:07:36.854022 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:07:36.854288 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:07:36.855750 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:07:36.856534 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:07:36.856992 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:07:36.860329 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:36.860680 [debug] [MainThread]: On master: BEGIN
[0m10:07:36.860976 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:07:36.862921 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:36.863297 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:36.863617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:07:36.867465 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:07:36.868991 [debug] [MainThread]: On master: ROLLBACK
[0m10:07:36.869447 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:36.869708 [debug] [MainThread]: On master: BEGIN
[0m10:07:36.870096 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:36.870450 [debug] [MainThread]: On master: COMMIT
[0m10:07:36.870711 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:36.870985 [debug] [MainThread]: On master: COMMIT
[0m10:07:36.871358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:36.871616 [debug] [MainThread]: On master: Close
[0m10:07:36.872108 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:07:36.872399 [info ] [MainThread]: 
[0m10:07:36.876943 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:07:36.877359 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:07:36.877849 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:07:36.878136 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:07:36.882198 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:07:36.883112 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:07:36.878304 => 10:07:36.882960
[0m10:07:36.883390 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:07:36.904638 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:07:36.905630 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:36.905978 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:07:36.906269 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:07:36.908398 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:07:36.908825 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:36.909149 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:07:36.910366 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:07:36.914313 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:36.914632 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m10:07:36.915131 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:36.917065 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:36.917421 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:07:36.918071 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:36.927474 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:07:36.927789 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:36.928046 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:07:36.928987 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:07:36.932697 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:07:36.935893 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:07:36.936207 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:07:36.937066 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:07:36.937954 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:07:36.883563 => 10:07:36.937822
[0m10:07:36.938236 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:07:36.938913 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m10:07:36.939379 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:07:36.940259 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:07:36.940842 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:07:36.941492 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:07:36.941830 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:07:36.944453 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:07:36.945589 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:07:36.942057 => 10:07:36.945404
[0m10:07:36.946030 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:07:36.960817 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:07:36.962303 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:36.962653 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:07:36.963032 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:07:36.967305 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:07:36.968979 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:36.970077 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:07:36.981798 [debug] [Thread-3  ]: SQL status: SELECT 3000 in 0.0 seconds
[0m10:07:36.984205 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:36.984539 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m10:07:36.985099 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:36.986987 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:36.987308 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:07:36.987783 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:07:36.991228 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:07:36.991566 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:36.991854 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:07:36.993598 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:07:36.995312 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:07:36.997039 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:07:36.997345 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:07:36.998623 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:07:36.999622 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:07:36.946261 => 10:07:36.999487
[0m10:07:36.999924 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:07:37.000594 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 3000[0m in 0.06s]
[0m10:07:37.001041 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:07:37.002323 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:37.002624 [debug] [MainThread]: On master: BEGIN
[0m10:07:37.002865 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:07:37.005176 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:07:37.005559 [debug] [MainThread]: On master: COMMIT
[0m10:07:37.005818 [debug] [MainThread]: Using postgres connection "master"
[0m10:07:37.006078 [debug] [MainThread]: On master: COMMIT
[0m10:07:37.006390 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:07:37.006624 [debug] [MainThread]: On master: Close
[0m10:07:37.007062 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:07:37.007334 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:07:37.007577 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:07:37.007876 [info ] [MainThread]: 
[0m10:07:37.008143 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m10:07:37.008662 [debug] [MainThread]: Command end result
[0m10:07:37.016152 [info ] [MainThread]: 
[0m10:07:37.016469 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:07:37.016723 [info ] [MainThread]: 
[0m10:07:37.017027 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:07:37.017604 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.41844696, "process_user_time": 1.546957, "process_kernel_time": 0.077897, "process_mem_max_rss": "122544", "process_out_blocks": "1537", "process_in_blocks": "0"}
[0m10:07:37.018011 [debug] [MainThread]: Command `dbt run` succeeded at 10:07:37.017904 after 0.42 seconds
[0m10:07:37.018301 [debug] [MainThread]: Flushing usage events


============================== 10:07:38.477533 | 520b7274-9a52-4fa3-8ba5-37033948600f ==============================
[0m10:07:38.477533 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:07:38.482048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m10:07:38.714086 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:07:38.721223 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:07:38.773269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:07:38.773612 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:07:38.785754 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:07:38.786677 [info ] [MainThread]: 
[0m10:07:38.787000 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:07:38.787355 [debug] [MainThread]: Command end result
[0m10:07:38.792528 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.33904853, "process_user_time": 1.499243, "process_kernel_time": 0.098128, "process_mem_max_rss": "116952", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:07:38.793010 [debug] [MainThread]: Command `dbt test` succeeded at 10:07:38.792914 after 0.34 seconds
[0m10:07:38.793443 [debug] [MainThread]: Flushing usage events


============================== 10:14:48.094073 | 91cc96f2-4b4a-44e7-86d3-49612215ba62 ==============================
[0m10:14:48.094073 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:14:48.099466 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m10:14:48.276933 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:14:48.284305 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:14:48.353646 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:48.354222 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:48.371753 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:14:48.373184 [info ] [MainThread]: 
[0m10:14:48.373911 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:48.375216 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:14:48.384435 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:14:48.384943 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:14:48.385436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:48.392006 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:14:48.393268 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:14:48.395323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:14:48.400244 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:14:48.400731 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:14:48.401164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:48.407148 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:14:48.407717 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:14:48.408120 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:14:48.411441 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:14:48.412470 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:14:48.412975 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:14:48.416749 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:48.417364 [debug] [MainThread]: On master: BEGIN
[0m10:14:48.417754 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:48.421337 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:14:48.421821 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:48.422262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:48.428211 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:14:48.429312 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:48.429763 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:48.430050 [debug] [MainThread]: On master: BEGIN
[0m10:14:48.430607 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:14:48.431129 [debug] [MainThread]: On master: COMMIT
[0m10:14:48.431496 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:48.431870 [debug] [MainThread]: On master: COMMIT
[0m10:14:48.432329 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:14:48.432630 [debug] [MainThread]: On master: Close
[0m10:14:48.433220 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:48.433608 [info ] [MainThread]: 
[0m10:14:48.441026 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:14:48.441584 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:14:48.442231 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:14:48.442569 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:14:48.448244 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:14:48.449721 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:14:48.442792 => 10:14:48.449465
[0m10:14:48.450139 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:14:48.472882 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:14:48.473728 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:48.474021 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:14:48.474274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:48.477872 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:48.478394 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:48.478788 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:14:48.481189 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:14:48.485952 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:48.486436 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:14:48.487271 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:48.496020 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:14:48.496414 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:48.496688 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:14:48.498061 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:48.502797 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:14:48.506164 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:48.506638 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:14:48.507429 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:14:48.508673 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:14:48.450340 => 10:14:48.508513
[0m10:14:48.509022 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:14:48.509845 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.07s]
[0m10:14:48.510417 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:14:48.511039 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:14:48.511706 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:14:48.512503 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:14:48.512861 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:14:48.515082 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:14:48.516237 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:14:48.513079 => 10:14:48.515963
[0m10:14:48.516638 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:14:48.531312 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:14:48.532105 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:48.532600 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:14:48.533074 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:14:48.535917 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:48.536427 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:48.536832 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:14:48.549663 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m10:14:48.552312 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:48.552729 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:14:48.553355 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:48.557115 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:14:48.557550 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:48.557840 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:14:48.559595 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:48.561708 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:14:48.563836 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:48.564320 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:14:48.564918 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:48.566019 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:14:48.516874 => 10:14:48.565865
[0m10:14:48.566377 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:14:48.567217 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.05s]
[0m10:14:48.567718 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:14:48.568841 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:48.569184 [debug] [MainThread]: On master: BEGIN
[0m10:14:48.569530 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:14:48.572138 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:14:48.572606 [debug] [MainThread]: On master: COMMIT
[0m10:14:48.573000 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:48.573348 [debug] [MainThread]: On master: COMMIT
[0m10:14:48.573802 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:14:48.574106 [debug] [MainThread]: On master: Close
[0m10:14:48.574627 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:48.574917 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:14:48.575201 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:14:48.575507 [info ] [MainThread]: 
[0m10:14:48.575837 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.20 seconds (0.20s).
[0m10:14:48.576483 [debug] [MainThread]: Command end result
[0m10:14:48.583558 [info ] [MainThread]: 
[0m10:14:48.584022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:48.584320 [info ] [MainThread]: 
[0m10:14:48.584604 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:14:48.585373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.518559, "process_user_time": 1.656143, "process_kernel_time": 0.156486, "process_mem_max_rss": "121880", "process_in_blocks": "1656", "process_out_blocks": "2431"}
[0m10:14:48.585845 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:48.585727 after 0.52 seconds
[0m10:14:48.586149 [debug] [MainThread]: Flushing usage events


============================== 10:14:50.049813 | e368155c-dc64-412e-b8e6-cad26fbc811f ==============================
[0m10:14:50.049813 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:14:50.053876 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m10:14:50.200075 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:14:50.205424 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:14:50.254753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:50.255134 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:50.267129 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:14:50.268031 [info ] [MainThread]: 
[0m10:14:50.268317 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:14:50.268702 [debug] [MainThread]: Command end result
[0m10:14:50.274479 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24904595, "process_user_time": 1.441812, "process_kernel_time": 0.077774, "process_mem_max_rss": "116972", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:14:50.275149 [debug] [MainThread]: Command `dbt test` succeeded at 10:14:50.274951 after 0.25 seconds
[0m10:14:50.275503 [debug] [MainThread]: Flushing usage events


============================== 10:14:53.360027 | af7b2e6a-a731-4fb1-a5c8-7f4a98d52863 ==============================
[0m10:14:53.360027 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:14:53.363945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m10:14:53.508327 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:14:53.513581 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:14:53.558988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:53.559330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:53.571151 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:14:53.572096 [info ] [MainThread]: 
[0m10:14:53.572653 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:14:53.573526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:14:53.580010 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:14:53.580360 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:14:53.580636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:14:53.583588 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:14:53.584490 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:14:53.585610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:14:53.589212 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:14:53.589497 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:14:53.589726 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:14:53.591687 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:14:53.592113 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:14:53.592393 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:14:53.593963 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:14:53.594744 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:14:53.595103 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:14:53.598284 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:53.598625 [debug] [MainThread]: On master: BEGIN
[0m10:14:53.598910 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:14:53.600892 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:14:53.601308 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:53.601622 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:14:53.605257 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:14:53.606634 [debug] [MainThread]: On master: ROLLBACK
[0m10:14:53.607029 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:53.607273 [debug] [MainThread]: On master: BEGIN
[0m10:14:53.607673 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:14:53.608038 [debug] [MainThread]: On master: COMMIT
[0m10:14:53.608286 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:53.608509 [debug] [MainThread]: On master: COMMIT
[0m10:14:53.608838 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:14:53.609104 [debug] [MainThread]: On master: Close
[0m10:14:53.609558 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:14:53.609841 [info ] [MainThread]: 
[0m10:14:53.614823 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:14:53.615345 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:14:53.615931 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:14:53.616288 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:14:53.623562 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:14:53.625103 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:14:53.616528 => 10:14:53.624916
[0m10:14:53.625440 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:14:53.655903 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:14:53.659007 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:53.659644 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:14:53.660082 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:14:53.665105 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:53.666272 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:53.668359 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:14:53.671024 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:14:53.681081 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:53.681581 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m10:14:53.682642 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:53.686624 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:53.687542 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:14:53.688926 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:53.709568 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:14:53.710976 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:53.712265 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:14:53.715580 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:53.726277 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:14:53.735838 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:14:53.737501 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:14:53.742483 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:14:53.745903 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:14:53.625702 => 10:14:53.745714
[0m10:14:53.747121 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:14:53.748868 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.13s]
[0m10:14:53.750378 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:14:53.753296 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:14:53.754652 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:14:53.756749 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:14:53.759736 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:14:53.765490 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:14:53.772688 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:14:53.761748 => 10:14:53.772355
[0m10:14:53.774526 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:14:53.828312 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:14:53.829608 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:53.830123 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:14:53.830607 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:14:53.835386 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:14:53.836178 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:53.836568 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:14:53.846993 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m10:14:53.850068 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:53.850590 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m10:14:53.851454 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:53.853701 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:53.854063 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:14:53.854653 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:14:53.858170 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:14:53.858515 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:53.858948 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:14:53.860753 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:14:53.862905 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:14:53.864759 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:14:53.865188 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:14:53.867940 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:14:53.869344 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:14:53.776757 => 10:14:53.869114
[0m10:14:53.869764 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:14:53.870633 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.11s]
[0m10:14:53.871511 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:14:53.872977 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:53.873449 [debug] [MainThread]: On master: BEGIN
[0m10:14:53.873847 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:14:53.877155 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:14:53.877690 [debug] [MainThread]: On master: COMMIT
[0m10:14:53.878098 [debug] [MainThread]: Using postgres connection "master"
[0m10:14:53.878367 [debug] [MainThread]: On master: COMMIT
[0m10:14:53.878763 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:14:53.879185 [debug] [MainThread]: On master: Close
[0m10:14:53.879820 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:14:53.880147 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:14:53.880461 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:14:53.880802 [info ] [MainThread]: 
[0m10:14:53.881076 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m10:14:53.881671 [debug] [MainThread]: Command end result
[0m10:14:53.888701 [info ] [MainThread]: 
[0m10:14:53.889149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:14:53.889555 [info ] [MainThread]: 
[0m10:14:53.889969 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:14:53.890660 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.55445963, "process_user_time": 1.606683, "process_kernel_time": 0.08926, "process_mem_max_rss": "122548", "process_out_blocks": "1537", "process_in_blocks": "0"}
[0m10:14:53.891105 [debug] [MainThread]: Command `dbt run` succeeded at 10:14:53.891011 after 0.55 seconds
[0m10:14:53.891439 [debug] [MainThread]: Flushing usage events


============================== 10:14:55.304088 | 75f46d0a-8163-428c-9582-896ed4c4fa2a ==============================
[0m10:14:55.304088 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:14:55.307954 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m10:14:55.451209 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:14:55.456469 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:14:55.502262 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:14:55.502667 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:14:55.514651 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:14:55.515495 [info ] [MainThread]: 
[0m10:14:55.515812 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:14:55.516221 [debug] [MainThread]: Command end result
[0m10:14:55.521047 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24062638, "process_user_time": 1.402321, "process_kernel_time": 0.066919, "process_mem_max_rss": "116972", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:14:55.521443 [debug] [MainThread]: Command `dbt test` succeeded at 10:14:55.521357 after 0.24 seconds
[0m10:14:55.521716 [debug] [MainThread]: Flushing usage events


============================== 10:24:52.404324 | e227152e-5cc0-40ec-8836-76778de73cae ==============================
[0m10:24:52.404324 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:24:52.410468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m10:24:52.593470 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:24:52.600506 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:24:52.668587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:52.669118 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:52.689471 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:24:52.690919 [info ] [MainThread]: 
[0m10:24:52.691556 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:52.692637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:24:52.700045 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:24:52.700579 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:24:52.700988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:52.707657 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:24:52.709339 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:24:52.711570 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:24:52.716461 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:24:52.717075 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:24:52.717403 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:52.721089 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:24:52.721700 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:24:52.722112 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:24:52.725304 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m10:24:52.726418 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:24:52.726841 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:24:52.730071 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:52.730520 [debug] [MainThread]: On master: BEGIN
[0m10:24:52.731018 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:52.733872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:24:52.734313 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:52.734828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:52.739746 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m10:24:52.740843 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:52.741360 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:52.741658 [debug] [MainThread]: On master: BEGIN
[0m10:24:52.742139 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:24:52.742597 [debug] [MainThread]: On master: COMMIT
[0m10:24:52.743028 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:52.743395 [debug] [MainThread]: On master: COMMIT
[0m10:24:52.743800 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:24:52.744090 [debug] [MainThread]: On master: Close
[0m10:24:52.744627 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:52.744969 [info ] [MainThread]: 
[0m10:24:52.752245 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:24:52.752858 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:24:52.753573 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:24:52.754043 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:24:52.758755 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:24:52.761099 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:24:52.754320 => 10:24:52.760856
[0m10:24:52.761469 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:24:52.784898 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:24:52.786004 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:52.786323 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:24:52.786717 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:24:52.789648 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:24:52.790189 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:52.790661 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:24:52.792692 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:24:52.797151 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:52.797730 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:24:52.799172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:24:52.809063 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:24:52.809725 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:52.810205 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:24:52.811566 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:24:52.815629 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:24:52.819459 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:52.819967 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:24:52.820612 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:24:52.821994 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:24:52.761698 => 10:24:52.821789
[0m10:24:52.822469 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:24:52.823339 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.07s]
[0m10:24:52.823915 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:24:52.824608 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:24:52.825173 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:24:52.825783 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:24:52.826107 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:24:52.828244 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:24:52.829531 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:24:52.826306 => 10:24:52.829270
[0m10:24:52.829943 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:24:52.847589 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:24:52.848731 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:52.849172 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:24:52.849597 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:24:52.857025 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:24:52.858255 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:52.858851 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:24:52.876728 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m10:24:52.883773 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:52.884582 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:24:52.885929 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:24:52.893197 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:24:52.894435 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:52.895667 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:24:52.897475 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:24:52.900511 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:24:52.905227 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:52.905928 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:24:52.906976 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:24:52.909679 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:24:52.830164 => 10:24:52.909243
[0m10:24:52.910706 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:24:52.911955 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.09s]
[0m10:24:52.912702 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:24:52.914143 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:52.914501 [debug] [MainThread]: On master: BEGIN
[0m10:24:52.914811 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:52.918713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:24:52.919394 [debug] [MainThread]: On master: COMMIT
[0m10:24:52.919695 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:52.920060 [debug] [MainThread]: On master: COMMIT
[0m10:24:52.920658 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:24:52.921208 [debug] [MainThread]: On master: Close
[0m10:24:52.921987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:52.922371 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:24:52.922730 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:24:52.923189 [info ] [MainThread]: 
[0m10:24:52.923682 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m10:24:52.924642 [debug] [MainThread]: Command end result
[0m10:24:52.931995 [info ] [MainThread]: 
[0m10:24:52.932457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:52.932774 [info ] [MainThread]: 
[0m10:24:52.933121 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:24:52.933809 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5645075, "process_user_time": 1.872446, "process_kernel_time": 0.20194, "process_mem_max_rss": "121888", "process_in_blocks": "232", "process_out_blocks": "2431"}
[0m10:24:52.934246 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:52.934151 after 0.57 seconds
[0m10:24:52.934562 [debug] [MainThread]: Flushing usage events


============================== 10:24:54.483276 | 6c0e472d-f9e5-47de-8485-fc4353c41722 ==============================
[0m10:24:54.483276 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:24:54.487414 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m10:24:54.637865 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:24:54.643542 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:24:54.689325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:54.689660 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:54.701099 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:24:54.701945 [info ] [MainThread]: 
[0m10:24:54.702231 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:24:54.702605 [debug] [MainThread]: Command end result
[0m10:24:54.707343 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24886091, "process_user_time": 1.483765, "process_kernel_time": 0.090985, "process_mem_max_rss": "116996", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:24:54.707772 [debug] [MainThread]: Command `dbt test` succeeded at 10:24:54.707662 after 0.25 seconds
[0m10:24:54.708107 [debug] [MainThread]: Flushing usage events


============================== 10:24:57.727795 | 0f86a875-e4cd-4c25-bbed-ca12221fee09 ==============================
[0m10:24:57.727795 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:24:57.731770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m10:24:57.874607 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:24:57.880137 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:24:57.923989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:57.924320 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:57.937779 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:24:57.938654 [info ] [MainThread]: 
[0m10:24:57.939149 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m10:24:57.939933 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m10:24:57.946494 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m10:24:57.946818 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m10:24:57.947071 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:57.950061 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m10:24:57.950954 [debug] [ThreadPool]: On list_hginsight: Close
[0m10:24:57.952058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m10:24:57.955670 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:24:57.955973 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m10:24:57.956245 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:24:57.958441 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m10:24:57.958882 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m10:24:57.959216 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m10:24:57.960856 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m10:24:57.961674 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m10:24:57.962046 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m10:24:57.965172 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:57.965514 [debug] [MainThread]: On master: BEGIN
[0m10:24:57.965814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:24:57.967905 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:24:57.968289 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:57.968609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m10:24:57.972258 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m10:24:57.973511 [debug] [MainThread]: On master: ROLLBACK
[0m10:24:57.973947 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:57.974211 [debug] [MainThread]: On master: BEGIN
[0m10:24:57.974616 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:24:57.974968 [debug] [MainThread]: On master: COMMIT
[0m10:24:57.975243 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:57.975517 [debug] [MainThread]: On master: COMMIT
[0m10:24:57.976314 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:24:57.976740 [debug] [MainThread]: On master: Close
[0m10:24:57.977280 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:24:57.977607 [info ] [MainThread]: 
[0m10:24:57.983739 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m10:24:57.984350 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m10:24:57.985183 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m10:24:57.985565 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m10:24:57.990649 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m10:24:57.992108 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 10:24:57.985823 => 10:24:57.991764
[0m10:24:57.992647 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m10:24:58.026805 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m10:24:58.028336 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:58.029095 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m10:24:58.029560 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m10:24:58.034564 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m10:24:58.035348 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:58.036076 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m10:24:58.038517 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m10:24:58.044305 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:58.045009 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m10:24:58.046507 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:24:58.049800 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:58.050575 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m10:24:58.052738 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:24:58.065014 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:24:58.065661 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:58.066416 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m10:24:58.069244 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m10:24:58.078152 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m10:24:58.082656 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m10:24:58.083299 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m10:24:58.085087 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m10:24:58.086513 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 10:24:57.993079 => 10:24:58.086285
[0m10:24:58.086946 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m10:24:58.087855 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.10s]
[0m10:24:58.088456 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m10:24:58.089315 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m10:24:58.090111 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m10:24:58.090707 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m10:24:58.091006 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m10:24:58.093649 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m10:24:58.094740 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 10:24:58.091202 => 10:24:58.094517
[0m10:24:58.095078 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m10:24:58.112819 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m10:24:58.114420 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:58.114899 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m10:24:58.115295 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m10:24:58.118273 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m10:24:58.118871 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:58.119430 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m10:24:58.129492 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m10:24:58.132426 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:58.132877 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m10:24:58.133681 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:24:58.136186 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:58.136674 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m10:24:58.137391 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m10:24:58.142081 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:24:58.142586 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:58.143051 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m10:24:58.144650 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m10:24:58.147995 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m10:24:58.150086 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m10:24:58.150521 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m10:24:58.153080 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m10:24:58.154230 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 10:24:58.095258 => 10:24:58.154074
[0m10:24:58.154544 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m10:24:58.155278 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.06s]
[0m10:24:58.155748 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m10:24:58.156947 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:58.157231 [debug] [MainThread]: On master: BEGIN
[0m10:24:58.157460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:24:58.159671 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m10:24:58.160075 [debug] [MainThread]: On master: COMMIT
[0m10:24:58.160356 [debug] [MainThread]: Using postgres connection "master"
[0m10:24:58.160575 [debug] [MainThread]: On master: COMMIT
[0m10:24:58.160845 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m10:24:58.161081 [debug] [MainThread]: On master: Close
[0m10:24:58.161524 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:58.161775 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m10:24:58.162007 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m10:24:58.162261 [info ] [MainThread]: 
[0m10:24:58.162516 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m10:24:58.163113 [debug] [MainThread]: Command end result
[0m10:24:58.169614 [info ] [MainThread]: 
[0m10:24:58.169989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:58.170265 [info ] [MainThread]: 
[0m10:24:58.170532 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m10:24:58.171147 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.4677687, "process_user_time": 1.550668, "process_kernel_time": 0.096729, "process_mem_max_rss": "122528", "process_out_blocks": "1537", "process_in_blocks": "0"}
[0m10:24:58.171548 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:58.171462 after 0.47 seconds
[0m10:24:58.171839 [debug] [MainThread]: Flushing usage events


============================== 10:24:59.585321 | 7df3c87d-be99-494e-968f-7d39974ae56f ==============================
[0m10:24:59.585321 [info ] [MainThread]: Running with dbt=1.7.0
[0m10:24:59.589290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m10:24:59.736654 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m10:24:59.742109 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m10:24:59.788904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:59.789253 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:59.800858 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m10:24:59.801715 [info ] [MainThread]: 
[0m10:24:59.802018 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:24:59.802394 [debug] [MainThread]: Command end result
[0m10:24:59.807298 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24628617, "process_user_time": 1.420709, "process_kernel_time": 0.061943, "process_mem_max_rss": "116968", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m10:24:59.807685 [debug] [MainThread]: Command `dbt test` succeeded at 10:24:59.807600 after 0.25 seconds
[0m10:24:59.807958 [debug] [MainThread]: Flushing usage events


============================== 11:09:34.782737 | b53f9ed9-d767-46ea-8bdd-1c8ebcdf2f2c ==============================
[0m11:09:34.782737 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:09:34.789529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m11:09:34.956791 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:09:34.963370 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:09:35.013612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:35.013973 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:35.026281 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:09:35.027166 [info ] [MainThread]: 
[0m11:09:35.027692 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:35.028523 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:09:35.034633 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:09:35.034932 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:09:35.035198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:35.039607 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:09:35.040473 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:09:35.041858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:09:35.045634 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:09:35.045946 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:09:35.046207 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:35.048202 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:09:35.048806 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:09:35.049260 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:09:35.051902 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:09:35.052737 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:09:35.053156 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:09:35.056231 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:35.056572 [debug] [MainThread]: On master: BEGIN
[0m11:09:35.056806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:35.059396 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:35.059766 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:35.060106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:35.062774 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:09:35.063547 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:35.063925 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:35.064169 [debug] [MainThread]: On master: BEGIN
[0m11:09:35.064560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:35.064916 [debug] [MainThread]: On master: COMMIT
[0m11:09:35.065197 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:35.065445 [debug] [MainThread]: On master: COMMIT
[0m11:09:35.065762 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:09:35.066011 [debug] [MainThread]: On master: Close
[0m11:09:35.066469 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:35.066742 [info ] [MainThread]: 
[0m11:09:35.072482 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:09:35.072985 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:09:35.073483 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:09:35.073812 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:09:35.077958 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:09:35.080406 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:09:35.074045 => 11:09:35.080254
[0m11:09:35.080689 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:09:35.101162 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:09:35.102009 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:09:35.102287 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:09:35.102539 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:35.104870 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:35.105263 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:09:35.105550 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:09:35.106120 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:09:35.106506 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:09:35.106947 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:09:35.080869 => 11:09:35.106790
[0m11:09:35.107214 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:09:35.108769 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:09:35.109277 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m11:09:35.109741 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:09:35.110321 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:09:35.110810 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:09:35.111160 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:09:35.112091 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:35.112392 [debug] [MainThread]: On master: BEGIN
[0m11:09:35.112622 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:35.114941 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:35.115442 [debug] [MainThread]: On master: COMMIT
[0m11:09:35.115727 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:35.115998 [debug] [MainThread]: On master: COMMIT
[0m11:09:35.116353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:09:35.116600 [debug] [MainThread]: On master: Close
[0m11:09:35.117055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:35.117295 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:09:35.117556 [info ] [MainThread]: 
[0m11:09:35.117832 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:09:35.118308 [debug] [MainThread]: Command end result
[0m11:09:35.123769 [info ] [MainThread]: 
[0m11:09:35.124127 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:35.124440 [info ] [MainThread]: 
[0m11:09:35.124705 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:09:35.124965 [info ] [MainThread]: 
[0m11:09:35.125219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:09:35.125781 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36726826, "process_user_time": 1.551788, "process_kernel_time": 0.148266, "process_mem_max_rss": "121076", "process_out_blocks": "2414", "command_success": false, "process_in_blocks": "0"}
[0m11:09:35.126163 [debug] [MainThread]: Command `dbt run` failed at 11:09:35.126081 after 0.37 seconds
[0m11:09:35.126425 [debug] [MainThread]: Flushing usage events


============================== 11:09:36.615643 | 991b49b7-058b-4675-ba1a-e83d0d9094bc ==============================
[0m11:09:36.615643 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:09:36.619609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:09:36.762619 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:09:36.767830 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:09:36.813360 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:36.813689 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:36.825281 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:09:36.826103 [info ] [MainThread]: 
[0m11:09:36.826382 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:09:36.826719 [debug] [MainThread]: Command end result
[0m11:09:36.831558 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2399082, "process_user_time": 1.479536, "process_kernel_time": 0.082974, "process_mem_max_rss": "116988", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:09:36.831970 [debug] [MainThread]: Command `dbt test` succeeded at 11:09:36.831881 after 0.24 seconds
[0m11:09:36.832231 [debug] [MainThread]: Flushing usage events


============================== 11:09:40.148995 | 557c85d7-d996-4e83-ac34-25a502023d5e ==============================
[0m11:09:40.148995 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:09:40.153394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:09:40.311184 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:09:40.316723 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:09:40.364168 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:40.364565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:40.376174 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:09:40.377041 [info ] [MainThread]: 
[0m11:09:40.377532 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:09:40.378356 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:09:40.384803 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:09:40.385148 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:09:40.385414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:09:40.388557 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:09:40.389435 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:09:40.390568 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:09:40.394269 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:09:40.394572 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:09:40.394819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:09:40.396917 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:09:40.397328 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:09:40.397786 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:09:40.399418 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:09:40.400255 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:09:40.400625 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:09:40.403679 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:40.404047 [debug] [MainThread]: On master: BEGIN
[0m11:09:40.404356 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:09:40.407054 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:40.407523 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:40.407872 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:09:40.409670 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:09:40.410498 [debug] [MainThread]: On master: ROLLBACK
[0m11:09:40.410862 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:40.411247 [debug] [MainThread]: On master: BEGIN
[0m11:09:40.411976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:40.412414 [debug] [MainThread]: On master: COMMIT
[0m11:09:40.412787 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:40.413097 [debug] [MainThread]: On master: COMMIT
[0m11:09:40.413567 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:09:40.413898 [debug] [MainThread]: On master: Close
[0m11:09:40.414546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:09:40.414971 [info ] [MainThread]: 
[0m11:09:40.420229 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:09:40.420684 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:09:40.421320 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:09:40.421716 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:09:40.426035 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:09:40.426900 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:09:40.421938 => 11:09:40.426729
[0m11:09:40.427202 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:09:40.448351 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:09:40.449205 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:09:40.449522 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:09:40.449800 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:09:40.452167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:09:40.452569 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:09:40.452897 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:09:40.453449 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:09:40.453960 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:09:40.454413 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:09:40.427389 => 11:09:40.454271
[0m11:09:40.454714 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:09:40.456132 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:09:40.456970 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m11:09:40.457551 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:09:40.458549 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:09:40.458919 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:09:40.459359 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:09:40.460984 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:40.461716 [debug] [MainThread]: On master: BEGIN
[0m11:09:40.462416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:09:40.465066 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:09:40.465504 [debug] [MainThread]: On master: COMMIT
[0m11:09:40.465759 [debug] [MainThread]: Using postgres connection "master"
[0m11:09:40.466010 [debug] [MainThread]: On master: COMMIT
[0m11:09:40.466348 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:09:40.466593 [debug] [MainThread]: On master: Close
[0m11:09:40.467085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:09:40.467335 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:09:40.467611 [info ] [MainThread]: 
[0m11:09:40.467923 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:09:40.468392 [debug] [MainThread]: Command end result
[0m11:09:40.473774 [info ] [MainThread]: 
[0m11:09:40.474135 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:09:40.474407 [info ] [MainThread]: 
[0m11:09:40.474651 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:09:40.474900 [info ] [MainThread]: 
[0m11:09:40.475152 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:09:40.475738 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35223457, "process_user_time": 1.556595, "process_kernel_time": 0.07212, "process_mem_max_rss": "121400", "process_out_blocks": "1518", "command_success": false, "process_in_blocks": "0"}
[0m11:09:40.476128 [debug] [MainThread]: Command `dbt run` failed at 11:09:40.476041 after 0.35 seconds
[0m11:09:40.476409 [debug] [MainThread]: Flushing usage events


============================== 11:09:41.950160 | 0fdb6ac8-1ede-4523-839a-9a944e4cf3a6 ==============================
[0m11:09:41.950160 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:09:41.954162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m11:09:42.096437 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:09:42.101684 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:09:42.147773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:09:42.148165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:09:42.160409 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:09:42.161348 [info ] [MainThread]: 
[0m11:09:42.161669 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:09:42.162089 [debug] [MainThread]: Command end result
[0m11:09:42.167177 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24067779, "process_user_time": 1.465589, "process_kernel_time": 0.073878, "process_mem_max_rss": "116976", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:09:42.167600 [debug] [MainThread]: Command `dbt test` succeeded at 11:09:42.167510 after 0.24 seconds
[0m11:09:42.167882 [debug] [MainThread]: Flushing usage events


============================== 11:11:22.908321 | cfce0199-350f-4ac7-ae33-4fa268c4c7e0 ==============================
[0m11:11:22.908321 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:11:22.914314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:11:23.067022 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:11:23.074515 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:11:23.124984 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:11:23.125345 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:11:23.137958 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:11:23.139003 [info ] [MainThread]: 
[0m11:11:23.139890 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:11:23.140904 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:11:23.147642 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:11:23.148013 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:11:23.148373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:11:23.152329 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:11:23.153382 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:11:23.154742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:11:23.158736 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:11:23.159020 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:11:23.159233 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:11:23.161415 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:11:23.161811 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:11:23.162133 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:11:23.163796 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:11:23.164561 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:11:23.164900 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:11:23.167863 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.168235 [debug] [MainThread]: On master: BEGIN
[0m11:11:23.168558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:11:23.170630 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:11:23.170982 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.171283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:11:23.172885 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:11:23.173680 [debug] [MainThread]: On master: ROLLBACK
[0m11:11:23.174020 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.174254 [debug] [MainThread]: On master: BEGIN
[0m11:11:23.174667 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:11:23.175103 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.175480 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.175741 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.176055 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:11:23.176310 [debug] [MainThread]: On master: Close
[0m11:11:23.176788 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:11:23.177074 [info ] [MainThread]: 
[0m11:11:23.183335 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:11:23.183959 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:11:23.184531 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:11:23.184880 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:11:23.189176 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:11:23.192044 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:11:23.185077 => 11:11:23.191853
[0m11:11:23.192376 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:11:23.214601 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:11:23.215631 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:11:23.215916 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:11:23.216160 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:11:23.218953 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:11:23.219370 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:11:23.219672 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:11:23.220238 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:11:23.220691 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:11:23.221099 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:11:23.192598 => 11:11:23.220965
[0m11:11:23.221364 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:11:23.222883 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:11:23.223395 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m11:11:23.223916 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:11:23.224778 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:11:23.225252 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:11:23.225640 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:11:23.226797 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.227223 [debug] [MainThread]: On master: BEGIN
[0m11:11:23.227750 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:11:23.230811 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:11:23.231263 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.231515 [debug] [MainThread]: Using postgres connection "master"
[0m11:11:23.231738 [debug] [MainThread]: On master: COMMIT
[0m11:11:23.232070 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:11:23.232311 [debug] [MainThread]: On master: Close
[0m11:11:23.232784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:11:23.233104 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:11:23.233550 [info ] [MainThread]: 
[0m11:11:23.233977 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:11:23.234773 [debug] [MainThread]: Command end result
[0m11:11:23.241048 [info ] [MainThread]: 
[0m11:11:23.241521 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:11:23.241946 [info ] [MainThread]: 
[0m11:11:23.242397 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:11:23.242827 [info ] [MainThread]: 
[0m11:11:23.243340 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:11:23.244064 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.36043835, "process_user_time": 1.496334, "process_kernel_time": 0.121027, "process_mem_max_rss": "121304", "process_out_blocks": "1518", "command_success": false, "process_in_blocks": "0"}
[0m11:11:23.244505 [debug] [MainThread]: Command `dbt run` failed at 11:11:23.244414 after 0.36 seconds
[0m11:11:23.244771 [debug] [MainThread]: Flushing usage events


============================== 11:17:16.057067 | 26834c54-8d30-450c-929d-09fec5abacf9 ==============================
[0m11:17:16.057067 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:17:16.062315 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m11:17:16.213353 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:17:16.218998 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:17:16.266149 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:16.266487 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:16.278575 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:17:16.279436 [info ] [MainThread]: 
[0m11:17:16.279952 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:17:16.280743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:17:16.287213 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:17:16.287521 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:17:16.287778 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:16.290576 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:17:16.291403 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:17:16.292452 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight_reporting_schema'
[0m11:17:16.296503 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:17:16.296807 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:17:16.297165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:17:16.299203 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:17:16.299740 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:17:16.300142 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:17:16.301805 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:17:16.302630 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:17:16.302995 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:17:16.306154 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:16.306507 [debug] [MainThread]: On master: BEGIN
[0m11:17:16.306764 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:17:16.308914 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:17:16.309335 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:16.309641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:17:16.313427 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:17:16.314232 [debug] [MainThread]: On master: ROLLBACK
[0m11:17:16.314578 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:16.314841 [debug] [MainThread]: On master: BEGIN
[0m11:17:16.315227 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:17:16.315588 [debug] [MainThread]: On master: COMMIT
[0m11:17:16.315867 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:16.316116 [debug] [MainThread]: On master: COMMIT
[0m11:17:16.316416 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:17:16.316668 [debug] [MainThread]: On master: Close
[0m11:17:16.317136 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:17:16.317412 [info ] [MainThread]: 
[0m11:17:16.323258 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:17:16.323748 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:17:16.324253 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:17:16.324562 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:17:16.328793 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:17:16.329942 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:17:16.324782 => 11:17:16.329777
[0m11:17:16.330242 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:17:16.350509 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:17:16.351359 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:17:16.351657 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:17:16.351972 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:17:16.354223 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:17:16.354668 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:17:16.355069 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:17:16.356733 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:17:16.360904 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:17:16.361222 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m11:17:16.361671 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:16.370867 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m11:17:16.371226 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:17:16.371483 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m11:17:16.372489 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:17:16.376302 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m11:17:16.379033 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:17:16.379350 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m11:17:16.379797 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:17:16.380709 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:17:16.330423 => 11:17:16.380552
[0m11:17:16.380995 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:17:16.381654 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.06s]
[0m11:17:16.382123 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:17:16.382804 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:17:16.383162 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m11:17:16.383665 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m11:17:16.383959 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m11:17:16.385901 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m11:17:16.387178 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 11:17:16.384143 => 11:17:16.386965
[0m11:17:16.388067 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m11:17:16.402652 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m11:17:16.403484 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:17:16.403762 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m11:17:16.404016 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:17:16.406249 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:17:16.406687 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:17:16.407032 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m11:17:16.413373 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:17:16.415712 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:17:16.416053 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m11:17:16.416653 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:17:16.419960 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m11:17:16.420270 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:17:16.420522 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m11:17:16.421585 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:17:16.423410 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m11:17:16.425153 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:17:16.425463 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m11:17:16.425872 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:17:16.426729 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 11:17:16.388323 => 11:17:16.426596
[0m11:17:16.427013 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m11:17:16.427717 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 1000[0m in 0.04s]
[0m11:17:16.428226 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:17:16.429274 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:16.429595 [debug] [MainThread]: On master: BEGIN
[0m11:17:16.429885 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:17:16.431888 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:17:16.432251 [debug] [MainThread]: On master: COMMIT
[0m11:17:16.432528 [debug] [MainThread]: Using postgres connection "master"
[0m11:17:16.432771 [debug] [MainThread]: On master: COMMIT
[0m11:17:16.433078 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:17:16.433314 [debug] [MainThread]: On master: Close
[0m11:17:16.433750 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:17:16.434012 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m11:17:16.434258 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:17:16.434480 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m11:17:16.434733 [info ] [MainThread]: 
[0m11:17:16.434985 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m11:17:16.435490 [debug] [MainThread]: Command end result
[0m11:17:16.441044 [info ] [MainThread]: 
[0m11:17:16.441376 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:17:16.441654 [info ] [MainThread]: 
[0m11:17:16.441916 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:17:16.442474 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.40902883, "process_user_time": 1.528427, "process_kernel_time": 0.132603, "process_mem_max_rss": "122496", "process_out_blocks": "1536", "process_in_blocks": "0"}
[0m11:17:16.442837 [debug] [MainThread]: Command `dbt run` succeeded at 11:17:16.442756 after 0.41 seconds
[0m11:17:16.443105 [debug] [MainThread]: Flushing usage events


============================== 11:17:17.835232 | 65e212d7-4635-4781-8780-969b8036c903 ==============================
[0m11:17:17.835232 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:17:17.839094 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:17:17.980223 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:17:17.985461 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:17:18.031517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:17:18.031876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:17:18.043393 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:17:18.044207 [info ] [MainThread]: 
[0m11:17:18.044512 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:17:18.044893 [debug] [MainThread]: Command end result
[0m11:17:18.049901 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.23838921, "process_user_time": 1.40458, "process_kernel_time": 0.061981, "process_mem_max_rss": "116980", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:17:18.050294 [debug] [MainThread]: Command `dbt test` succeeded at 11:17:18.050209 after 0.24 seconds
[0m11:17:18.050587 [debug] [MainThread]: Flushing usage events


============================== 11:24:28.760892 | b35f77e1-06b5-4674-8d29-924d26920a82 ==============================
[0m11:24:28.760892 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:24:28.766328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:24:28.922851 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:24:28.928903 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:24:29.042486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:29.043576 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:29.067891 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:24:29.069479 [info ] [MainThread]: 
[0m11:24:29.070159 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:24:29.071463 [debug] [MainThread]: Command end result
[0m11:24:29.082549 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.34597, "process_user_time": 1.487533, "process_kernel_time": 0.137679, "process_mem_max_rss": "116960", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:24:29.083167 [debug] [MainThread]: Command `dbt test` succeeded at 11:24:29.083023 after 0.35 seconds
[0m11:24:29.083571 [debug] [MainThread]: Flushing usage events


============================== 11:24:30.528634 | c70d98d8-dedc-4ec9-a235-1dd8e0b4ed46 ==============================
[0m11:24:30.528634 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:24:30.532618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:24:30.681053 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:24:30.686642 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:24:30.733201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:24:30.733569 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:24:30.745461 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:24:30.746385 [info ] [MainThread]: 
[0m11:24:30.746912 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:24:30.747757 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:24:30.754025 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:24:30.754402 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:24:30.754752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:30.758194 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:24:30.759052 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:24:30.760192 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight_reporting_schema'
[0m11:24:30.763838 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:24:30.764135 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:24:30.764385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:30.766655 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:24:30.767039 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:24:30.767403 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:24:30.769125 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m11:24:30.769926 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:24:30.770316 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:24:30.773469 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:30.773800 [debug] [MainThread]: On master: BEGIN
[0m11:24:30.774042 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:24:30.776097 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:24:30.776503 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:30.776833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:24:30.780961 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m11:24:30.782328 [debug] [MainThread]: On master: ROLLBACK
[0m11:24:30.782709 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:30.782949 [debug] [MainThread]: On master: BEGIN
[0m11:24:30.783363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:24:30.783715 [debug] [MainThread]: On master: COMMIT
[0m11:24:30.783979 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:30.784221 [debug] [MainThread]: On master: COMMIT
[0m11:24:30.784549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:24:30.784792 [debug] [MainThread]: On master: Close
[0m11:24:30.785259 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:24:30.785556 [info ] [MainThread]: 
[0m11:24:30.790625 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:24:30.791079 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:24:30.791597 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:24:30.791895 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:24:30.796010 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:24:30.800089 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:24:30.792104 => 11:24:30.799916
[0m11:24:30.800391 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:24:30.821304 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:24:30.822153 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:24:30.822444 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:24:30.822702 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:24:30.825080 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:24:30.825493 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:24:30.825851 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:24:30.827749 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:24:30.831758 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:24:30.832081 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m11:24:30.832617 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:24:30.834673 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:24:30.835092 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m11:24:30.835821 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:24:30.845550 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m11:24:30.846089 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:24:30.846517 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m11:24:30.847754 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:24:30.852044 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m11:24:30.855628 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:24:30.855970 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m11:24:30.857550 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:24:30.858706 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:24:30.800568 => 11:24:30.858556
[0m11:24:30.859035 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:24:30.859773 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.07s]
[0m11:24:30.860249 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:24:30.860970 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:24:30.861390 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m11:24:30.861981 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m11:24:30.862332 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m11:24:30.864504 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m11:24:30.865340 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 11:24:30.862559 => 11:24:30.865186
[0m11:24:30.865623 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m11:24:30.879463 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m11:24:30.880573 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:24:30.880885 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m11:24:30.881184 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:24:30.883709 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:24:30.884120 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:24:30.884448 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m11:24:30.891109 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:24:30.893523 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:24:30.893883 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m11:24:30.894540 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:24:30.896574 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:24:30.896860 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m11:24:30.897275 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:24:30.900642 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m11:24:30.900951 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:24:30.901221 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m11:24:30.902512 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:24:30.904189 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m11:24:30.905890 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:24:30.906198 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m11:24:30.908138 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:24:30.909052 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 11:24:30.865813 => 11:24:30.908921
[0m11:24:30.909348 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m11:24:30.910003 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 1000[0m in 0.05s]
[0m11:24:30.910499 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:24:30.911628 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:30.911959 [debug] [MainThread]: On master: BEGIN
[0m11:24:30.912234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:24:30.914345 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:24:30.914698 [debug] [MainThread]: On master: COMMIT
[0m11:24:30.914963 [debug] [MainThread]: Using postgres connection "master"
[0m11:24:30.915225 [debug] [MainThread]: On master: COMMIT
[0m11:24:30.915549 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:24:30.915839 [debug] [MainThread]: On master: Close
[0m11:24:30.916298 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:30.916545 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m11:24:30.916762 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:24:30.916980 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m11:24:30.917250 [info ] [MainThread]: 
[0m11:24:30.917529 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.17 seconds (0.17s).
[0m11:24:30.918051 [debug] [MainThread]: Command end result
[0m11:24:30.924172 [info ] [MainThread]: 
[0m11:24:30.924512 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:24:30.924761 [info ] [MainThread]: 
[0m11:24:30.925009 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:24:30.925579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42097434, "process_user_time": 1.564723, "process_kernel_time": 0.080088, "process_mem_max_rss": "122712", "process_out_blocks": "1538", "process_in_blocks": "0"}
[0m11:24:30.925946 [debug] [MainThread]: Command `dbt run` succeeded at 11:24:30.925868 after 0.42 seconds
[0m11:24:30.926201 [debug] [MainThread]: Flushing usage events


============================== 11:32:51.919468 | 7883d691-c6b1-4333-8773-468fb84d9947 ==============================
[0m11:32:51.919468 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:32:51.927943 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:32:52.116075 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:32:52.123186 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:32:52.179363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:52.179926 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:52.196332 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:32:52.197316 [info ] [MainThread]: 
[0m11:32:52.197703 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:32:52.198212 [debug] [MainThread]: Command end result
[0m11:32:52.205865 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.33056563, "process_user_time": 1.583385, "process_kernel_time": 0.172806, "process_mem_max_rss": "117020", "process_in_blocks": "16", "process_out_blocks": "2385"}
[0m11:32:52.206356 [debug] [MainThread]: Command `dbt test` succeeded at 11:32:52.206228 after 0.33 seconds
[0m11:32:52.206659 [debug] [MainThread]: Flushing usage events


============================== 11:32:53.753964 | ef4d2a66-d6c8-496d-8fdf-3337ca324ed2 ==============================
[0m11:32:53.753964 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:32:53.757891 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:32:53.909990 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:32:53.918535 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:32:53.969165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:53.969658 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:53.981488 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:32:53.982477 [info ] [MainThread]: 
[0m11:32:53.983041 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:32:53.983912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:32:53.990372 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:32:53.990730 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:32:53.991282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:53.994866 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:32:53.995763 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:32:53.996961 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:32:54.000636 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:32:54.000952 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:32:54.001212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:54.003593 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:32:54.004032 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:32:54.004376 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:32:54.008297 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:32:54.009151 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:32:54.009564 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:32:54.012726 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:54.013047 [debug] [MainThread]: On master: BEGIN
[0m11:32:54.013295 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:54.015401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:54.015798 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:54.016118 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:32:54.017915 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:32:54.018714 [debug] [MainThread]: On master: ROLLBACK
[0m11:32:54.019083 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:54.019376 [debug] [MainThread]: On master: BEGIN
[0m11:32:54.019786 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:54.020147 [debug] [MainThread]: On master: COMMIT
[0m11:32:54.020483 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:54.020730 [debug] [MainThread]: On master: COMMIT
[0m11:32:54.021099 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:54.021430 [debug] [MainThread]: On master: Close
[0m11:32:54.021962 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:54.022261 [info ] [MainThread]: 
[0m11:32:54.027583 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:32:54.028063 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:32:54.028592 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:32:54.028911 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:32:54.033092 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:32:54.035957 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:32:54.029111 => 11:32:54.035796
[0m11:32:54.036270 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:32:54.056684 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:32:54.057516 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:32:54.057821 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:32:54.058073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:54.060566 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:32:54.060980 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:32:54.061277 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:32:54.061809 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:32:54.062254 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:32:54.062736 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:32:54.036451 => 11:32:54.062589
[0m11:32:54.063021 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:32:54.065118 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:32:54.065659 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m11:32:54.066100 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:32:54.066817 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:32:54.067166 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:32:54.067542 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:32:54.068541 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:54.068847 [debug] [MainThread]: On master: BEGIN
[0m11:32:54.069219 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:54.071363 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:54.071738 [debug] [MainThread]: On master: COMMIT
[0m11:32:54.071977 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:54.072197 [debug] [MainThread]: On master: COMMIT
[0m11:32:54.072489 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:54.072718 [debug] [MainThread]: On master: Close
[0m11:32:54.073154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:54.073429 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:32:54.073726 [info ] [MainThread]: 
[0m11:32:54.073980 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:32:54.074431 [debug] [MainThread]: Command end result
[0m11:32:54.079675 [info ] [MainThread]: 
[0m11:32:54.080010 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:54.080282 [info ] [MainThread]: 
[0m11:32:54.080530 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:32:54.080770 [info ] [MainThread]: 
[0m11:32:54.081017 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:32:54.081624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.35155421, "process_user_time": 1.563879, "process_kernel_time": 0.129328, "process_mem_max_rss": "121216", "process_in_blocks": "72", "process_out_blocks": "1518", "command_success": false}
[0m11:32:54.081997 [debug] [MainThread]: Command `dbt run` failed at 11:32:54.081913 after 0.35 seconds
[0m11:32:54.082289 [debug] [MainThread]: Flushing usage events


============================== 11:32:57.264058 | 6dfc0437-0060-417b-8c49-d2d63479ae1d ==============================
[0m11:32:57.264058 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:32:57.269045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:32:57.414377 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:32:57.419745 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:32:57.466610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:57.466952 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:57.478510 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:32:57.479334 [info ] [MainThread]: 
[0m11:32:57.479635 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:32:57.479989 [debug] [MainThread]: Command end result
[0m11:32:57.484899 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.24542633, "process_user_time": 1.443979, "process_kernel_time": 0.064999, "process_mem_max_rss": "116968", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:32:57.485409 [debug] [MainThread]: Command `dbt test` succeeded at 11:32:57.485254 after 0.25 seconds
[0m11:32:57.485913 [debug] [MainThread]: Flushing usage events


============================== 11:32:58.900452 | 35fcd87d-af20-473e-bafc-a607679cbcb1 ==============================
[0m11:32:58.900452 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:32:58.904366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m11:32:59.048164 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:32:59.053447 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:32:59.098708 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:32:59.099044 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:32:59.110566 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:32:59.111436 [info ] [MainThread]: 
[0m11:32:59.111921 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:32:59.112716 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:32:59.119007 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:32:59.119478 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:32:59.119830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:32:59.122944 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:32:59.123795 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:32:59.124943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:32:59.128669 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:32:59.128948 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:32:59.129172 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:32:59.131170 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:32:59.131615 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:32:59.131908 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:32:59.133458 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:32:59.134206 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:32:59.134584 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:32:59.137446 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:59.137782 [debug] [MainThread]: On master: BEGIN
[0m11:32:59.138038 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:32:59.139981 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:59.140351 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:59.140679 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:32:59.142333 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:32:59.143079 [debug] [MainThread]: On master: ROLLBACK
[0m11:32:59.143451 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:59.143695 [debug] [MainThread]: On master: BEGIN
[0m11:32:59.144077 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:59.144563 [debug] [MainThread]: On master: COMMIT
[0m11:32:59.144908 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:59.145155 [debug] [MainThread]: On master: COMMIT
[0m11:32:59.145527 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:59.145812 [debug] [MainThread]: On master: Close
[0m11:32:59.146313 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:32:59.146594 [info ] [MainThread]: 
[0m11:32:59.152022 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:32:59.152497 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:32:59.153023 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:32:59.153343 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:32:59.157444 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:32:59.158348 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:32:59.153545 => 11:32:59.158182
[0m11:32:59.158656 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:32:59.179410 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:32:59.180334 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:32:59.180674 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:32:59.180932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:32:59.183313 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:32:59.183677 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:32:59.183963 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:32:59.184492 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:32:59.184982 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:32:59.185479 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:32:59.158825 => 11:32:59.185330
[0m11:32:59.185759 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:32:59.187150 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:32:59.187724 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.03s]
[0m11:32:59.188208 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:32:59.188890 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:32:59.189225 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:32:59.189548 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:32:59.190504 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:59.190797 [debug] [MainThread]: On master: BEGIN
[0m11:32:59.191047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:32:59.193299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:32:59.193761 [debug] [MainThread]: On master: COMMIT
[0m11:32:59.194053 [debug] [MainThread]: Using postgres connection "master"
[0m11:32:59.194323 [debug] [MainThread]: On master: COMMIT
[0m11:32:59.194672 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:32:59.194931 [debug] [MainThread]: On master: Close
[0m11:32:59.195433 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:32:59.195725 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:32:59.196014 [info ] [MainThread]: 
[0m11:32:59.196287 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.08 seconds (0.08s).
[0m11:32:59.196749 [debug] [MainThread]: Command end result
[0m11:32:59.202427 [info ] [MainThread]: 
[0m11:32:59.202768 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:32:59.203049 [info ] [MainThread]: 
[0m11:32:59.203362 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:32:59.203665 [info ] [MainThread]: 
[0m11:32:59.203918 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:32:59.204500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3280205, "process_user_time": 1.485866, "process_kernel_time": 0.080992, "process_mem_max_rss": "121340", "process_out_blocks": "1518", "command_success": false, "process_in_blocks": "0"}
[0m11:32:59.204887 [debug] [MainThread]: Command `dbt run` failed at 11:32:59.204802 after 0.33 seconds
[0m11:32:59.205167 [debug] [MainThread]: Flushing usage events


============================== 11:39:25.836442 | 1c5902a0-54e2-4953-ad3c-a4134a7f75c6 ==============================
[0m11:39:25.836442 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:39:25.842079 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:39:26.081924 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:39:26.089913 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:39:26.142406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:26.142747 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:26.154804 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:39:26.155640 [info ] [MainThread]: 
[0m11:39:26.155919 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:39:26.156279 [debug] [MainThread]: Command end result
[0m11:39:26.161822 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.34978446, "process_user_time": 1.487385, "process_kernel_time": 0.157146, "process_mem_max_rss": "116976", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:39:26.162225 [debug] [MainThread]: Command `dbt test` succeeded at 11:39:26.162137 after 0.35 seconds
[0m11:39:26.162485 [debug] [MainThread]: Flushing usage events


============================== 11:39:27.567958 | 898ee683-7af7-4d04-a951-dec0cc03aec7 ==============================
[0m11:39:27.567958 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:39:27.572475 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:39:27.727553 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:39:27.733475 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:39:27.783044 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:39:27.783508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:39:27.796755 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:39:27.797779 [info ] [MainThread]: 
[0m11:39:27.798356 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:39:27.799308 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:39:27.805895 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:39:27.806291 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:39:27.806589 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:27.810572 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:39:27.811613 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:39:27.813901 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight_reporting_schema'
[0m11:39:27.817906 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:39:27.818217 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:39:27.818447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:39:27.820651 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:39:27.821141 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:39:27.821537 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:39:27.823289 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:39:27.824176 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:39:27.824748 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:39:27.828033 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:27.828390 [debug] [MainThread]: On master: BEGIN
[0m11:39:27.828633 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:39:27.831172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:39:27.831670 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:27.831987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:39:27.834108 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:39:27.834887 [debug] [MainThread]: On master: ROLLBACK
[0m11:39:27.835245 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:27.835512 [debug] [MainThread]: On master: BEGIN
[0m11:39:27.835976 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:39:27.836403 [debug] [MainThread]: On master: COMMIT
[0m11:39:27.836686 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:27.836935 [debug] [MainThread]: On master: COMMIT
[0m11:39:27.837267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:39:27.837529 [debug] [MainThread]: On master: Close
[0m11:39:27.838043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:39:27.838331 [info ] [MainThread]: 
[0m11:39:27.843643 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:39:27.844128 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:39:27.844664 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:39:27.844986 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:39:27.849186 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:39:27.853044 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:39:27.845190 => 11:39:27.852865
[0m11:39:27.853346 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:39:27.873897 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:39:27.874890 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:39:27.875210 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:39:27.875472 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:39:27.878011 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:39:27.878433 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:39:27.878753 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:39:27.879344 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:39:27.879996 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:39:27.880511 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:39:27.853528 => 11:39:27.880368
[0m11:39:27.880796 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:39:27.882348 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:39:27.882874 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m11:39:27.883306 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:39:27.883976 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:39:27.884326 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:39:27.884662 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:39:27.885661 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:27.886005 [debug] [MainThread]: On master: BEGIN
[0m11:39:27.886309 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:39:27.888641 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:39:27.889081 [debug] [MainThread]: On master: COMMIT
[0m11:39:27.889356 [debug] [MainThread]: Using postgres connection "master"
[0m11:39:27.889596 [debug] [MainThread]: On master: COMMIT
[0m11:39:27.889900 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:39:27.890153 [debug] [MainThread]: On master: Close
[0m11:39:27.890693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:39:27.891015 [debug] [MainThread]: Connection 'list_hginsight' was properly closed.
[0m11:39:27.891303 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:39:27.891636 [info ] [MainThread]: 
[0m11:39:27.891928 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:39:27.892446 [debug] [MainThread]: Command end result
[0m11:39:27.898224 [info ] [MainThread]: 
[0m11:39:27.898556 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:39:27.898808 [info ] [MainThread]: 
[0m11:39:27.899061 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:39:27.899305 [info ] [MainThread]: 
[0m11:39:27.899552 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:39:27.900144 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3589444, "process_user_time": 1.48144, "process_kernel_time": 0.094155, "process_mem_max_rss": "121592", "process_out_blocks": "1518", "command_success": false, "process_in_blocks": "0"}
[0m11:39:27.900517 [debug] [MainThread]: Command `dbt run` failed at 11:39:27.900433 after 0.36 seconds
[0m11:39:27.900804 [debug] [MainThread]: Flushing usage events


============================== 11:40:28.221549 | 4a9715c6-b98b-4e38-82ff-e72423df3d08 ==============================
[0m11:40:28.221549 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:40:28.226060 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m11:40:28.397463 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:40:28.404168 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:40:28.456228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:28.456597 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:28.470659 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:40:28.471581 [info ] [MainThread]: 
[0m11:40:28.471884 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:40:28.472255 [debug] [MainThread]: Command end result
[0m11:40:28.478001 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.280843, "process_user_time": 1.461827, "process_kernel_time": 0.139269, "process_mem_max_rss": "116972", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:40:28.478403 [debug] [MainThread]: Command `dbt test` succeeded at 11:40:28.478313 after 0.28 seconds
[0m11:40:28.478681 [debug] [MainThread]: Flushing usage events


============================== 11:40:30.012522 | 4269823b-ba6f-47e6-9e7c-9872d0e067f4 ==============================
[0m11:40:30.012522 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:40:30.016710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:40:30.162050 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:40:30.167395 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:40:30.218517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:40:30.218888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:40:30.231726 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:40:30.232631 [info ] [MainThread]: 
[0m11:40:30.233160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:40:30.233999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:40:30.240354 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:40:30.240761 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:40:30.241122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:40:30.245678 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m11:40:30.246559 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:40:30.247893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:40:30.251516 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:40:30.251810 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:40:30.252078 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:40:30.254187 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:40:30.254565 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:40:30.254982 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:40:30.256752 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:40:30.257592 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:40:30.258001 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:40:30.261193 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:30.261557 [debug] [MainThread]: On master: BEGIN
[0m11:40:30.261816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:40:30.264212 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:40:30.264622 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:30.264932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:40:30.266673 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:40:30.267477 [debug] [MainThread]: On master: ROLLBACK
[0m11:40:30.267843 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:30.268109 [debug] [MainThread]: On master: BEGIN
[0m11:40:30.268508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:40:30.268841 [debug] [MainThread]: On master: COMMIT
[0m11:40:30.269114 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:30.269337 [debug] [MainThread]: On master: COMMIT
[0m11:40:30.269641 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:40:30.269927 [debug] [MainThread]: On master: Close
[0m11:40:30.270454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:40:30.270757 [info ] [MainThread]: 
[0m11:40:30.275917 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:40:30.276375 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:40:30.276879 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:40:30.277211 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:40:30.281395 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:40:30.282571 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:40:30.277417 => 11:40:30.282386
[0m11:40:30.282918 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:40:30.303227 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:40:30.304171 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:40:30.304457 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:40:30.304727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:40:30.307233 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:40:30.307675 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:40:30.308015 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:40:30.308600 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "staging_schema.raw_telecom_data" does not exist
LINE 23:     staging_schema.raw_telecom_data
             ^

[0m11:40:30.309186 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: ROLLBACK
[0m11:40:30.309633 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:40:30.283114 => 11:40:30.309490
[0m11:40:30.309922 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:40:30.311504 [debug] [Thread-1  ]: Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:40:30.312023 [error] [Thread-1  ]: 1 of 2 ERROR creating sql view model reporting_schema.stg_telecome_data ........ [[31mERROR[0m in 0.04s]
[0m11:40:30.312449 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:40:30.313117 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:40:30.313430 [info ] [Thread-3  ]: 2 of 2 SKIP relation reporting_schema.fact_customer_telcome .................... [[33mSKIP[0m]
[0m11:40:30.313729 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:40:30.314745 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:30.315162 [debug] [MainThread]: On master: BEGIN
[0m11:40:30.315442 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:40:30.317841 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:40:30.318295 [debug] [MainThread]: On master: COMMIT
[0m11:40:30.318580 [debug] [MainThread]: Using postgres connection "master"
[0m11:40:30.318856 [debug] [MainThread]: On master: COMMIT
[0m11:40:30.319239 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:40:30.319522 [debug] [MainThread]: On master: Close
[0m11:40:30.320010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:40:30.320302 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:40:30.320593 [info ] [MainThread]: 
[0m11:40:30.320931 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.09 seconds (0.09s).
[0m11:40:30.321406 [debug] [MainThread]: Command end result
[0m11:40:30.327587 [info ] [MainThread]: 
[0m11:40:30.327968 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m11:40:30.328234 [info ] [MainThread]: 
[0m11:40:30.328486 [error] [MainThread]:   Database Error in model stg_telecome_data (models/staging/stg_telecome_data.sql)
  relation "staging_schema.raw_telecom_data" does not exist
  LINE 23:     staging_schema.raw_telecom_data
               ^
  compiled Code at target/run/dbt_project/models/staging/stg_telecome_data.sql
[0m11:40:30.328730 [info ] [MainThread]: 
[0m11:40:30.328985 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m11:40:30.329623 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.3414494, "process_user_time": 1.599571, "process_kernel_time": 0.093559, "process_mem_max_rss": "121312", "process_out_blocks": "1518", "command_success": false, "process_in_blocks": "0"}
[0m11:40:30.330047 [debug] [MainThread]: Command `dbt run` failed at 11:40:30.329959 after 0.34 seconds
[0m11:40:30.330320 [debug] [MainThread]: Flushing usage events


============================== 11:45:18.096714 | bd10b9d6-be8c-48c9-be6a-c771a75e12b3 ==============================
[0m11:45:18.096714 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:45:18.102455 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m11:45:18.259263 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:45:18.267067 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:45:18.329994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:18.330405 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:18.347818 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:45:18.348902 [info ] [MainThread]: 
[0m11:45:18.349281 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m11:45:18.349807 [debug] [MainThread]: Command end result
[0m11:45:18.356730 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.28513497, "process_user_time": 1.471307, "process_kernel_time": 0.101675, "process_mem_max_rss": "116992", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m11:45:18.357348 [debug] [MainThread]: Command `dbt test` succeeded at 11:45:18.357228 after 0.29 seconds
[0m11:45:18.357740 [debug] [MainThread]: Flushing usage events


============================== 11:45:20.201519 | 44491770-76c4-4c6d-a494-7eacbc49d623 ==============================
[0m11:45:20.201519 [info ] [MainThread]: Running with dbt=1.7.0
[0m11:45:20.206685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/opt/airflow/dags/dbt', 'log_path': '/opt/airflow/dags/dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m11:45:20.369260 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m11:45:20.375249 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m11:45:20.432127 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:45:20.432545 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:45:20.451656 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m11:45:20.452955 [info ] [MainThread]: 
[0m11:45:20.453565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m11:45:20.454859 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m11:45:20.464517 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m11:45:20.465493 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m11:45:20.466138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:45:20.475236 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m11:45:20.477228 [debug] [ThreadPool]: On list_hginsight: Close
[0m11:45:20.480974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m11:45:20.488504 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:45:20.489157 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m11:45:20.489931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:45:20.500942 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.501631 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m11:45:20.502211 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m11:45:20.509587 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m11:45:20.511034 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m11:45:20.511853 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m11:45:20.519996 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.521624 [debug] [MainThread]: On master: BEGIN
[0m11:45:20.522770 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:45:20.531897 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.532808 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.534070 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m11:45:20.549281 [debug] [MainThread]: SQL status: SELECT 0 in 0.0 seconds
[0m11:45:20.551304 [debug] [MainThread]: On master: ROLLBACK
[0m11:45:20.554346 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.560948 [debug] [MainThread]: On master: BEGIN
[0m11:45:20.561872 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.562434 [debug] [MainThread]: On master: COMMIT
[0m11:45:20.562802 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.563073 [debug] [MainThread]: On master: COMMIT
[0m11:45:20.563418 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.563699 [debug] [MainThread]: On master: Close
[0m11:45:20.564390 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:45:20.564842 [info ] [MainThread]: 
[0m11:45:20.571805 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m11:45:20.572425 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m11:45:20.573103 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m11:45:20.573461 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m11:45:20.578223 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m11:45:20.579506 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 11:45:20.573692 => 11:45:20.579212
[0m11:45:20.580055 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m11:45:20.605977 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m11:45:20.607586 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:45:20.608426 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m11:45:20.608955 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m11:45:20.615093 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.616135 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:45:20.616637 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m11:45:20.620899 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m11:45:20.626418 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:45:20.627114 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m11:45:20.628022 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:20.639901 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m11:45:20.640402 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:45:20.640759 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m11:45:20.641605 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.647131 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m11:45:20.650454 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m11:45:20.650873 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m11:45:20.651453 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m11:45:20.652518 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 11:45:20.580328 => 11:45:20.652355
[0m11:45:20.652815 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m11:45:20.653629 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.08s]
[0m11:45:20.654317 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m11:45:20.655280 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m11:45:20.655761 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m11:45:20.656349 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m11:45:20.656716 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m11:45:20.659015 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m11:45:20.660115 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 11:45:20.656925 => 11:45:20.659951
[0m11:45:20.660411 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m11:45:20.675001 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m11:45:20.675937 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:45:20.676254 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m11:45:20.676555 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m11:45:20.679504 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.679944 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:45:20.680281 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m11:45:20.687816 [debug] [Thread-3  ]: SQL status: SELECT 1000 in 0.0 seconds
[0m11:45:20.690147 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:45:20.690511 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m11:45:20.690994 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m11:45:20.694553 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m11:45:20.694868 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:45:20.695126 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m11:45:20.696229 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.697985 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m11:45:20.699795 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m11:45:20.700127 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m11:45:20.700570 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m11:45:20.701515 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 11:45:20.660595 => 11:45:20.701365
[0m11:45:20.701791 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m11:45:20.702520 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 1000[0m in 0.05s]
[0m11:45:20.702958 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m11:45:20.704136 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.704448 [debug] [MainThread]: On master: BEGIN
[0m11:45:20.704696 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:45:20.707868 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m11:45:20.708318 [debug] [MainThread]: On master: COMMIT
[0m11:45:20.708661 [debug] [MainThread]: Using postgres connection "master"
[0m11:45:20.708916 [debug] [MainThread]: On master: COMMIT
[0m11:45:20.709244 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m11:45:20.709501 [debug] [MainThread]: On master: Close
[0m11:45:20.710031 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:45:20.710331 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m11:45:20.710593 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m11:45:20.710904 [info ] [MainThread]: 
[0m11:45:20.711235 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m11:45:20.711908 [debug] [MainThread]: Command end result
[0m11:45:20.717915 [info ] [MainThread]: 
[0m11:45:20.718279 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:45:20.718550 [info ] [MainThread]: 
[0m11:45:20.718873 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:45:20.719774 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.5472015, "process_user_time": 1.890037, "process_kernel_time": 0.205221, "process_mem_max_rss": "122132", "process_out_blocks": "1535", "process_in_blocks": "0"}
[0m11:45:20.720453 [debug] [MainThread]: Command `dbt run` succeeded at 11:45:20.720338 after 0.55 seconds
[0m11:45:20.720902 [debug] [MainThread]: Flushing usage events


============================== 12:00:05.117892 | 38484529-d22a-47ef-b3b9-afae048fb70f ==============================
[0m12:00:05.117892 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:00:05.123518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'send_anonymous_usage_stats': 'False'}
[0m12:00:05.295569 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:00:05.302961 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m12:00:05.357283 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:05.357653 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:05.370956 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:00:05.371937 [info ] [MainThread]: 
[0m12:00:05.372258 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:00:05.372679 [debug] [MainThread]: Command end result
[0m12:00:05.378516 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.2849126, "process_user_time": 1.467676, "process_kernel_time": 0.183209, "process_mem_max_rss": "116980", "process_out_blocks": "1489", "process_in_blocks": "0"}
[0m12:00:05.378969 [debug] [MainThread]: Command `dbt test` succeeded at 12:00:05.378872 after 0.29 seconds
[0m12:00:05.379252 [debug] [MainThread]: Flushing usage events


============================== 12:00:06.826271 | 0250f353-6662-4ea5-ad4f-b768d87bfe18 ==============================
[0m12:00:06.826271 [info ] [MainThread]: Running with dbt=1.7.0
[0m12:00:06.830439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/opt/airflow/dags/dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/opt/airflow/dags/dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --project-dir /opt/airflow/dags/dbt --profiles-dir /opt/airflow/dags/dbt --profile elt_pipeline', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m12:00:06.975824 [info ] [MainThread]: Registered adapter: postgres=1.7.0
[0m12:00:06.981166 [debug] [MainThread]: checksum: b55ddae85c3593fe54c1d6338305f345135a849040265155b7160a4dd70de9f6, vars: {}, profile: elt_pipeline, target: , version: 1.7.0
[0m12:00:07.027228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:00:07.027565 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:00:07.039331 [info ] [MainThread]: Found 2 models, 0 sources, 0 exposures, 0 metrics, 401 macros, 0 groups, 0 semantic models
[0m12:00:07.040192 [info ] [MainThread]: 
[0m12:00:07.040706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m12:00:07.041519 [debug] [ThreadPool]: Acquiring new postgres connection 'list_hginsight'
[0m12:00:07.047926 [debug] [ThreadPool]: Using postgres connection "list_hginsight"
[0m12:00:07.048267 [debug] [ThreadPool]: On list_hginsight: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight"} */

    select distinct nspname from pg_namespace
  
[0m12:00:07.048537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:00:07.051877 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m12:00:07.052826 [debug] [ThreadPool]: On list_hginsight: Close
[0m12:00:07.054022 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_hginsight, now list_hginsight_reporting_schema)
[0m12:00:07.057645 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m12:00:07.057961 [debug] [ThreadPool]: On list_hginsight_reporting_schema: BEGIN
[0m12:00:07.058219 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:00:07.060332 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m12:00:07.060829 [debug] [ThreadPool]: Using postgres connection "list_hginsight_reporting_schema"
[0m12:00:07.061159 [debug] [ThreadPool]: On list_hginsight_reporting_schema: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "list_hginsight_reporting_schema"} */
select
      'hginsight' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'reporting_schema'
    union all
    select
      'hginsight' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'reporting_schema'
  
[0m12:00:07.063036 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.0 seconds
[0m12:00:07.063862 [debug] [ThreadPool]: On list_hginsight_reporting_schema: ROLLBACK
[0m12:00:07.064246 [debug] [ThreadPool]: On list_hginsight_reporting_schema: Close
[0m12:00:07.067421 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:07.067749 [debug] [MainThread]: On master: BEGIN
[0m12:00:07.067977 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:00:07.070084 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:00:07.070449 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:07.070753 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m12:00:07.076450 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m12:00:07.077865 [debug] [MainThread]: On master: ROLLBACK
[0m12:00:07.078243 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:07.078491 [debug] [MainThread]: On master: BEGIN
[0m12:00:07.078922 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:00:07.079215 [debug] [MainThread]: On master: COMMIT
[0m12:00:07.079470 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:07.079727 [debug] [MainThread]: On master: COMMIT
[0m12:00:07.080186 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:00:07.080475 [debug] [MainThread]: On master: Close
[0m12:00:07.080966 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:00:07.081257 [info ] [MainThread]: 
[0m12:00:07.086031 [debug] [Thread-1  ]: Began running node model.dbt_project.stg_telecome_data
[0m12:00:07.086484 [info ] [Thread-1  ]: 1 of 2 START sql view model reporting_schema.stg_telecome_data ................. [RUN]
[0m12:00:07.087046 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_hginsight_reporting_schema, now model.dbt_project.stg_telecome_data)
[0m12:00:07.087371 [debug] [Thread-1  ]: Began compiling node model.dbt_project.stg_telecome_data
[0m12:00:07.091547 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_project.stg_telecome_data"
[0m12:00:07.093869 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (compile): 12:00:07.087584 => 12:00:07.093713
[0m12:00:07.094171 [debug] [Thread-1  ]: Began executing node model.dbt_project.stg_telecome_data
[0m12:00:07.114727 [debug] [Thread-1  ]: Writing runtime sql for node "model.dbt_project.stg_telecome_data"
[0m12:00:07.115577 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m12:00:07.115887 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: BEGIN
[0m12:00:07.116147 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m12:00:07.118421 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m12:00:07.118854 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m12:00:07.119168 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */

  create view "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp"
    
    
  as (
    -- dbt/models/staging/stg_telecom_data.sql

SELECT
        "CustomerID"::Text AS customer_id_raw,
        "Gender" AS gender,
        "Age"::INTEGER AS age,

        "Tenure"::INTEGER AS tenure_months,
        "InternetService" AS internet_service,
        "ContractType" AS contract_type,
        "MonthlyCharges"::NUMERIC AS monthly_charges,
        -- Impute missing TotalCharges with 0.0, typically null when tenure is 0
        COALESCE("TotalCharges"::NUMERIC, 0.0) AS total_charges,
        "TechSupport" as tech_support,
        "Churn" AS churn_status
    FROM
    staging_schema.raw_telecom_data
  );
[0m12:00:07.121470 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
[0m12:00:07.125329 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m12:00:07.125652 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data" rename to "stg_telecome_data__dbt_backup"
[0m12:00:07.126172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:07.128622 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m12:00:07.129131 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
alter table "hginsight"."reporting_schema"."stg_telecome_data__dbt_tmp" rename to "stg_telecome_data"
[0m12:00:07.129887 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:07.139847 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m12:00:07.140211 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m12:00:07.140520 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: COMMIT
[0m12:00:07.141651 [debug] [Thread-1  ]: SQL status: COMMIT in 0.0 seconds
[0m12:00:07.145647 [debug] [Thread-1  ]: Applying DROP to: "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup"
[0m12:00:07.149044 [debug] [Thread-1  ]: Using postgres connection "model.dbt_project.stg_telecome_data"
[0m12:00:07.149377 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.stg_telecome_data"} */
drop view if exists "hginsight"."reporting_schema"."stg_telecome_data__dbt_backup" cascade
[0m12:00:07.151012 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
[0m12:00:07.152310 [debug] [Thread-1  ]: Timing info for model.dbt_project.stg_telecome_data (execute): 12:00:07.094355 => 12:00:07.152148
[0m12:00:07.152643 [debug] [Thread-1  ]: On model.dbt_project.stg_telecome_data: Close
[0m12:00:07.153403 [info ] [Thread-1  ]: 1 of 2 OK created sql view model reporting_schema.stg_telecome_data ............ [[32mCREATE VIEW[0m in 0.07s]
[0m12:00:07.153933 [debug] [Thread-1  ]: Finished running node model.dbt_project.stg_telecome_data
[0m12:00:07.154630 [debug] [Thread-3  ]: Began running node model.dbt_project.fact_customer_telcome
[0m12:00:07.155063 [info ] [Thread-3  ]: 2 of 2 START sql table model reporting_schema.fact_customer_telcome ............ [RUN]
[0m12:00:07.155653 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.dbt_project.fact_customer_telcome'
[0m12:00:07.156141 [debug] [Thread-3  ]: Began compiling node model.dbt_project.fact_customer_telcome
[0m12:00:07.158532 [debug] [Thread-3  ]: Writing injected SQL for node "model.dbt_project.fact_customer_telcome"
[0m12:00:07.159637 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (compile): 12:00:07.156398 => 12:00:07.159431
[0m12:00:07.159984 [debug] [Thread-3  ]: Began executing node model.dbt_project.fact_customer_telcome
[0m12:00:07.174857 [debug] [Thread-3  ]: Writing runtime sql for node "model.dbt_project.fact_customer_telcome"
[0m12:00:07.176031 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m12:00:07.176454 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: BEGIN
[0m12:00:07.176869 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m12:00:07.179911 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m12:00:07.180408 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m12:00:07.180759 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */

  
    

  create  table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp"
  
  
    as
  
  (
    -- dbt/models/marts/fact_customer_telcome.sql


SELECT
    -- PII Anonymization: Use SHA256 hashing for a non-reversible identifier
    encode(digest(customer_id_raw, 'sha256'), 'hex') AS customer_key,
    gender,
    age,
    tenure_months,
    contract_type,
    internet_service,
    monthly_charges,
    total_charges,
    CASE
        WHEN tech_support = 'Yes' THEN 1
        ELSE 0
    END AS tech_support_flag,

    CASE
        WHEN churn_status = 'Yes' THEN 1
        ELSE 0
    END AS churned_flag,

    -- Categorization: Group tenure into buckets for easier analysis
    CASE
        WHEN tenure_months < 12 THEN '0-1 Year'
        WHEN tenure_months BETWEEN 12 AND 36 THEN '1-3 Years'
        WHEN tenure_months > 36 THEN '3+ Years'
        ELSE 'Unknown'
    END AS tenure_bucket

FROM

    "hginsight"."reporting_schema"."stg_telecome_data"
  );
  
[0m12:00:07.191529 [debug] [Thread-3  ]: SQL status: SELECT 2000 in 0.0 seconds
[0m12:00:07.194353 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m12:00:07.194775 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome" rename to "fact_customer_telcome__dbt_backup"
[0m12:00:07.195418 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:07.197451 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m12:00:07.197759 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
alter table "hginsight"."reporting_schema"."fact_customer_telcome__dbt_tmp" rename to "fact_customer_telcome"
[0m12:00:07.198172 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m12:00:07.201712 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m12:00:07.202051 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m12:00:07.202322 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: COMMIT
[0m12:00:07.203818 [debug] [Thread-3  ]: SQL status: COMMIT in 0.0 seconds
[0m12:00:07.205505 [debug] [Thread-3  ]: Applying DROP to: "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup"
[0m12:00:07.207248 [debug] [Thread-3  ]: Using postgres connection "model.dbt_project.fact_customer_telcome"
[0m12:00:07.207543 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: /* {"app": "dbt", "dbt_version": "1.7.0", "profile_name": "elt_pipeline", "target_name": "dev", "node_id": "model.dbt_project.fact_customer_telcome"} */
drop table if exists "hginsight"."reporting_schema"."fact_customer_telcome__dbt_backup" cascade
[0m12:00:07.210011 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m12:00:07.210969 [debug] [Thread-3  ]: Timing info for model.dbt_project.fact_customer_telcome (execute): 12:00:07.160185 => 12:00:07.210822
[0m12:00:07.211288 [debug] [Thread-3  ]: On model.dbt_project.fact_customer_telcome: Close
[0m12:00:07.212069 [info ] [Thread-3  ]: 2 of 2 OK created sql table model reporting_schema.fact_customer_telcome ....... [[32mSELECT 2000[0m in 0.06s]
[0m12:00:07.212520 [debug] [Thread-3  ]: Finished running node model.dbt_project.fact_customer_telcome
[0m12:00:07.213599 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:07.213899 [debug] [MainThread]: On master: BEGIN
[0m12:00:07.214134 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:00:07.216140 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m12:00:07.216612 [debug] [MainThread]: On master: COMMIT
[0m12:00:07.216897 [debug] [MainThread]: Using postgres connection "master"
[0m12:00:07.217142 [debug] [MainThread]: On master: COMMIT
[0m12:00:07.217420 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m12:00:07.217654 [debug] [MainThread]: On master: Close
[0m12:00:07.218081 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:00:07.218336 [debug] [MainThread]: Connection 'model.dbt_project.stg_telecome_data' was properly closed.
[0m12:00:07.218559 [debug] [MainThread]: Connection 'model.dbt_project.fact_customer_telcome' was properly closed.
[0m12:00:07.218829 [info ] [MainThread]: 
[0m12:00:07.219088 [info ] [MainThread]: Finished running 1 view model, 1 table model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m12:00:07.219590 [debug] [MainThread]: Command end result
[0m12:00:07.225812 [info ] [MainThread]: 
[0m12:00:07.226156 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:00:07.226417 [info ] [MainThread]: 
[0m12:00:07.226685 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:00:07.227253 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.42620313, "process_user_time": 1.590488, "process_kernel_time": 0.077828, "process_mem_max_rss": "122356", "process_out_blocks": "1537", "process_in_blocks": "0"}
[0m12:00:07.227615 [debug] [MainThread]: Command `dbt run` succeeded at 12:00:07.227530 after 0.43 seconds
[0m12:00:07.227886 [debug] [MainThread]: Flushing usage events
